{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 269,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "from fancyimpute import BiScaler, KNN, NuclearNormMinimization, SoftImpute, SimpleFill,IterativeSVD,MatrixFactorization,SimilarityWeightedAveraging\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "ratings_file = \"/Users/Hatim/Downloads/ml-latest-small/ratings.csv\"\n",
    "movies_file = \"/Users/Hatim/Downloads/ml-latest-small/movies.csv\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "ratings_df = pd.read_csv(ratings_file)\n",
    "movies_df = pd.read_csv(movies_file)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [],
   "source": [
    "R_df = ratings_df.pivot(index = 'userId', columns ='movieId', values = 'rating')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "def recommend_movies(preds_df, userID, movies_df, original_ratings_df, num_recommendations=5):\n",
    "    \n",
    "    # Get and sort the user's predictions \n",
    "    sorted_user_predictions = preds_df.loc[userID].sort_values(ascending=False) # UserID starts at 1\n",
    "    \n",
    "    # Get the user's data and merge in the movie information.\n",
    "    user_data = original_ratings_df[original_ratings_df.userId == (userID)]\n",
    "    user_full = (user_data.merge(movies_df, how = 'left', left_on = 'movieId', right_on = 'movieId').\n",
    "                     sort_values(['rating'], ascending=False))\n",
    "\n",
    "    print(\"User \"+str(userID)+\" has already rated \"+str(user_full.shape[0])+\" movies.\")\n",
    "    print(\"Recommending highest \"+str(num_recommendations)+\" predicted ratings movies not already rated.\")\n",
    "    \n",
    "    # Recommend the highest predicted rating movies that the user hasn't seen yet.\n",
    "    recommendations = (movies_df[~movies_df['movieId'].isin(user_full['movieId'])].\n",
    "         merge(pd.DataFrame(sorted_user_predictions).reset_index(), how = 'left',\n",
    "               left_on = 'movieId',\n",
    "               right_on = 'movieId').rename(columns = {userID: 'Predictions'}).sort_values('Predictions', ascending = False).\n",
    "                       iloc[:num_recommendations, :-1])\n",
    "\n",
    "    return user_full, recommendations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "missing_mask = ~R_df.isnull()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "def rmse(preds):\n",
    "    preds = pd.DataFrame(preds,columns=R_df.columns)\n",
    "    mse = (((preds[missing_mask]) - (R_df[missing_mask])) ** 2)\n",
    "    rmse = np.sqrt(np.mean(mse.stack().values))\n",
    "    return rmse"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The RMSE for simple fill based on column mean is 0.943601606143\n"
     ]
    }
   ],
   "source": [
    "\"\"\"Simple fill based on the column mean i.e. Movie Mean\"\"\"\n",
    "X_filled_simple_mean = SimpleFill(fill_method=\"mean\",min_value=1,max_value=5).complete(R_df)\n",
    "\"\"\"Rmse for simple fill based on the column mean\"\"\"\n",
    "rmse_SimpleFill_mean = rmse(X_filled_simple_mean)\n",
    "print(\"The RMSE for simple fill based on column mean is \"+str(rmse_SimpleFill_mean))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "User 600 has already rated 35 movies.\n",
      "Recommending highest 10 predicted ratings movies not already rated.\n"
     ]
    }
   ],
   "source": [
    "already_rated, predictions = recommend_movies(pd.DataFrame(X_filled_simple_mean,columns=R_df.columns), 600, movies_df, ratings_df, 10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>600</td>\n",
       "      <td>588</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956328</td>\n",
       "      <td>Aladdin (1992)</td>\n",
       "      <td>Adventure|Animation|Children|Comedy|Musical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>600</td>\n",
       "      <td>68954</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956316</td>\n",
       "      <td>Up (2009)</td>\n",
       "      <td>Adventure|Animation|Children|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>600</td>\n",
       "      <td>90866</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431958854</td>\n",
       "      <td>Hugo (2011)</td>\n",
       "      <td>Children|Drama|Mystery</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>600</td>\n",
       "      <td>81847</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956365</td>\n",
       "      <td>Tangled (2010)</td>\n",
       "      <td>Animation|Children|Comedy|Fantasy|Musical|Roma...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>600</td>\n",
       "      <td>4886</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956114</td>\n",
       "      <td>Monsters, Inc. (2001)</td>\n",
       "      <td>Adventure|Animation|Children|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>600</td>\n",
       "      <td>2081</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431957361</td>\n",
       "      <td>Little Mermaid, The (1989)</td>\n",
       "      <td>Animation|Children|Comedy|Musical|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>600</td>\n",
       "      <td>79132</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956095</td>\n",
       "      <td>Inception (2010)</td>\n",
       "      <td>Action|Crime|Drama|Mystery|Sci-Fi|Thriller|IMAX</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>600</td>\n",
       "      <td>76093</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956421</td>\n",
       "      <td>How to Train Your Dragon (2010)</td>\n",
       "      <td>Adventure|Animation|Children|Fantasy|IMAX</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>600</td>\n",
       "      <td>73290</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956210</td>\n",
       "      <td>Hachiko: A Dog's Story (a.k.a. Hachi: A Dog's ...</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>600</td>\n",
       "      <td>81845</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1431956086</td>\n",
       "      <td>King's Speech, The (2010)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    userId  movieId  rating   timestamp  \\\n",
       "0      600      588     5.0  1431956328   \n",
       "11     600    68954     5.0  1431956316   \n",
       "20     600    90866     5.0  1431958854   \n",
       "18     600    81847     5.0  1431956365   \n",
       "4      600     4886     5.0  1431956114   \n",
       "1      600     2081     5.0  1431957361   \n",
       "16     600    79132     5.0  1431956095   \n",
       "15     600    76093     5.0  1431956421   \n",
       "14     600    73290     5.0  1431956210   \n",
       "17     600    81845     4.5  1431956086   \n",
       "\n",
       "                                                title  \\\n",
       "0                                      Aladdin (1992)   \n",
       "11                                          Up (2009)   \n",
       "20                                        Hugo (2011)   \n",
       "18                                     Tangled (2010)   \n",
       "4                               Monsters, Inc. (2001)   \n",
       "1                          Little Mermaid, The (1989)   \n",
       "16                                   Inception (2010)   \n",
       "15                    How to Train Your Dragon (2010)   \n",
       "14  Hachiko: A Dog's Story (a.k.a. Hachi: A Dog's ...   \n",
       "17                          King's Speech, The (2010)   \n",
       "\n",
       "                                               genres  \n",
       "0         Adventure|Animation|Children|Comedy|Musical  \n",
       "11                 Adventure|Animation|Children|Drama  \n",
       "20                             Children|Drama|Mystery  \n",
       "18  Animation|Children|Comedy|Fantasy|Musical|Roma...  \n",
       "4         Adventure|Animation|Children|Comedy|Fantasy  \n",
       "1           Animation|Children|Comedy|Musical|Romance  \n",
       "16    Action|Crime|Drama|Mystery|Sci-Fi|Thriller|IMAX  \n",
       "15          Adventure|Animation|Children|Fantasy|IMAX  \n",
       "14                                              Drama  \n",
       "17                                              Drama  "
      ]
     },
     "execution_count": 93,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "already_rated.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>9087</th>\n",
       "      <td>163949</td>\n",
       "      <td>The Beatles: Eight Days a Week - The Touring Y...</td>\n",
       "      <td>Documentary</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5969</th>\n",
       "      <td>27882</td>\n",
       "      <td>Riding Giants (2004)</td>\n",
       "      <td>Documentary</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8192</th>\n",
       "      <td>98963</td>\n",
       "      <td>Neighbouring Sounds (O som ao redor) (2012)</td>\n",
       "      <td>Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8195</th>\n",
       "      <td>99030</td>\n",
       "      <td>Wrong (2012)</td>\n",
       "      <td>Comedy|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1412</th>\n",
       "      <td>1819</td>\n",
       "      <td>Storefront Hitchcock (1997)</td>\n",
       "      <td>Documentary|Musical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5733</th>\n",
       "      <td>26151</td>\n",
       "      <td>Au Hasard Balthazar (1966)</td>\n",
       "      <td>Crime|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5732</th>\n",
       "      <td>26150</td>\n",
       "      <td>Andrei Rublev (Andrey Rublyov) (1969)</td>\n",
       "      <td>Drama|War</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8221</th>\n",
       "      <td>99764</td>\n",
       "      <td>It's Such a Beautiful Day (2012)</td>\n",
       "      <td>Animation|Comedy|Drama|Fantasy|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5723</th>\n",
       "      <td>26094</td>\n",
       "      <td>Eclisse, L' (Eclipse) (1962)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1436</th>\n",
       "      <td>1859</td>\n",
       "      <td>Taste of Cherry (Ta'm e guilass) (1997)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      movieId                                              title  \\\n",
       "9087   163949  The Beatles: Eight Days a Week - The Touring Y...   \n",
       "5969    27882                               Riding Giants (2004)   \n",
       "8192    98963        Neighbouring Sounds (O som ao redor) (2012)   \n",
       "8195    99030                                       Wrong (2012)   \n",
       "1412     1819                        Storefront Hitchcock (1997)   \n",
       "5733    26151                         Au Hasard Balthazar (1966)   \n",
       "5732    26150              Andrei Rublev (Andrey Rublyov) (1969)   \n",
       "8221    99764                   It's Such a Beautiful Day (2012)   \n",
       "5723    26094                       Eclisse, L' (Eclipse) (1962)   \n",
       "1436     1859            Taste of Cherry (Ta'm e guilass) (1997)   \n",
       "\n",
       "                                     genres  \n",
       "9087                            Documentary  \n",
       "5969                            Documentary  \n",
       "8192                         Drama|Thriller  \n",
       "8195                           Comedy|Drama  \n",
       "1412                    Documentary|Musical  \n",
       "5733                            Crime|Drama  \n",
       "5732                              Drama|War  \n",
       "8221  Animation|Comedy|Drama|Fantasy|Sci-Fi  \n",
       "5723                                  Drama  \n",
       "1436                                  Drama  "
      ]
     },
     "execution_count": 100,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\"\"\"predictions based on column mean\"\"\"\n",
    "predictions.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The RMSE for simple fill based on column median is 0.97081984178\n"
     ]
    }
   ],
   "source": [
    "\"\"\"SimpleFill based on column median\"\"\"\n",
    "X_filled_simple_median = SimpleFill(fill_method=\"median\",min_value=1,max_value=5).complete(R_df)\n",
    "\"\"\"Rmse for simple fill based on the column median\"\"\"\n",
    "rmse_SimpleFill_median = rmse(X_filled_simple_median)\n",
    "print(\"The RMSE for simple fill based on column median is \"+str(rmse_SimpleFill_median))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "User 600 has already rated 35 movies.\n",
      "Recommending highest 10 predicted ratings movies not already rated.\n"
     ]
    }
   ],
   "source": [
    "already_rated, predictions = recommend_movies(pd.DataFrame(X_filled_simple_median,columns=R_df.columns), 600, movies_df, ratings_df, 10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>9087</th>\n",
       "      <td>163949</td>\n",
       "      <td>The Beatles: Eight Days a Week - The Touring Y...</td>\n",
       "      <td>Documentary</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7019</th>\n",
       "      <td>61250</td>\n",
       "      <td>House Bunny, The (2008)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6641</th>\n",
       "      <td>51471</td>\n",
       "      <td>Amazing Grace (2006)</td>\n",
       "      <td>Drama|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6608</th>\n",
       "      <td>50703</td>\n",
       "      <td>Secret, The (2006)</td>\n",
       "      <td>Documentary</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>936</th>\n",
       "      <td>1178</td>\n",
       "      <td>Paths of Glory (1957)</td>\n",
       "      <td>Drama|War</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>938</th>\n",
       "      <td>1180</td>\n",
       "      <td>Hear My Song (1991)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>949</th>\n",
       "      <td>1192</td>\n",
       "      <td>Paris Is Burning (1990)</td>\n",
       "      <td>Documentary</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6565</th>\n",
       "      <td>49280</td>\n",
       "      <td>Bobby (2006)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6549</th>\n",
       "      <td>48791</td>\n",
       "      <td>Flicka (2006)</td>\n",
       "      <td>Children|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6546</th>\n",
       "      <td>48774</td>\n",
       "      <td>Children of Men (2006)</td>\n",
       "      <td>Action|Adventure|Drama|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      movieId                                              title  \\\n",
       "9087   163949  The Beatles: Eight Days a Week - The Touring Y...   \n",
       "7019    61250                            House Bunny, The (2008)   \n",
       "6641    51471                               Amazing Grace (2006)   \n",
       "6608    50703                                 Secret, The (2006)   \n",
       "936      1178                              Paths of Glory (1957)   \n",
       "938      1180                                Hear My Song (1991)   \n",
       "949      1192                            Paris Is Burning (1990)   \n",
       "6565    49280                                       Bobby (2006)   \n",
       "6549    48791                                      Flicka (2006)   \n",
       "6546    48774                             Children of Men (2006)   \n",
       "\n",
       "                                      genres  \n",
       "9087                             Documentary  \n",
       "7019                                  Comedy  \n",
       "6641                           Drama|Romance  \n",
       "6608                             Documentary  \n",
       "936                                Drama|War  \n",
       "938                                   Comedy  \n",
       "949                              Documentary  \n",
       "6565                                   Drama  \n",
       "6549                          Children|Drama  \n",
       "6546  Action|Adventure|Drama|Sci-Fi|Thriller  "
      ]
     },
     "execution_count": 98,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\"\"\"predictions based on column median\"\"\"\n",
    "predictions.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The RMSE for simple fill based on random is 1.27340019207\n"
     ]
    }
   ],
   "source": [
    "\"\"\"random: fill with gaussian noise according to mean/std of column\"\"\"\n",
    "X_filled_simple_random = SimpleFill(fill_method=\"random\",min_value=1,max_value=5).complete(R_df)\n",
    "\"\"\"Rmse for simple fill based on the column median\"\"\"\n",
    "rmse_SimpleFill_random = rmse(X_filled_simple_random)\n",
    "print(\"The RMSE for simple fill based on random is \"+str(rmse_SimpleFill_random))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "User 600 has already rated 35 movies.\n",
      "Recommending highest 10 predicted ratings movies not already rated.\n"
     ]
    }
   ],
   "source": [
    "_, predictions = recommend_movies(pd.DataFrame(X_filled_simple_random,columns=R_df.columns), 600, movies_df, ratings_df, 10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5882</th>\n",
       "      <td>27178</td>\n",
       "      <td>In July (Im Juli) (2000)</td>\n",
       "      <td>Comedy|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1016</th>\n",
       "      <td>1263</td>\n",
       "      <td>Deer Hunter, The (1978)</td>\n",
       "      <td>Drama|War</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6939</th>\n",
       "      <td>59418</td>\n",
       "      <td>American Crime, An (2007)</td>\n",
       "      <td>Crime</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1702</th>\n",
       "      <td>2148</td>\n",
       "      <td>House (1986)</td>\n",
       "      <td>Comedy|Fantasy|Horror</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>448</th>\n",
       "      <td>501</td>\n",
       "      <td>Naked (1993)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>958</th>\n",
       "      <td>1202</td>\n",
       "      <td>Withnail &amp; I (1987)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3116</th>\n",
       "      <td>3908</td>\n",
       "      <td>Urban Legends: Final Cut (2000)</td>\n",
       "      <td>Horror</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2250</th>\n",
       "      <td>2810</td>\n",
       "      <td>Perfect Blue (1997)</td>\n",
       "      <td>Animation|Horror|Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2237</th>\n",
       "      <td>2797</td>\n",
       "      <td>Big (1988)</td>\n",
       "      <td>Comedy|Drama|Fantasy|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2343</th>\n",
       "      <td>2925</td>\n",
       "      <td>Conformist, The (Conformista, Il) (1970)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      movieId                                     title  \\\n",
       "5882    27178                  In July (Im Juli) (2000)   \n",
       "1016     1263                   Deer Hunter, The (1978)   \n",
       "6939    59418                 American Crime, An (2007)   \n",
       "1702     2148                              House (1986)   \n",
       "448       501                              Naked (1993)   \n",
       "958      1202                       Withnail & I (1987)   \n",
       "3116     3908           Urban Legends: Final Cut (2000)   \n",
       "2250     2810                       Perfect Blue (1997)   \n",
       "2237     2797                                Big (1988)   \n",
       "2343     2925  Conformist, The (Conformista, Il) (1970)   \n",
       "\n",
       "                                 genres  \n",
       "5882                     Comedy|Romance  \n",
       "1016                          Drama|War  \n",
       "6939                              Crime  \n",
       "1702              Comedy|Fantasy|Horror  \n",
       "448                               Drama  \n",
       "958                              Comedy  \n",
       "3116                             Horror  \n",
       "2250  Animation|Horror|Mystery|Thriller  \n",
       "2237       Comedy|Drama|Fantasy|Romance  \n",
       "2343                              Drama  "
      ]
     },
     "execution_count": 106,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\"\"\"predictions based on simple fill random\"\"\"\n",
    "predictions.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "k_list = [2,5,10,15,20]\n",
    "rmse_knn = []"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[KNN] Warning: 60901/6083286 still missing after imputation, replacing with 0\n",
      "[KNN] Warning: 60901/6083286 still missing after imputation, replacing with 0\n",
      "[KNN] Warning: 60901/6083286 still missing after imputation, replacing with 0\n",
      "[KNN] Warning: 60901/6083286 still missing after imputation, replacing with 0\n",
      "[KNN] Warning: 60901/6083286 still missing after imputation, replacing with 0\n"
     ]
    }
   ],
   "source": [
    "for k in k_list:\n",
    "    X_filled_knn = KNN(k=k,min_value=1,max_value=5,verbose=False).complete(R_df)\n",
    "    rmse_knn.append(rmse(X_filled_knn))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x11bd08438>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(k_list,rmse_knn)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'It can be seen that as K increases, the RMSE goes down. A better way would be to split the data into training \\nand testing. Check the value of test error and take the value for k where test error is minimum'"
      ]
     },
     "execution_count": 118,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\"\"\"It can be seen that as K increases, the RMSE goes down. A better way would be to split the data into training \n",
    "and testing. Check the value of test error and take the value for k where test error is minimum\"\"\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The RMSE for KNN with k=2 is 1.15156428334\n",
      "The RMSE for KNN with k=5 is 1.08545934209\n",
      "The RMSE for KNN with k=10 is 1.06390306038\n",
      "The RMSE for KNN with k=15 is 1.05689650694\n",
      "The RMSE for KNN with k=20 is 1.05342907862\n"
     ]
    }
   ],
   "source": [
    "for k,rmse in zip(k_list,rmse_knn):\n",
    "    print(\"The RMSE for KNN with k=\"+str(k)+\" is \"+str(rmse))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "\"\"\"Tried to run the following line but got no output for 7 hours. The developers of this package claim that\n",
    "this method is extremely slow and should be avoided for large dataset. Maybe if I had a better computer I could run\n",
    "it. :P\"\"\"\n",
    "\n",
    "X_filled_NNM = NuclearNormMinimization(min_value=1,max_value=5,error_tolerance = 0.001,fast_but_approximate=True,verbose=False).complete(R_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The RMSE for IterativeSVD method is 1.75492005864\n"
     ]
    }
   ],
   "source": [
    "X_filled_iterativeSVD = IterativeSVD(min_value=1,max_value=5,verbose=False).complete(R_df)\n",
    "rmse_IterativeSVD = rmse(X_filled_iterativeSVD)\n",
    "print(\"The RMSE for IterativeSVD method is \"+str(rmse_IterativeSVD))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "User 600 has already rated 35 movies.\n",
      "Recommending highest 10 predicted ratings movies not already rated.\n"
     ]
    }
   ],
   "source": [
    "_, predictions = recommend_movies(pd.DataFrame(X_filled_iterativeSVD,columns=R_df.columns), 600, movies_df, ratings_df, 10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5119</th>\n",
       "      <td>7361</td>\n",
       "      <td>Eternal Sunshine of the Spotless Mind (2004)</td>\n",
       "      <td>Drama|Romance|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5932</th>\n",
       "      <td>27773</td>\n",
       "      <td>Old Boy (2003)</td>\n",
       "      <td>Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6546</th>\n",
       "      <td>48774</td>\n",
       "      <td>Children of Men (2006)</td>\n",
       "      <td>Action|Adventure|Drama|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1046</th>\n",
       "      <td>1293</td>\n",
       "      <td>Gandhi (1982)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6530</th>\n",
       "      <td>48516</td>\n",
       "      <td>Departed, The (2006)</td>\n",
       "      <td>Crime|Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3363</th>\n",
       "      <td>4226</td>\n",
       "      <td>Memento (2000)</td>\n",
       "      <td>Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4425</th>\n",
       "      <td>6016</td>\n",
       "      <td>City of God (Cidade de Deus) (2002)</td>\n",
       "      <td>Action|Adventure|Crime|Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3370</th>\n",
       "      <td>4235</td>\n",
       "      <td>Amores Perros (Love's a Bitch) (2000)</td>\n",
       "      <td>Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6547</th>\n",
       "      <td>48780</td>\n",
       "      <td>Prestige, The (2006)</td>\n",
       "      <td>Drama|Mystery|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2034</th>\n",
       "      <td>2542</td>\n",
       "      <td>Lock, Stock &amp; Two Smoking Barrels (1998)</td>\n",
       "      <td>Comedy|Crime|Thriller</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      movieId                                         title  \\\n",
       "5119     7361  Eternal Sunshine of the Spotless Mind (2004)   \n",
       "5932    27773                                Old Boy (2003)   \n",
       "6546    48774                        Children of Men (2006)   \n",
       "1046     1293                                 Gandhi (1982)   \n",
       "6530    48516                          Departed, The (2006)   \n",
       "3363     4226                                Memento (2000)   \n",
       "4425     6016           City of God (Cidade de Deus) (2002)   \n",
       "3370     4235         Amores Perros (Love's a Bitch) (2000)   \n",
       "6547    48780                          Prestige, The (2006)   \n",
       "2034     2542      Lock, Stock & Two Smoking Barrels (1998)   \n",
       "\n",
       "                                      genres  \n",
       "5119                    Drama|Romance|Sci-Fi  \n",
       "5932                        Mystery|Thriller  \n",
       "6546  Action|Adventure|Drama|Sci-Fi|Thriller  \n",
       "1046                                   Drama  \n",
       "6530                    Crime|Drama|Thriller  \n",
       "3363                        Mystery|Thriller  \n",
       "4425   Action|Adventure|Crime|Drama|Thriller  \n",
       "3370                          Drama|Thriller  \n",
       "6547           Drama|Mystery|Sci-Fi|Thriller  \n",
       "2034                   Comedy|Crime|Thriller  "
      ]
     },
     "execution_count": 138,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predictions.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "metadata": {},
   "outputs": [],
   "source": [
    "shrinkage_value = [5,10,15,20,25,30,40,45,50]\n",
    "rmse_softimpute = []\n",
    "for i in shrinkage_value:\n",
    "    X_simple_softimpute = SoftImpute(shrinkage_value=i,convergence_threshold=0.0001,max_iters=1000,min_value=1,max_value=5,verbose=False).complete(R_df)\n",
    "    rmse_softimpute.append(rmse(X_simple_softimpute))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Max Singular Value of X_init = 517.583140\n",
      "[SoftImpute] Iter 1: observed MAE=0.564134 rank=605\n",
      "[SoftImpute] Iter 2: observed MAE=0.548074 rank=539\n",
      "[SoftImpute] Iter 3: observed MAE=0.539165 rank=483\n",
      "[SoftImpute] Iter 4: observed MAE=0.530032 rank=442\n",
      "[SoftImpute] Iter 5: observed MAE=0.521732 rank=410\n",
      "[SoftImpute] Iter 6: observed MAE=0.514251 rank=383\n",
      "[SoftImpute] Iter 7: observed MAE=0.507694 rank=360\n",
      "[SoftImpute] Iter 8: observed MAE=0.501839 rank=341\n",
      "[SoftImpute] Iter 9: observed MAE=0.496683 rank=323\n",
      "[SoftImpute] Iter 10: observed MAE=0.492094 rank=307\n",
      "[SoftImpute] Iter 11: observed MAE=0.487992 rank=295\n",
      "[SoftImpute] Iter 12: observed MAE=0.484401 rank=283\n",
      "[SoftImpute] Iter 13: observed MAE=0.481194 rank=272\n",
      "[SoftImpute] Iter 14: observed MAE=0.478240 rank=263\n",
      "[SoftImpute] Iter 15: observed MAE=0.475565 rank=254\n",
      "[SoftImpute] Iter 16: observed MAE=0.473149 rank=245\n",
      "[SoftImpute] Iter 17: observed MAE=0.471005 rank=239\n",
      "[SoftImpute] Iter 18: observed MAE=0.469089 rank=233\n",
      "[SoftImpute] Iter 19: observed MAE=0.467257 rank=226\n",
      "[SoftImpute] Iter 20: observed MAE=0.465568 rank=220\n",
      "[SoftImpute] Iter 21: observed MAE=0.463966 rank=216\n",
      "[SoftImpute] Iter 22: observed MAE=0.462559 rank=211\n",
      "[SoftImpute] Iter 23: observed MAE=0.461228 rank=205\n",
      "[SoftImpute] Iter 24: observed MAE=0.459964 rank=200\n",
      "[SoftImpute] Iter 25: observed MAE=0.458786 rank=198\n",
      "[SoftImpute] Iter 26: observed MAE=0.457730 rank=193\n",
      "[SoftImpute] Iter 27: observed MAE=0.456706 rank=190\n",
      "[SoftImpute] Iter 28: observed MAE=0.455750 rank=187\n",
      "[SoftImpute] Iter 29: observed MAE=0.454861 rank=184\n",
      "[SoftImpute] Iter 30: observed MAE=0.454002 rank=181\n",
      "[SoftImpute] Iter 31: observed MAE=0.453199 rank=178\n",
      "[SoftImpute] Iter 32: observed MAE=0.452445 rank=176\n",
      "[SoftImpute] Iter 33: observed MAE=0.451742 rank=173\n",
      "[SoftImpute] Iter 34: observed MAE=0.451079 rank=172\n",
      "[SoftImpute] Iter 35: observed MAE=0.450441 rank=169\n",
      "[SoftImpute] Iter 36: observed MAE=0.449799 rank=166\n",
      "[SoftImpute] Iter 37: observed MAE=0.449183 rank=163\n",
      "[SoftImpute] Iter 38: observed MAE=0.448588 rank=162\n",
      "[SoftImpute] Iter 39: observed MAE=0.448067 rank=160\n",
      "[SoftImpute] Iter 40: observed MAE=0.447525 rank=157\n",
      "[SoftImpute] Iter 41: observed MAE=0.446996 rank=156\n",
      "[SoftImpute] Iter 42: observed MAE=0.446495 rank=154\n",
      "[SoftImpute] Iter 43: observed MAE=0.446042 rank=153\n",
      "[SoftImpute] Iter 44: observed MAE=0.445596 rank=152\n",
      "[SoftImpute] Iter 45: observed MAE=0.445163 rank=150\n",
      "[SoftImpute] Iter 46: observed MAE=0.444756 rank=149\n",
      "[SoftImpute] Iter 47: observed MAE=0.444367 rank=147\n",
      "[SoftImpute] Iter 48: observed MAE=0.443998 rank=147\n",
      "[SoftImpute] Iter 49: observed MAE=0.443647 rank=145\n",
      "[SoftImpute] Iter 50: observed MAE=0.443314 rank=145\n",
      "[SoftImpute] Iter 51: observed MAE=0.443001 rank=143\n",
      "[SoftImpute] Iter 52: observed MAE=0.442666 rank=142\n",
      "[SoftImpute] Iter 53: observed MAE=0.442351 rank=141\n",
      "[SoftImpute] Iter 54: observed MAE=0.442042 rank=140\n",
      "[SoftImpute] Iter 55: observed MAE=0.441745 rank=138\n",
      "[SoftImpute] Iter 56: observed MAE=0.441450 rank=137\n",
      "[SoftImpute] Iter 57: observed MAE=0.441162 rank=136\n",
      "[SoftImpute] Iter 58: observed MAE=0.440883 rank=135\n",
      "[SoftImpute] Iter 59: observed MAE=0.440595 rank=134\n",
      "[SoftImpute] Iter 60: observed MAE=0.440339 rank=133\n",
      "[SoftImpute] Iter 61: observed MAE=0.440083 rank=133\n",
      "[SoftImpute] Iter 62: observed MAE=0.439841 rank=132\n",
      "[SoftImpute] Iter 63: observed MAE=0.439607 rank=132\n",
      "[SoftImpute] Iter 64: observed MAE=0.439371 rank=130\n",
      "[SoftImpute] Iter 65: observed MAE=0.439138 rank=130\n",
      "[SoftImpute] Iter 66: observed MAE=0.438926 rank=130\n",
      "[SoftImpute] Iter 67: observed MAE=0.438707 rank=129\n",
      "[SoftImpute] Iter 68: observed MAE=0.438499 rank=128\n",
      "[SoftImpute] Iter 69: observed MAE=0.438292 rank=128\n",
      "[SoftImpute] Iter 70: observed MAE=0.438101 rank=128\n",
      "[SoftImpute] Iter 71: observed MAE=0.437905 rank=127\n",
      "[SoftImpute] Iter 72: observed MAE=0.437721 rank=126\n",
      "[SoftImpute] Iter 73: observed MAE=0.437529 rank=126\n",
      "[SoftImpute] Iter 74: observed MAE=0.437339 rank=125\n",
      "[SoftImpute] Iter 75: observed MAE=0.437152 rank=124\n",
      "[SoftImpute] Iter 76: observed MAE=0.436970 rank=124\n",
      "[SoftImpute] Iter 77: observed MAE=0.436794 rank=123\n",
      "[SoftImpute] Iter 78: observed MAE=0.436619 rank=123\n",
      "[SoftImpute] Iter 79: observed MAE=0.436455 rank=122\n",
      "[SoftImpute] Iter 80: observed MAE=0.436286 rank=122\n",
      "[SoftImpute] Iter 81: observed MAE=0.436128 rank=122\n",
      "[SoftImpute] Iter 82: observed MAE=0.435961 rank=120\n",
      "[SoftImpute] Iter 83: observed MAE=0.435792 rank=120\n",
      "[SoftImpute] Iter 84: observed MAE=0.435636 rank=120\n",
      "[SoftImpute] Iter 85: observed MAE=0.435489 rank=120\n",
      "[SoftImpute] Iter 86: observed MAE=0.435341 rank=119\n",
      "[SoftImpute] Iter 87: observed MAE=0.435196 rank=119\n",
      "[SoftImpute] Iter 88: observed MAE=0.435055 rank=119\n",
      "[SoftImpute] Iter 89: observed MAE=0.434908 rank=118\n",
      "[SoftImpute] Iter 90: observed MAE=0.434769 rank=118\n",
      "[SoftImpute] Iter 91: observed MAE=0.434626 rank=117\n",
      "[SoftImpute] Iter 92: observed MAE=0.434490 rank=117\n",
      "[SoftImpute] Iter 93: observed MAE=0.434359 rank=117\n",
      "[SoftImpute] Iter 94: observed MAE=0.434233 rank=116\n",
      "[SoftImpute] Iter 95: observed MAE=0.434102 rank=116\n",
      "[SoftImpute] Iter 96: observed MAE=0.433977 rank=116\n",
      "[SoftImpute] Iter 97: observed MAE=0.433855 rank=115\n",
      "[SoftImpute] Iter 98: observed MAE=0.433726 rank=115\n",
      "[SoftImpute] Iter 99: observed MAE=0.433603 rank=114\n",
      "[SoftImpute] Iter 100: observed MAE=0.433475 rank=114\n",
      "[SoftImpute] Iter 101: observed MAE=0.433355 rank=114\n",
      "[SoftImpute] Iter 102: observed MAE=0.433233 rank=113\n",
      "[SoftImpute] Iter 103: observed MAE=0.433115 rank=113\n",
      "[SoftImpute] Iter 104: observed MAE=0.433002 rank=113\n",
      "[SoftImpute] Iter 105: observed MAE=0.432893 rank=113\n",
      "[SoftImpute] Iter 106: observed MAE=0.432785 rank=113\n",
      "[SoftImpute] Iter 107: observed MAE=0.432681 rank=113\n",
      "[SoftImpute] Iter 108: observed MAE=0.432578 rank=113\n",
      "[SoftImpute] Iter 109: observed MAE=0.432477 rank=113\n",
      "[SoftImpute] Iter 110: observed MAE=0.432377 rank=113\n",
      "[SoftImpute] Iter 111: observed MAE=0.432273 rank=112\n",
      "[SoftImpute] Iter 112: observed MAE=0.432172 rank=112\n",
      "[SoftImpute] Iter 113: observed MAE=0.432074 rank=112\n",
      "[SoftImpute] Iter 114: observed MAE=0.431977 rank=112\n",
      "[SoftImpute] Iter 115: observed MAE=0.431882 rank=112\n",
      "[SoftImpute] Iter 116: observed MAE=0.431790 rank=112\n",
      "[SoftImpute] Iter 117: observed MAE=0.431692 rank=111\n",
      "[SoftImpute] Iter 118: observed MAE=0.431597 rank=111\n",
      "[SoftImpute] Iter 119: observed MAE=0.431504 rank=111\n",
      "[SoftImpute] Iter 120: observed MAE=0.431414 rank=111\n",
      "[SoftImpute] Iter 121: observed MAE=0.431326 rank=111\n",
      "[SoftImpute] Iter 122: observed MAE=0.431239 rank=111\n",
      "[SoftImpute] Iter 123: observed MAE=0.431151 rank=110\n",
      "[SoftImpute] Iter 124: observed MAE=0.431063 rank=110\n",
      "[SoftImpute] Iter 125: observed MAE=0.430978 rank=110\n",
      "[SoftImpute] Iter 126: observed MAE=0.430894 rank=110\n",
      "[SoftImpute] Iter 127: observed MAE=0.430811 rank=110\n",
      "[SoftImpute] Iter 128: observed MAE=0.430729 rank=110\n",
      "[SoftImpute] Iter 129: observed MAE=0.430648 rank=110\n",
      "[SoftImpute] Iter 130: observed MAE=0.430568 rank=110\n",
      "[SoftImpute] Iter 131: observed MAE=0.430489 rank=110\n",
      "[SoftImpute] Iter 132: observed MAE=0.430409 rank=109\n",
      "[SoftImpute] Iter 133: observed MAE=0.430329 rank=109\n",
      "[SoftImpute] Iter 134: observed MAE=0.430252 rank=109\n",
      "[SoftImpute] Iter 135: observed MAE=0.430176 rank=109\n",
      "[SoftImpute] Iter 136: observed MAE=0.430102 rank=109\n",
      "[SoftImpute] Iter 137: observed MAE=0.430029 rank=109\n",
      "[SoftImpute] Iter 138: observed MAE=0.429956 rank=109\n",
      "[SoftImpute] Iter 139: observed MAE=0.429883 rank=108\n",
      "[SoftImpute] Iter 140: observed MAE=0.429809 rank=108\n",
      "[SoftImpute] Iter 141: observed MAE=0.429737 rank=108\n",
      "[SoftImpute] Iter 142: observed MAE=0.429666 rank=108\n",
      "[SoftImpute] Iter 143: observed MAE=0.429595 rank=107\n",
      "[SoftImpute] Iter 144: observed MAE=0.429524 rank=107\n",
      "[SoftImpute] Iter 145: observed MAE=0.429455 rank=107\n",
      "[SoftImpute] Iter 146: observed MAE=0.429387 rank=107\n",
      "[SoftImpute] Iter 147: observed MAE=0.429320 rank=107\n",
      "[SoftImpute] Iter 148: observed MAE=0.429255 rank=107\n",
      "[SoftImpute] Iter 149: observed MAE=0.429190 rank=107\n",
      "[SoftImpute] Iter 150: observed MAE=0.429126 rank=107\n",
      "[SoftImpute] Iter 151: observed MAE=0.429063 rank=107\n",
      "[SoftImpute] Iter 152: observed MAE=0.429001 rank=107\n",
      "[SoftImpute] Iter 153: observed MAE=0.428939 rank=107\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 154: observed MAE=0.428877 rank=106\n",
      "[SoftImpute] Iter 155: observed MAE=0.428814 rank=106\n",
      "[SoftImpute] Iter 156: observed MAE=0.428753 rank=106\n",
      "[SoftImpute] Iter 157: observed MAE=0.428693 rank=106\n",
      "[SoftImpute] Iter 158: observed MAE=0.428634 rank=106\n",
      "[SoftImpute] Iter 159: observed MAE=0.428576 rank=106\n",
      "[SoftImpute] Iter 160: observed MAE=0.428519 rank=106\n",
      "[SoftImpute] Iter 161: observed MAE=0.428462 rank=106\n",
      "[SoftImpute] Iter 162: observed MAE=0.428405 rank=106\n",
      "[SoftImpute] Iter 163: observed MAE=0.428349 rank=106\n",
      "[SoftImpute] Iter 164: observed MAE=0.428294 rank=106\n",
      "[SoftImpute] Iter 165: observed MAE=0.428239 rank=106\n",
      "[SoftImpute] Iter 166: observed MAE=0.428182 rank=105\n",
      "[SoftImpute] Iter 167: observed MAE=0.428126 rank=105\n",
      "[SoftImpute] Iter 168: observed MAE=0.428071 rank=105\n",
      "[SoftImpute] Iter 169: observed MAE=0.428017 rank=105\n",
      "[SoftImpute] Iter 170: observed MAE=0.427964 rank=105\n",
      "[SoftImpute] Iter 171: observed MAE=0.427912 rank=105\n",
      "[SoftImpute] Iter 172: observed MAE=0.427860 rank=105\n",
      "[SoftImpute] Iter 173: observed MAE=0.427809 rank=105\n",
      "[SoftImpute] Iter 174: observed MAE=0.427758 rank=105\n",
      "[SoftImpute] Iter 175: observed MAE=0.427708 rank=105\n",
      "[SoftImpute] Iter 176: observed MAE=0.427658 rank=105\n",
      "[SoftImpute] Iter 177: observed MAE=0.427609 rank=105\n",
      "[SoftImpute] Iter 178: observed MAE=0.427560 rank=105\n",
      "[SoftImpute] Iter 179: observed MAE=0.427512 rank=105\n",
      "[SoftImpute] Iter 180: observed MAE=0.427464 rank=105\n",
      "[SoftImpute] Iter 181: observed MAE=0.427417 rank=105\n",
      "[SoftImpute] Iter 182: observed MAE=0.427370 rank=105\n",
      "[SoftImpute] Iter 183: observed MAE=0.427324 rank=105\n",
      "[SoftImpute] Iter 184: observed MAE=0.427278 rank=105\n",
      "[SoftImpute] Iter 185: observed MAE=0.427232 rank=105\n",
      "[SoftImpute] Iter 186: observed MAE=0.427187 rank=105\n",
      "[SoftImpute] Iter 187: observed MAE=0.427143 rank=105\n",
      "[SoftImpute] Iter 188: observed MAE=0.427097 rank=104\n",
      "[SoftImpute] Iter 189: observed MAE=0.427051 rank=104\n",
      "[SoftImpute] Iter 190: observed MAE=0.427006 rank=104\n",
      "[SoftImpute] Iter 191: observed MAE=0.426962 rank=104\n",
      "[SoftImpute] Iter 192: observed MAE=0.426918 rank=104\n",
      "[SoftImpute] Iter 193: observed MAE=0.426874 rank=104\n",
      "[SoftImpute] Iter 194: observed MAE=0.426832 rank=104\n",
      "[SoftImpute] Iter 195: observed MAE=0.426789 rank=104\n",
      "[SoftImpute] Iter 196: observed MAE=0.426747 rank=104\n",
      "[SoftImpute] Iter 197: observed MAE=0.426705 rank=104\n",
      "[SoftImpute] Iter 198: observed MAE=0.426664 rank=104\n",
      "[SoftImpute] Iter 199: observed MAE=0.426623 rank=104\n",
      "[SoftImpute] Iter 200: observed MAE=0.426581 rank=103\n",
      "[SoftImpute] Iter 201: observed MAE=0.426539 rank=103\n",
      "[SoftImpute] Iter 202: observed MAE=0.426498 rank=103\n",
      "[SoftImpute] Iter 203: observed MAE=0.426456 rank=102\n",
      "[SoftImpute] Iter 204: observed MAE=0.426416 rank=102\n",
      "[SoftImpute] Iter 205: observed MAE=0.426375 rank=102\n",
      "[SoftImpute] Iter 206: observed MAE=0.426336 rank=102\n",
      "[SoftImpute] Iter 207: observed MAE=0.426297 rank=102\n",
      "[SoftImpute] Iter 208: observed MAE=0.426259 rank=102\n",
      "[SoftImpute] Iter 209: observed MAE=0.426221 rank=102\n",
      "[SoftImpute] Iter 210: observed MAE=0.426183 rank=102\n",
      "[SoftImpute] Iter 211: observed MAE=0.426146 rank=102\n",
      "[SoftImpute] Iter 212: observed MAE=0.426109 rank=102\n",
      "[SoftImpute] Iter 213: observed MAE=0.426072 rank=102\n",
      "[SoftImpute] Iter 214: observed MAE=0.426036 rank=102\n",
      "[SoftImpute] Iter 215: observed MAE=0.425999 rank=102\n",
      "[SoftImpute] Iter 216: observed MAE=0.425963 rank=102\n",
      "[SoftImpute] Iter 217: observed MAE=0.425928 rank=102\n",
      "[SoftImpute] Iter 218: observed MAE=0.425892 rank=102\n",
      "[SoftImpute] Iter 219: observed MAE=0.425857 rank=102\n",
      "[SoftImpute] Iter 220: observed MAE=0.425822 rank=102\n",
      "[SoftImpute] Iter 221: observed MAE=0.425788 rank=102\n",
      "[SoftImpute] Iter 222: observed MAE=0.425754 rank=102\n",
      "[SoftImpute] Iter 223: observed MAE=0.425720 rank=102\n",
      "[SoftImpute] Iter 224: observed MAE=0.425686 rank=102\n",
      "[SoftImpute] Iter 225: observed MAE=0.425653 rank=102\n",
      "[SoftImpute] Iter 226: observed MAE=0.425620 rank=102\n",
      "[SoftImpute] Iter 227: observed MAE=0.425587 rank=102\n",
      "[SoftImpute] Iter 228: observed MAE=0.425555 rank=102\n",
      "[SoftImpute] Iter 229: observed MAE=0.425523 rank=102\n",
      "[SoftImpute] Iter 230: observed MAE=0.425490 rank=102\n",
      "[SoftImpute] Iter 231: observed MAE=0.425459 rank=102\n",
      "[SoftImpute] Iter 232: observed MAE=0.425427 rank=102\n",
      "[SoftImpute] Iter 233: observed MAE=0.425396 rank=102\n",
      "[SoftImpute] Iter 234: observed MAE=0.425365 rank=102\n",
      "[SoftImpute] Iter 235: observed MAE=0.425334 rank=102\n",
      "[SoftImpute] Iter 236: observed MAE=0.425304 rank=102\n",
      "[SoftImpute] Iter 237: observed MAE=0.425273 rank=102\n",
      "[SoftImpute] Iter 238: observed MAE=0.425243 rank=102\n",
      "[SoftImpute] Iter 239: observed MAE=0.425213 rank=102\n",
      "[SoftImpute] Iter 240: observed MAE=0.425184 rank=102\n",
      "[SoftImpute] Iter 241: observed MAE=0.425154 rank=102\n",
      "[SoftImpute] Iter 242: observed MAE=0.425125 rank=102\n",
      "[SoftImpute] Iter 243: observed MAE=0.425096 rank=102\n",
      "[SoftImpute] Iter 244: observed MAE=0.425067 rank=102\n",
      "[SoftImpute] Iter 245: observed MAE=0.425038 rank=102\n",
      "[SoftImpute] Iter 246: observed MAE=0.425010 rank=102\n",
      "[SoftImpute] Iter 247: observed MAE=0.424981 rank=102\n",
      "[SoftImpute] Iter 248: observed MAE=0.424953 rank=102\n",
      "[SoftImpute] Iter 249: observed MAE=0.424926 rank=102\n",
      "[SoftImpute] Iter 250: observed MAE=0.424898 rank=102\n",
      "[SoftImpute] Iter 251: observed MAE=0.424871 rank=102\n",
      "[SoftImpute] Iter 252: observed MAE=0.424844 rank=102\n",
      "[SoftImpute] Iter 253: observed MAE=0.424817 rank=102\n",
      "[SoftImpute] Iter 254: observed MAE=0.424790 rank=102\n",
      "[SoftImpute] Iter 255: observed MAE=0.424764 rank=102\n",
      "[SoftImpute] Iter 256: observed MAE=0.424738 rank=102\n",
      "[SoftImpute] Iter 257: observed MAE=0.424711 rank=102\n",
      "[SoftImpute] Iter 258: observed MAE=0.424685 rank=101\n",
      "[SoftImpute] Iter 259: observed MAE=0.424658 rank=101\n",
      "[SoftImpute] Iter 260: observed MAE=0.424632 rank=101\n",
      "[SoftImpute] Iter 261: observed MAE=0.424606 rank=101\n",
      "[SoftImpute] Iter 262: observed MAE=0.424581 rank=101\n",
      "[SoftImpute] Iter 263: observed MAE=0.424555 rank=101\n",
      "[SoftImpute] Iter 264: observed MAE=0.424530 rank=101\n",
      "[SoftImpute] Iter 265: observed MAE=0.424505 rank=101\n",
      "[SoftImpute] Iter 266: observed MAE=0.424481 rank=101\n",
      "[SoftImpute] Iter 267: observed MAE=0.424456 rank=101\n",
      "[SoftImpute] Iter 268: observed MAE=0.424432 rank=101\n",
      "[SoftImpute] Iter 269: observed MAE=0.424408 rank=101\n",
      "[SoftImpute] Iter 270: observed MAE=0.424383 rank=100\n",
      "[SoftImpute] Iter 271: observed MAE=0.424358 rank=100\n",
      "[SoftImpute] Iter 272: observed MAE=0.424334 rank=100\n",
      "[SoftImpute] Iter 273: observed MAE=0.424310 rank=100\n",
      "[SoftImpute] Iter 274: observed MAE=0.424287 rank=100\n",
      "[SoftImpute] Iter 275: observed MAE=0.424263 rank=100\n",
      "[SoftImpute] Iter 276: observed MAE=0.424240 rank=100\n",
      "[SoftImpute] Iter 277: observed MAE=0.424217 rank=100\n",
      "[SoftImpute] Iter 278: observed MAE=0.424194 rank=100\n",
      "[SoftImpute] Iter 279: observed MAE=0.424171 rank=100\n",
      "[SoftImpute] Iter 280: observed MAE=0.424149 rank=100\n",
      "[SoftImpute] Iter 281: observed MAE=0.424126 rank=100\n",
      "[SoftImpute] Iter 282: observed MAE=0.424104 rank=100\n",
      "[SoftImpute] Iter 283: observed MAE=0.424082 rank=100\n",
      "[SoftImpute] Iter 284: observed MAE=0.424061 rank=100\n",
      "[SoftImpute] Iter 285: observed MAE=0.424039 rank=100\n",
      "[SoftImpute] Iter 286: observed MAE=0.424017 rank=100\n",
      "[SoftImpute] Iter 287: observed MAE=0.423996 rank=100\n",
      "[SoftImpute] Iter 288: observed MAE=0.423975 rank=100\n",
      "[SoftImpute] Iter 289: observed MAE=0.423954 rank=100\n",
      "[SoftImpute] Iter 290: observed MAE=0.423933 rank=100\n",
      "[SoftImpute] Iter 291: observed MAE=0.423913 rank=100\n",
      "[SoftImpute] Iter 292: observed MAE=0.423892 rank=100\n",
      "[SoftImpute] Iter 293: observed MAE=0.423872 rank=100\n",
      "[SoftImpute] Iter 294: observed MAE=0.423852 rank=100\n",
      "[SoftImpute] Iter 295: observed MAE=0.423832 rank=100\n",
      "[SoftImpute] Iter 296: observed MAE=0.423812 rank=100\n",
      "[SoftImpute] Iter 297: observed MAE=0.423792 rank=100\n",
      "[SoftImpute] Iter 298: observed MAE=0.423772 rank=100\n",
      "[SoftImpute] Iter 299: observed MAE=0.423753 rank=100\n",
      "[SoftImpute] Iter 300: observed MAE=0.423733 rank=100\n",
      "[SoftImpute] Iter 301: observed MAE=0.423714 rank=100\n",
      "[SoftImpute] Iter 302: observed MAE=0.423695 rank=100\n",
      "[SoftImpute] Iter 303: observed MAE=0.423676 rank=100\n",
      "[SoftImpute] Iter 304: observed MAE=0.423657 rank=100\n",
      "[SoftImpute] Iter 305: observed MAE=0.423638 rank=100\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 306: observed MAE=0.423619 rank=100\n",
      "[SoftImpute] Iter 307: observed MAE=0.423601 rank=100\n",
      "[SoftImpute] Iter 308: observed MAE=0.423582 rank=100\n",
      "[SoftImpute] Iter 309: observed MAE=0.423564 rank=100\n",
      "[SoftImpute] Iter 310: observed MAE=0.423546 rank=100\n",
      "[SoftImpute] Iter 311: observed MAE=0.423527 rank=100\n",
      "[SoftImpute] Iter 312: observed MAE=0.423509 rank=100\n",
      "[SoftImpute] Iter 313: observed MAE=0.423492 rank=100\n",
      "[SoftImpute] Iter 314: observed MAE=0.423474 rank=100\n",
      "[SoftImpute] Iter 315: observed MAE=0.423456 rank=100\n",
      "[SoftImpute] Iter 316: observed MAE=0.423438 rank=100\n",
      "[SoftImpute] Iter 317: observed MAE=0.423421 rank=100\n",
      "[SoftImpute] Iter 318: observed MAE=0.423403 rank=100\n",
      "[SoftImpute] Iter 319: observed MAE=0.423386 rank=100\n",
      "[SoftImpute] Iter 320: observed MAE=0.423369 rank=100\n",
      "[SoftImpute] Iter 321: observed MAE=0.423352 rank=100\n",
      "[SoftImpute] Iter 322: observed MAE=0.423335 rank=100\n",
      "[SoftImpute] Iter 323: observed MAE=0.423318 rank=100\n",
      "[SoftImpute] Iter 324: observed MAE=0.423301 rank=100\n",
      "[SoftImpute] Iter 325: observed MAE=0.423284 rank=100\n",
      "[SoftImpute] Iter 326: observed MAE=0.423268 rank=100\n",
      "[SoftImpute] Iter 327: observed MAE=0.423251 rank=100\n",
      "[SoftImpute] Iter 328: observed MAE=0.423234 rank=100\n",
      "[SoftImpute] Iter 329: observed MAE=0.423218 rank=100\n",
      "[SoftImpute] Iter 330: observed MAE=0.423202 rank=100\n",
      "[SoftImpute] Iter 331: observed MAE=0.423185 rank=100\n",
      "[SoftImpute] Iter 332: observed MAE=0.423169 rank=100\n",
      "[SoftImpute] Iter 333: observed MAE=0.423153 rank=100\n",
      "[SoftImpute] Iter 334: observed MAE=0.423137 rank=100\n",
      "[SoftImpute] Iter 335: observed MAE=0.423121 rank=100\n",
      "[SoftImpute] Iter 336: observed MAE=0.423105 rank=100\n",
      "[SoftImpute] Iter 337: observed MAE=0.423089 rank=100\n",
      "[SoftImpute] Iter 338: observed MAE=0.423073 rank=100\n",
      "[SoftImpute] Iter 339: observed MAE=0.423058 rank=100\n",
      "[SoftImpute] Iter 340: observed MAE=0.423042 rank=100\n",
      "[SoftImpute] Iter 341: observed MAE=0.423027 rank=100\n",
      "[SoftImpute] Iter 342: observed MAE=0.423011 rank=100\n",
      "[SoftImpute] Iter 343: observed MAE=0.422996 rank=100\n",
      "[SoftImpute] Iter 344: observed MAE=0.422981 rank=100\n",
      "[SoftImpute] Iter 345: observed MAE=0.422966 rank=100\n",
      "[SoftImpute] Iter 346: observed MAE=0.422951 rank=100\n",
      "[SoftImpute] Iter 347: observed MAE=0.422936 rank=100\n",
      "[SoftImpute] Iter 348: observed MAE=0.422922 rank=100\n",
      "[SoftImpute] Iter 349: observed MAE=0.422907 rank=100\n",
      "[SoftImpute] Iter 350: observed MAE=0.422892 rank=100\n",
      "[SoftImpute] Iter 351: observed MAE=0.422878 rank=100\n",
      "[SoftImpute] Iter 352: observed MAE=0.422863 rank=100\n",
      "[SoftImpute] Iter 353: observed MAE=0.422849 rank=100\n",
      "[SoftImpute] Iter 354: observed MAE=0.422834 rank=100\n",
      "[SoftImpute] Iter 355: observed MAE=0.422820 rank=100\n",
      "[SoftImpute] Iter 356: observed MAE=0.422806 rank=100\n",
      "[SoftImpute] Iter 357: observed MAE=0.422792 rank=100\n",
      "[SoftImpute] Iter 358: observed MAE=0.422778 rank=100\n",
      "[SoftImpute] Iter 359: observed MAE=0.422764 rank=100\n",
      "[SoftImpute] Iter 360: observed MAE=0.422750 rank=100\n",
      "[SoftImpute] Iter 361: observed MAE=0.422736 rank=100\n",
      "[SoftImpute] Iter 362: observed MAE=0.422722 rank=100\n",
      "[SoftImpute] Iter 363: observed MAE=0.422709 rank=100\n",
      "[SoftImpute] Iter 364: observed MAE=0.422695 rank=100\n",
      "[SoftImpute] Iter 365: observed MAE=0.422681 rank=100\n",
      "[SoftImpute] Iter 366: observed MAE=0.422668 rank=100\n",
      "[SoftImpute] Iter 367: observed MAE=0.422654 rank=100\n",
      "[SoftImpute] Iter 368: observed MAE=0.422641 rank=100\n",
      "[SoftImpute] Iter 369: observed MAE=0.422628 rank=100\n",
      "[SoftImpute] Iter 370: observed MAE=0.422615 rank=100\n",
      "[SoftImpute] Iter 371: observed MAE=0.422601 rank=100\n",
      "[SoftImpute] Iter 372: observed MAE=0.422588 rank=100\n",
      "[SoftImpute] Iter 373: observed MAE=0.422575 rank=99\n",
      "[SoftImpute] Iter 374: observed MAE=0.422562 rank=99\n",
      "[SoftImpute] Iter 375: observed MAE=0.422548 rank=99\n",
      "[SoftImpute] Iter 376: observed MAE=0.422535 rank=99\n",
      "[SoftImpute] Iter 377: observed MAE=0.422522 rank=99\n",
      "[SoftImpute] Iter 378: observed MAE=0.422509 rank=99\n",
      "[SoftImpute] Iter 379: observed MAE=0.422496 rank=99\n",
      "[SoftImpute] Iter 380: observed MAE=0.422483 rank=99\n",
      "[SoftImpute] Iter 381: observed MAE=0.422471 rank=99\n",
      "[SoftImpute] Iter 382: observed MAE=0.422458 rank=99\n",
      "[SoftImpute] Iter 383: observed MAE=0.422445 rank=99\n",
      "[SoftImpute] Iter 384: observed MAE=0.422433 rank=99\n",
      "[SoftImpute] Iter 385: observed MAE=0.422420 rank=99\n",
      "[SoftImpute] Iter 386: observed MAE=0.422408 rank=99\n",
      "[SoftImpute] Iter 387: observed MAE=0.422395 rank=99\n",
      "[SoftImpute] Iter 388: observed MAE=0.422383 rank=99\n",
      "[SoftImpute] Iter 389: observed MAE=0.422371 rank=99\n",
      "[SoftImpute] Iter 390: observed MAE=0.422359 rank=99\n",
      "[SoftImpute] Iter 391: observed MAE=0.422347 rank=99\n",
      "[SoftImpute] Iter 392: observed MAE=0.422335 rank=99\n",
      "[SoftImpute] Iter 393: observed MAE=0.422323 rank=99\n",
      "[SoftImpute] Iter 394: observed MAE=0.422311 rank=99\n",
      "[SoftImpute] Iter 395: observed MAE=0.422299 rank=99\n",
      "[SoftImpute] Iter 396: observed MAE=0.422287 rank=99\n",
      "[SoftImpute] Iter 397: observed MAE=0.422275 rank=99\n",
      "[SoftImpute] Iter 398: observed MAE=0.422263 rank=98\n",
      "[SoftImpute] Iter 399: observed MAE=0.422251 rank=98\n",
      "[SoftImpute] Iter 400: observed MAE=0.422239 rank=98\n",
      "[SoftImpute] Iter 401: observed MAE=0.422227 rank=98\n",
      "[SoftImpute] Iter 402: observed MAE=0.422215 rank=98\n",
      "[SoftImpute] Iter 403: observed MAE=0.422204 rank=98\n",
      "[SoftImpute] Iter 404: observed MAE=0.422192 rank=98\n",
      "[SoftImpute] Iter 405: observed MAE=0.422181 rank=98\n",
      "[SoftImpute] Iter 406: observed MAE=0.422169 rank=98\n",
      "[SoftImpute] Iter 407: observed MAE=0.422158 rank=98\n",
      "[SoftImpute] Iter 408: observed MAE=0.422147 rank=98\n",
      "[SoftImpute] Iter 409: observed MAE=0.422135 rank=98\n",
      "[SoftImpute] Iter 410: observed MAE=0.422124 rank=98\n",
      "[SoftImpute] Iter 411: observed MAE=0.422113 rank=98\n",
      "[SoftImpute] Iter 412: observed MAE=0.422102 rank=98\n",
      "[SoftImpute] Iter 413: observed MAE=0.422091 rank=98\n",
      "[SoftImpute] Iter 414: observed MAE=0.422080 rank=98\n",
      "[SoftImpute] Iter 415: observed MAE=0.422069 rank=98\n",
      "[SoftImpute] Iter 416: observed MAE=0.422058 rank=98\n",
      "[SoftImpute] Iter 417: observed MAE=0.422047 rank=98\n",
      "[SoftImpute] Iter 418: observed MAE=0.422036 rank=98\n",
      "[SoftImpute] Iter 419: observed MAE=0.422025 rank=98\n",
      "[SoftImpute] Iter 420: observed MAE=0.422014 rank=98\n",
      "[SoftImpute] Iter 421: observed MAE=0.422004 rank=98\n",
      "[SoftImpute] Iter 422: observed MAE=0.421993 rank=98\n",
      "[SoftImpute] Iter 423: observed MAE=0.421982 rank=98\n",
      "[SoftImpute] Iter 424: observed MAE=0.421972 rank=98\n",
      "[SoftImpute] Iter 425: observed MAE=0.421961 rank=98\n",
      "[SoftImpute] Iter 426: observed MAE=0.421951 rank=98\n",
      "[SoftImpute] Iter 427: observed MAE=0.421941 rank=98\n",
      "[SoftImpute] Iter 428: observed MAE=0.421930 rank=98\n",
      "[SoftImpute] Iter 429: observed MAE=0.421920 rank=98\n",
      "[SoftImpute] Iter 430: observed MAE=0.421910 rank=98\n",
      "[SoftImpute] Iter 431: observed MAE=0.421899 rank=98\n",
      "[SoftImpute] Iter 432: observed MAE=0.421889 rank=98\n",
      "[SoftImpute] Iter 433: observed MAE=0.421879 rank=98\n",
      "[SoftImpute] Iter 434: observed MAE=0.421869 rank=98\n",
      "[SoftImpute] Iter 435: observed MAE=0.421859 rank=98\n",
      "[SoftImpute] Iter 436: observed MAE=0.421849 rank=98\n",
      "[SoftImpute] Iter 437: observed MAE=0.421839 rank=98\n",
      "[SoftImpute] Iter 438: observed MAE=0.421829 rank=98\n",
      "[SoftImpute] Iter 439: observed MAE=0.421819 rank=98\n",
      "[SoftImpute] Iter 440: observed MAE=0.421810 rank=98\n",
      "[SoftImpute] Iter 441: observed MAE=0.421800 rank=98\n",
      "[SoftImpute] Iter 442: observed MAE=0.421790 rank=98\n",
      "[SoftImpute] Iter 443: observed MAE=0.421780 rank=98\n",
      "[SoftImpute] Iter 444: observed MAE=0.421771 rank=98\n",
      "[SoftImpute] Iter 445: observed MAE=0.421761 rank=98\n",
      "[SoftImpute] Iter 446: observed MAE=0.421752 rank=98\n",
      "[SoftImpute] Iter 447: observed MAE=0.421742 rank=98\n",
      "[SoftImpute] Iter 448: observed MAE=0.421733 rank=98\n",
      "[SoftImpute] Iter 449: observed MAE=0.421723 rank=98\n",
      "[SoftImpute] Iter 450: observed MAE=0.421714 rank=98\n",
      "[SoftImpute] Iter 451: observed MAE=0.421704 rank=98\n",
      "[SoftImpute] Iter 452: observed MAE=0.421695 rank=98\n",
      "[SoftImpute] Iter 453: observed MAE=0.421686 rank=98\n",
      "[SoftImpute] Iter 454: observed MAE=0.421677 rank=98\n",
      "[SoftImpute] Iter 455: observed MAE=0.421667 rank=98\n",
      "[SoftImpute] Iter 456: observed MAE=0.421658 rank=98\n",
      "[SoftImpute] Iter 457: observed MAE=0.421649 rank=98\n",
      "[SoftImpute] Iter 458: observed MAE=0.421640 rank=98\n",
      "[SoftImpute] Iter 459: observed MAE=0.421631 rank=98\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 460: observed MAE=0.421622 rank=98\n",
      "[SoftImpute] Iter 461: observed MAE=0.421613 rank=98\n",
      "[SoftImpute] Iter 462: observed MAE=0.421604 rank=98\n",
      "[SoftImpute] Iter 463: observed MAE=0.421595 rank=98\n",
      "[SoftImpute] Iter 464: observed MAE=0.421586 rank=98\n",
      "[SoftImpute] Iter 465: observed MAE=0.421577 rank=98\n",
      "[SoftImpute] Iter 466: observed MAE=0.421568 rank=98\n",
      "[SoftImpute] Iter 467: observed MAE=0.421560 rank=98\n",
      "[SoftImpute] Iter 468: observed MAE=0.421551 rank=98\n",
      "[SoftImpute] Iter 469: observed MAE=0.421542 rank=98\n",
      "[SoftImpute] Iter 470: observed MAE=0.421533 rank=98\n",
      "[SoftImpute] Iter 471: observed MAE=0.421525 rank=98\n",
      "[SoftImpute] Iter 472: observed MAE=0.421516 rank=98\n",
      "[SoftImpute] Iter 473: observed MAE=0.421508 rank=98\n",
      "[SoftImpute] Iter 474: observed MAE=0.421499 rank=98\n",
      "[SoftImpute] Iter 475: observed MAE=0.421491 rank=98\n",
      "[SoftImpute] Iter 476: observed MAE=0.421482 rank=98\n",
      "[SoftImpute] Iter 477: observed MAE=0.421474 rank=98\n",
      "[SoftImpute] Iter 478: observed MAE=0.421466 rank=98\n",
      "[SoftImpute] Iter 479: observed MAE=0.421457 rank=98\n",
      "[SoftImpute] Iter 480: observed MAE=0.421449 rank=98\n",
      "[SoftImpute] Iter 481: observed MAE=0.421441 rank=98\n",
      "[SoftImpute] Iter 482: observed MAE=0.421432 rank=98\n",
      "[SoftImpute] Iter 483: observed MAE=0.421424 rank=98\n",
      "[SoftImpute] Iter 484: observed MAE=0.421416 rank=98\n",
      "[SoftImpute] Iter 485: observed MAE=0.421408 rank=98\n",
      "[SoftImpute] Iter 486: observed MAE=0.421400 rank=98\n",
      "[SoftImpute] Iter 487: observed MAE=0.421392 rank=98\n",
      "[SoftImpute] Iter 488: observed MAE=0.421384 rank=98\n",
      "[SoftImpute] Iter 489: observed MAE=0.421376 rank=98\n",
      "[SoftImpute] Iter 490: observed MAE=0.421368 rank=98\n",
      "[SoftImpute] Iter 491: observed MAE=0.421360 rank=98\n",
      "[SoftImpute] Iter 492: observed MAE=0.421352 rank=98\n",
      "[SoftImpute] Iter 493: observed MAE=0.421344 rank=98\n",
      "[SoftImpute] Iter 494: observed MAE=0.421336 rank=98\n",
      "[SoftImpute] Iter 495: observed MAE=0.421328 rank=98\n",
      "[SoftImpute] Iter 496: observed MAE=0.421320 rank=98\n",
      "[SoftImpute] Iter 497: observed MAE=0.421313 rank=98\n",
      "[SoftImpute] Iter 498: observed MAE=0.421305 rank=98\n",
      "[SoftImpute] Iter 499: observed MAE=0.421297 rank=98\n",
      "[SoftImpute] Iter 500: observed MAE=0.421289 rank=98\n",
      "[SoftImpute] Iter 501: observed MAE=0.421282 rank=98\n",
      "[SoftImpute] Iter 502: observed MAE=0.421274 rank=98\n",
      "[SoftImpute] Iter 503: observed MAE=0.421267 rank=98\n",
      "[SoftImpute] Iter 504: observed MAE=0.421259 rank=98\n",
      "[SoftImpute] Iter 505: observed MAE=0.421252 rank=98\n",
      "[SoftImpute] Iter 506: observed MAE=0.421244 rank=98\n",
      "[SoftImpute] Iter 507: observed MAE=0.421237 rank=98\n",
      "[SoftImpute] Iter 508: observed MAE=0.421229 rank=98\n",
      "[SoftImpute] Iter 509: observed MAE=0.421222 rank=98\n",
      "[SoftImpute] Iter 510: observed MAE=0.421214 rank=98\n",
      "[SoftImpute] Iter 511: observed MAE=0.421207 rank=98\n",
      "[SoftImpute] Iter 512: observed MAE=0.421200 rank=98\n",
      "[SoftImpute] Iter 513: observed MAE=0.421192 rank=98\n",
      "[SoftImpute] Iter 514: observed MAE=0.421185 rank=98\n",
      "[SoftImpute] Iter 515: observed MAE=0.421178 rank=98\n",
      "[SoftImpute] Iter 516: observed MAE=0.421170 rank=98\n",
      "[SoftImpute] Iter 517: observed MAE=0.421163 rank=98\n",
      "[SoftImpute] Iter 518: observed MAE=0.421156 rank=98\n",
      "[SoftImpute] Iter 519: observed MAE=0.421149 rank=98\n",
      "[SoftImpute] Iter 520: observed MAE=0.421142 rank=98\n",
      "[SoftImpute] Iter 521: observed MAE=0.421135 rank=98\n",
      "[SoftImpute] Iter 522: observed MAE=0.421127 rank=98\n",
      "[SoftImpute] Iter 523: observed MAE=0.421120 rank=98\n",
      "[SoftImpute] Iter 524: observed MAE=0.421113 rank=98\n",
      "[SoftImpute] Iter 525: observed MAE=0.421106 rank=98\n",
      "[SoftImpute] Iter 526: observed MAE=0.421099 rank=98\n",
      "[SoftImpute] Iter 527: observed MAE=0.421092 rank=98\n",
      "[SoftImpute] Iter 528: observed MAE=0.421085 rank=98\n",
      "[SoftImpute] Iter 529: observed MAE=0.421078 rank=98\n",
      "[SoftImpute] Iter 530: observed MAE=0.421071 rank=98\n",
      "[SoftImpute] Iter 531: observed MAE=0.421065 rank=98\n",
      "[SoftImpute] Iter 532: observed MAE=0.421058 rank=98\n",
      "[SoftImpute] Iter 533: observed MAE=0.421051 rank=98\n",
      "[SoftImpute] Iter 534: observed MAE=0.421044 rank=98\n",
      "[SoftImpute] Iter 535: observed MAE=0.421037 rank=98\n",
      "[SoftImpute] Iter 536: observed MAE=0.421031 rank=98\n",
      "[SoftImpute] Iter 537: observed MAE=0.421024 rank=98\n",
      "[SoftImpute] Iter 538: observed MAE=0.421017 rank=98\n",
      "[SoftImpute] Iter 539: observed MAE=0.421010 rank=98\n",
      "[SoftImpute] Iter 540: observed MAE=0.421004 rank=98\n",
      "[SoftImpute] Iter 541: observed MAE=0.420997 rank=98\n",
      "[SoftImpute] Iter 542: observed MAE=0.420991 rank=98\n",
      "[SoftImpute] Iter 543: observed MAE=0.420984 rank=98\n",
      "[SoftImpute] Iter 544: observed MAE=0.420978 rank=98\n",
      "[SoftImpute] Iter 545: observed MAE=0.420971 rank=98\n",
      "[SoftImpute] Iter 546: observed MAE=0.420965 rank=98\n",
      "[SoftImpute] Iter 547: observed MAE=0.420958 rank=98\n",
      "[SoftImpute] Iter 548: observed MAE=0.420952 rank=98\n",
      "[SoftImpute] Iter 549: observed MAE=0.420945 rank=98\n",
      "[SoftImpute] Iter 550: observed MAE=0.420939 rank=98\n",
      "[SoftImpute] Iter 551: observed MAE=0.420932 rank=98\n",
      "[SoftImpute] Iter 552: observed MAE=0.420926 rank=98\n",
      "[SoftImpute] Iter 553: observed MAE=0.420920 rank=98\n",
      "[SoftImpute] Iter 554: observed MAE=0.420913 rank=98\n",
      "[SoftImpute] Iter 555: observed MAE=0.420907 rank=98\n",
      "[SoftImpute] Iter 556: observed MAE=0.420901 rank=98\n",
      "[SoftImpute] Iter 557: observed MAE=0.420895 rank=98\n",
      "[SoftImpute] Iter 558: observed MAE=0.420888 rank=98\n",
      "[SoftImpute] Iter 559: observed MAE=0.420882 rank=98\n",
      "[SoftImpute] Iter 560: observed MAE=0.420876 rank=98\n",
      "[SoftImpute] Iter 561: observed MAE=0.420870 rank=98\n",
      "[SoftImpute] Iter 562: observed MAE=0.420864 rank=98\n",
      "[SoftImpute] Iter 563: observed MAE=0.420858 rank=98\n",
      "[SoftImpute] Iter 564: observed MAE=0.420852 rank=98\n",
      "[SoftImpute] Iter 565: observed MAE=0.420845 rank=98\n",
      "[SoftImpute] Iter 566: observed MAE=0.420839 rank=98\n",
      "[SoftImpute] Iter 567: observed MAE=0.420833 rank=98\n",
      "[SoftImpute] Iter 568: observed MAE=0.420827 rank=98\n",
      "[SoftImpute] Iter 569: observed MAE=0.420821 rank=98\n",
      "[SoftImpute] Iter 570: observed MAE=0.420815 rank=98\n",
      "[SoftImpute] Iter 571: observed MAE=0.420809 rank=98\n",
      "[SoftImpute] Iter 572: observed MAE=0.420804 rank=98\n",
      "[SoftImpute] Iter 573: observed MAE=0.420798 rank=98\n",
      "[SoftImpute] Iter 574: observed MAE=0.420792 rank=98\n",
      "[SoftImpute] Iter 575: observed MAE=0.420786 rank=98\n",
      "[SoftImpute] Iter 576: observed MAE=0.420780 rank=98\n",
      "[SoftImpute] Iter 577: observed MAE=0.420774 rank=98\n",
      "[SoftImpute] Iter 578: observed MAE=0.420768 rank=98\n",
      "[SoftImpute] Iter 579: observed MAE=0.420763 rank=98\n",
      "[SoftImpute] Iter 580: observed MAE=0.420757 rank=98\n",
      "[SoftImpute] Iter 581: observed MAE=0.420751 rank=98\n",
      "[SoftImpute] Iter 582: observed MAE=0.420745 rank=98\n",
      "[SoftImpute] Iter 583: observed MAE=0.420740 rank=98\n",
      "[SoftImpute] Iter 584: observed MAE=0.420734 rank=98\n",
      "[SoftImpute] Iter 585: observed MAE=0.420728 rank=98\n",
      "[SoftImpute] Iter 586: observed MAE=0.420723 rank=98\n",
      "[SoftImpute] Iter 587: observed MAE=0.420717 rank=98\n",
      "[SoftImpute] Iter 588: observed MAE=0.420711 rank=98\n",
      "[SoftImpute] Iter 589: observed MAE=0.420706 rank=98\n",
      "[SoftImpute] Iter 590: observed MAE=0.420700 rank=98\n",
      "[SoftImpute] Iter 591: observed MAE=0.420695 rank=98\n",
      "[SoftImpute] Iter 592: observed MAE=0.420689 rank=98\n",
      "[SoftImpute] Iter 593: observed MAE=0.420684 rank=98\n",
      "[SoftImpute] Iter 594: observed MAE=0.420678 rank=98\n",
      "[SoftImpute] Iter 595: observed MAE=0.420673 rank=98\n",
      "[SoftImpute] Iter 596: observed MAE=0.420667 rank=98\n",
      "[SoftImpute] Iter 597: observed MAE=0.420662 rank=98\n",
      "[SoftImpute] Iter 598: observed MAE=0.420656 rank=98\n",
      "[SoftImpute] Iter 599: observed MAE=0.420651 rank=98\n",
      "[SoftImpute] Iter 600: observed MAE=0.420646 rank=98\n",
      "[SoftImpute] Iter 601: observed MAE=0.420640 rank=98\n",
      "[SoftImpute] Iter 602: observed MAE=0.420635 rank=98\n",
      "[SoftImpute] Iter 603: observed MAE=0.420630 rank=98\n",
      "[SoftImpute] Iter 604: observed MAE=0.420625 rank=98\n",
      "[SoftImpute] Iter 605: observed MAE=0.420619 rank=98\n",
      "[SoftImpute] Iter 606: observed MAE=0.420614 rank=98\n",
      "[SoftImpute] Iter 607: observed MAE=0.420609 rank=98\n",
      "[SoftImpute] Iter 608: observed MAE=0.420604 rank=98\n",
      "[SoftImpute] Iter 609: observed MAE=0.420598 rank=98\n",
      "[SoftImpute] Iter 610: observed MAE=0.420593 rank=98\n",
      "[SoftImpute] Iter 611: observed MAE=0.420588 rank=98\n",
      "[SoftImpute] Iter 612: observed MAE=0.420583 rank=98\n",
      "[SoftImpute] Iter 613: observed MAE=0.420578 rank=98\n",
      "[SoftImpute] Iter 614: observed MAE=0.420573 rank=98\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 615: observed MAE=0.420568 rank=98\n",
      "[SoftImpute] Iter 616: observed MAE=0.420562 rank=98\n",
      "[SoftImpute] Iter 617: observed MAE=0.420557 rank=98\n",
      "[SoftImpute] Iter 618: observed MAE=0.420552 rank=98\n",
      "[SoftImpute] Iter 619: observed MAE=0.420547 rank=98\n",
      "[SoftImpute] Iter 620: observed MAE=0.420542 rank=98\n",
      "[SoftImpute] Iter 621: observed MAE=0.420537 rank=98\n",
      "[SoftImpute] Iter 622: observed MAE=0.420532 rank=98\n",
      "[SoftImpute] Iter 623: observed MAE=0.420527 rank=98\n",
      "[SoftImpute] Iter 624: observed MAE=0.420522 rank=98\n",
      "[SoftImpute] Iter 625: observed MAE=0.420517 rank=98\n",
      "[SoftImpute] Iter 626: observed MAE=0.420512 rank=98\n",
      "[SoftImpute] Iter 627: observed MAE=0.420508 rank=98\n",
      "[SoftImpute] Iter 628: observed MAE=0.420503 rank=97\n",
      "[SoftImpute] Iter 629: observed MAE=0.420498 rank=97\n",
      "[SoftImpute] Iter 630: observed MAE=0.420493 rank=97\n",
      "[SoftImpute] Iter 631: observed MAE=0.420488 rank=97\n",
      "[SoftImpute] Iter 632: observed MAE=0.420483 rank=97\n",
      "[SoftImpute] Iter 633: observed MAE=0.420478 rank=97\n",
      "[SoftImpute] Iter 634: observed MAE=0.420473 rank=97\n",
      "[SoftImpute] Iter 635: observed MAE=0.420469 rank=97\n",
      "[SoftImpute] Iter 636: observed MAE=0.420464 rank=97\n",
      "[SoftImpute] Iter 637: observed MAE=0.420459 rank=97\n",
      "[SoftImpute] Iter 638: observed MAE=0.420454 rank=97\n",
      "[SoftImpute] Iter 639: observed MAE=0.420449 rank=97\n",
      "[SoftImpute] Iter 640: observed MAE=0.420445 rank=97\n",
      "[SoftImpute] Iter 641: observed MAE=0.420440 rank=97\n",
      "[SoftImpute] Iter 642: observed MAE=0.420435 rank=97\n",
      "[SoftImpute] Iter 643: observed MAE=0.420431 rank=97\n",
      "[SoftImpute] Iter 644: observed MAE=0.420426 rank=97\n",
      "[SoftImpute] Iter 645: observed MAE=0.420421 rank=97\n",
      "[SoftImpute] Iter 646: observed MAE=0.420417 rank=97\n",
      "[SoftImpute] Iter 647: observed MAE=0.420412 rank=97\n",
      "[SoftImpute] Iter 648: observed MAE=0.420407 rank=97\n",
      "[SoftImpute] Iter 649: observed MAE=0.420403 rank=97\n",
      "[SoftImpute] Iter 650: observed MAE=0.420398 rank=97\n",
      "[SoftImpute] Iter 651: observed MAE=0.420393 rank=97\n",
      "[SoftImpute] Iter 652: observed MAE=0.420389 rank=97\n",
      "[SoftImpute] Iter 653: observed MAE=0.420384 rank=97\n",
      "[SoftImpute] Iter 654: observed MAE=0.420380 rank=97\n",
      "[SoftImpute] Iter 655: observed MAE=0.420375 rank=97\n",
      "[SoftImpute] Iter 656: observed MAE=0.420371 rank=97\n",
      "[SoftImpute] Iter 657: observed MAE=0.420366 rank=97\n",
      "[SoftImpute] Iter 658: observed MAE=0.420362 rank=97\n",
      "[SoftImpute] Iter 659: observed MAE=0.420357 rank=97\n",
      "[SoftImpute] Iter 660: observed MAE=0.420353 rank=97\n",
      "[SoftImpute] Iter 661: observed MAE=0.420348 rank=97\n",
      "[SoftImpute] Iter 662: observed MAE=0.420344 rank=97\n",
      "[SoftImpute] Iter 663: observed MAE=0.420339 rank=97\n",
      "[SoftImpute] Iter 664: observed MAE=0.420335 rank=97\n",
      "[SoftImpute] Iter 665: observed MAE=0.420330 rank=97\n",
      "[SoftImpute] Iter 666: observed MAE=0.420326 rank=97\n",
      "[SoftImpute] Iter 667: observed MAE=0.420322 rank=97\n",
      "[SoftImpute] Iter 668: observed MAE=0.420317 rank=97\n",
      "[SoftImpute] Iter 669: observed MAE=0.420313 rank=97\n",
      "[SoftImpute] Iter 670: observed MAE=0.420308 rank=97\n",
      "[SoftImpute] Iter 671: observed MAE=0.420304 rank=97\n",
      "[SoftImpute] Iter 672: observed MAE=0.420300 rank=97\n",
      "[SoftImpute] Iter 673: observed MAE=0.420295 rank=97\n",
      "[SoftImpute] Iter 674: observed MAE=0.420291 rank=97\n",
      "[SoftImpute] Iter 675: observed MAE=0.420287 rank=97\n",
      "[SoftImpute] Iter 676: observed MAE=0.420283 rank=97\n",
      "[SoftImpute] Iter 677: observed MAE=0.420278 rank=97\n",
      "[SoftImpute] Iter 678: observed MAE=0.420274 rank=97\n",
      "[SoftImpute] Iter 679: observed MAE=0.420270 rank=97\n",
      "[SoftImpute] Iter 680: observed MAE=0.420266 rank=97\n",
      "[SoftImpute] Iter 681: observed MAE=0.420261 rank=97\n",
      "[SoftImpute] Iter 682: observed MAE=0.420257 rank=97\n",
      "[SoftImpute] Iter 683: observed MAE=0.420253 rank=97\n",
      "[SoftImpute] Iter 684: observed MAE=0.420249 rank=97\n",
      "[SoftImpute] Iter 685: observed MAE=0.420245 rank=97\n",
      "[SoftImpute] Iter 686: observed MAE=0.420240 rank=97\n",
      "[SoftImpute] Iter 687: observed MAE=0.420236 rank=97\n",
      "[SoftImpute] Iter 688: observed MAE=0.420232 rank=97\n",
      "[SoftImpute] Iter 689: observed MAE=0.420228 rank=97\n",
      "[SoftImpute] Iter 690: observed MAE=0.420224 rank=97\n",
      "[SoftImpute] Iter 691: observed MAE=0.420220 rank=97\n",
      "[SoftImpute] Iter 692: observed MAE=0.420216 rank=97\n",
      "[SoftImpute] Iter 693: observed MAE=0.420212 rank=97\n",
      "[SoftImpute] Iter 694: observed MAE=0.420207 rank=97\n",
      "[SoftImpute] Iter 695: observed MAE=0.420203 rank=97\n",
      "[SoftImpute] Iter 696: observed MAE=0.420199 rank=97\n",
      "[SoftImpute] Iter 697: observed MAE=0.420195 rank=97\n",
      "[SoftImpute] Iter 698: observed MAE=0.420191 rank=97\n",
      "[SoftImpute] Iter 699: observed MAE=0.420187 rank=97\n",
      "[SoftImpute] Iter 700: observed MAE=0.420183 rank=97\n",
      "[SoftImpute] Iter 701: observed MAE=0.420179 rank=97\n",
      "[SoftImpute] Iter 702: observed MAE=0.420175 rank=97\n",
      "[SoftImpute] Iter 703: observed MAE=0.420171 rank=97\n",
      "[SoftImpute] Iter 704: observed MAE=0.420167 rank=97\n",
      "[SoftImpute] Iter 705: observed MAE=0.420163 rank=97\n",
      "[SoftImpute] Iter 706: observed MAE=0.420159 rank=97\n",
      "[SoftImpute] Iter 707: observed MAE=0.420155 rank=97\n",
      "[SoftImpute] Iter 708: observed MAE=0.420152 rank=97\n",
      "[SoftImpute] Iter 709: observed MAE=0.420148 rank=97\n",
      "[SoftImpute] Iter 710: observed MAE=0.420144 rank=97\n",
      "[SoftImpute] Iter 711: observed MAE=0.420140 rank=97\n",
      "[SoftImpute] Iter 712: observed MAE=0.420136 rank=97\n",
      "[SoftImpute] Iter 713: observed MAE=0.420132 rank=97\n",
      "[SoftImpute] Iter 714: observed MAE=0.420128 rank=97\n",
      "[SoftImpute] Iter 715: observed MAE=0.420124 rank=97\n",
      "[SoftImpute] Iter 716: observed MAE=0.420121 rank=97\n",
      "[SoftImpute] Iter 717: observed MAE=0.420117 rank=97\n",
      "[SoftImpute] Iter 718: observed MAE=0.420113 rank=97\n",
      "[SoftImpute] Iter 719: observed MAE=0.420109 rank=97\n",
      "[SoftImpute] Iter 720: observed MAE=0.420105 rank=97\n",
      "[SoftImpute] Iter 721: observed MAE=0.420102 rank=98\n",
      "[SoftImpute] Iter 722: observed MAE=0.420098 rank=98\n",
      "[SoftImpute] Iter 723: observed MAE=0.420094 rank=98\n",
      "[SoftImpute] Iter 724: observed MAE=0.420090 rank=98\n",
      "[SoftImpute] Iter 725: observed MAE=0.420087 rank=98\n",
      "[SoftImpute] Iter 726: observed MAE=0.420083 rank=98\n",
      "[SoftImpute] Iter 727: observed MAE=0.420079 rank=98\n",
      "[SoftImpute] Iter 728: observed MAE=0.420075 rank=98\n",
      "[SoftImpute] Iter 729: observed MAE=0.420072 rank=98\n",
      "[SoftImpute] Iter 730: observed MAE=0.420068 rank=98\n",
      "[SoftImpute] Iter 731: observed MAE=0.420064 rank=98\n",
      "[SoftImpute] Iter 732: observed MAE=0.420061 rank=98\n",
      "[SoftImpute] Iter 733: observed MAE=0.420057 rank=98\n",
      "[SoftImpute] Iter 734: observed MAE=0.420053 rank=98\n",
      "[SoftImpute] Iter 735: observed MAE=0.420050 rank=98\n",
      "[SoftImpute] Iter 736: observed MAE=0.420046 rank=98\n",
      "[SoftImpute] Iter 737: observed MAE=0.420043 rank=98\n",
      "[SoftImpute] Iter 738: observed MAE=0.420039 rank=98\n",
      "[SoftImpute] Iter 739: observed MAE=0.420035 rank=98\n",
      "[SoftImpute] Iter 740: observed MAE=0.420032 rank=98\n",
      "[SoftImpute] Iter 741: observed MAE=0.420028 rank=98\n",
      "[SoftImpute] Iter 742: observed MAE=0.420025 rank=98\n",
      "[SoftImpute] Iter 743: observed MAE=0.420021 rank=98\n",
      "[SoftImpute] Iter 744: observed MAE=0.420018 rank=98\n",
      "[SoftImpute] Iter 745: observed MAE=0.420014 rank=98\n",
      "[SoftImpute] Iter 746: observed MAE=0.420011 rank=98\n",
      "[SoftImpute] Iter 747: observed MAE=0.420007 rank=98\n",
      "[SoftImpute] Iter 748: observed MAE=0.420004 rank=98\n",
      "[SoftImpute] Iter 749: observed MAE=0.420000 rank=98\n",
      "[SoftImpute] Iter 750: observed MAE=0.419997 rank=98\n",
      "[SoftImpute] Iter 751: observed MAE=0.419993 rank=98\n",
      "[SoftImpute] Iter 752: observed MAE=0.419990 rank=98\n",
      "[SoftImpute] Iter 753: observed MAE=0.419986 rank=98\n",
      "[SoftImpute] Iter 754: observed MAE=0.419983 rank=98\n",
      "[SoftImpute] Iter 755: observed MAE=0.419979 rank=98\n",
      "[SoftImpute] Iter 756: observed MAE=0.419976 rank=98\n",
      "[SoftImpute] Iter 757: observed MAE=0.419972 rank=98\n",
      "[SoftImpute] Iter 758: observed MAE=0.419969 rank=98\n",
      "[SoftImpute] Iter 759: observed MAE=0.419966 rank=98\n",
      "[SoftImpute] Iter 760: observed MAE=0.419962 rank=98\n",
      "[SoftImpute] Iter 761: observed MAE=0.419959 rank=98\n",
      "[SoftImpute] Iter 762: observed MAE=0.419956 rank=98\n",
      "[SoftImpute] Iter 763: observed MAE=0.419952 rank=98\n",
      "[SoftImpute] Iter 764: observed MAE=0.419949 rank=98\n",
      "[SoftImpute] Iter 765: observed MAE=0.419946 rank=98\n",
      "[SoftImpute] Iter 766: observed MAE=0.419942 rank=98\n",
      "[SoftImpute] Iter 767: observed MAE=0.419939 rank=98\n",
      "[SoftImpute] Iter 768: observed MAE=0.419936 rank=98\n",
      "[SoftImpute] Iter 769: observed MAE=0.419932 rank=98\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 770: observed MAE=0.419929 rank=98\n",
      "[SoftImpute] Iter 771: observed MAE=0.419926 rank=98\n",
      "[SoftImpute] Iter 772: observed MAE=0.419922 rank=98\n",
      "[SoftImpute] Iter 773: observed MAE=0.419919 rank=98\n",
      "[SoftImpute] Iter 774: observed MAE=0.419916 rank=98\n",
      "[SoftImpute] Iter 775: observed MAE=0.419913 rank=98\n",
      "[SoftImpute] Iter 776: observed MAE=0.419909 rank=98\n",
      "[SoftImpute] Iter 777: observed MAE=0.419906 rank=98\n",
      "[SoftImpute] Iter 778: observed MAE=0.419903 rank=98\n",
      "[SoftImpute] Iter 779: observed MAE=0.419900 rank=98\n",
      "[SoftImpute] Iter 780: observed MAE=0.419897 rank=98\n",
      "[SoftImpute] Iter 781: observed MAE=0.419893 rank=98\n",
      "[SoftImpute] Iter 782: observed MAE=0.419890 rank=98\n",
      "[SoftImpute] Iter 783: observed MAE=0.419887 rank=98\n",
      "[SoftImpute] Iter 784: observed MAE=0.419884 rank=98\n",
      "[SoftImpute] Iter 785: observed MAE=0.419881 rank=98\n",
      "[SoftImpute] Iter 786: observed MAE=0.419878 rank=98\n",
      "[SoftImpute] Iter 787: observed MAE=0.419875 rank=98\n",
      "[SoftImpute] Iter 788: observed MAE=0.419871 rank=98\n",
      "[SoftImpute] Iter 789: observed MAE=0.419868 rank=98\n",
      "[SoftImpute] Iter 790: observed MAE=0.419865 rank=98\n",
      "[SoftImpute] Iter 791: observed MAE=0.419862 rank=98\n",
      "[SoftImpute] Iter 792: observed MAE=0.419859 rank=98\n",
      "[SoftImpute] Iter 793: observed MAE=0.419856 rank=98\n",
      "[SoftImpute] Iter 794: observed MAE=0.419853 rank=98\n",
      "[SoftImpute] Iter 795: observed MAE=0.419850 rank=98\n",
      "[SoftImpute] Iter 796: observed MAE=0.419847 rank=98\n",
      "[SoftImpute] Iter 797: observed MAE=0.419844 rank=98\n",
      "[SoftImpute] Iter 798: observed MAE=0.419840 rank=98\n",
      "[SoftImpute] Iter 799: observed MAE=0.419837 rank=98\n",
      "[SoftImpute] Iter 800: observed MAE=0.419834 rank=98\n",
      "[SoftImpute] Iter 801: observed MAE=0.419831 rank=98\n",
      "[SoftImpute] Iter 802: observed MAE=0.419828 rank=98\n",
      "[SoftImpute] Iter 803: observed MAE=0.419825 rank=98\n",
      "[SoftImpute] Iter 804: observed MAE=0.419822 rank=98\n",
      "[SoftImpute] Iter 805: observed MAE=0.419819 rank=98\n",
      "[SoftImpute] Iter 806: observed MAE=0.419816 rank=98\n",
      "[SoftImpute] Iter 807: observed MAE=0.419813 rank=98\n",
      "[SoftImpute] Iter 808: observed MAE=0.419810 rank=98\n",
      "[SoftImpute] Iter 809: observed MAE=0.419807 rank=98\n",
      "[SoftImpute] Iter 810: observed MAE=0.419804 rank=98\n",
      "[SoftImpute] Iter 811: observed MAE=0.419802 rank=98\n",
      "[SoftImpute] Iter 812: observed MAE=0.419799 rank=98\n",
      "[SoftImpute] Iter 813: observed MAE=0.419796 rank=98\n",
      "[SoftImpute] Iter 814: observed MAE=0.419793 rank=98\n",
      "[SoftImpute] Iter 815: observed MAE=0.419790 rank=98\n",
      "[SoftImpute] Iter 816: observed MAE=0.419787 rank=98\n",
      "[SoftImpute] Iter 817: observed MAE=0.419784 rank=98\n",
      "[SoftImpute] Iter 818: observed MAE=0.419781 rank=98\n",
      "[SoftImpute] Iter 819: observed MAE=0.419778 rank=98\n",
      "[SoftImpute] Iter 820: observed MAE=0.419775 rank=98\n",
      "[SoftImpute] Iter 821: observed MAE=0.419773 rank=98\n",
      "[SoftImpute] Iter 822: observed MAE=0.419770 rank=98\n",
      "[SoftImpute] Iter 823: observed MAE=0.419767 rank=98\n",
      "[SoftImpute] Iter 824: observed MAE=0.419764 rank=98\n",
      "[SoftImpute] Iter 825: observed MAE=0.419761 rank=98\n",
      "[SoftImpute] Iter 826: observed MAE=0.419758 rank=98\n",
      "[SoftImpute] Iter 827: observed MAE=0.419756 rank=98\n",
      "[SoftImpute] Iter 828: observed MAE=0.419753 rank=98\n",
      "[SoftImpute] Iter 829: observed MAE=0.419750 rank=98\n",
      "[SoftImpute] Iter 830: observed MAE=0.419747 rank=98\n",
      "[SoftImpute] Iter 831: observed MAE=0.419744 rank=98\n",
      "[SoftImpute] Iter 832: observed MAE=0.419742 rank=98\n",
      "[SoftImpute] Iter 833: observed MAE=0.419739 rank=98\n",
      "[SoftImpute] Iter 834: observed MAE=0.419736 rank=98\n",
      "[SoftImpute] Iter 835: observed MAE=0.419733 rank=98\n",
      "[SoftImpute] Iter 836: observed MAE=0.419731 rank=98\n",
      "[SoftImpute] Iter 837: observed MAE=0.419728 rank=98\n",
      "[SoftImpute] Iter 838: observed MAE=0.419725 rank=98\n",
      "[SoftImpute] Iter 839: observed MAE=0.419722 rank=98\n",
      "[SoftImpute] Iter 840: observed MAE=0.419720 rank=98\n",
      "[SoftImpute] Iter 841: observed MAE=0.419717 rank=98\n",
      "[SoftImpute] Iter 842: observed MAE=0.419714 rank=98\n",
      "[SoftImpute] Iter 843: observed MAE=0.419712 rank=98\n",
      "[SoftImpute] Iter 844: observed MAE=0.419709 rank=98\n",
      "[SoftImpute] Iter 845: observed MAE=0.419706 rank=98\n",
      "[SoftImpute] Iter 846: observed MAE=0.419704 rank=98\n",
      "[SoftImpute] Iter 847: observed MAE=0.419701 rank=98\n",
      "[SoftImpute] Iter 848: observed MAE=0.419698 rank=98\n",
      "[SoftImpute] Iter 849: observed MAE=0.419696 rank=98\n",
      "[SoftImpute] Iter 850: observed MAE=0.419693 rank=98\n",
      "[SoftImpute] Iter 851: observed MAE=0.419691 rank=98\n",
      "[SoftImpute] Iter 852: observed MAE=0.419688 rank=98\n",
      "[SoftImpute] Iter 853: observed MAE=0.419685 rank=98\n",
      "[SoftImpute] Iter 854: observed MAE=0.419683 rank=98\n",
      "[SoftImpute] Iter 855: observed MAE=0.419680 rank=98\n",
      "[SoftImpute] Iter 856: observed MAE=0.419678 rank=98\n",
      "[SoftImpute] Iter 857: observed MAE=0.419675 rank=98\n",
      "[SoftImpute] Iter 858: observed MAE=0.419672 rank=98\n",
      "[SoftImpute] Iter 859: observed MAE=0.419670 rank=98\n",
      "[SoftImpute] Iter 860: observed MAE=0.419667 rank=98\n",
      "[SoftImpute] Iter 861: observed MAE=0.419665 rank=98\n",
      "[SoftImpute] Iter 862: observed MAE=0.419662 rank=98\n",
      "[SoftImpute] Iter 863: observed MAE=0.419660 rank=98\n",
      "[SoftImpute] Iter 864: observed MAE=0.419657 rank=98\n",
      "[SoftImpute] Stopped after iteration 864 for lambda=10.000000\n"
     ]
    }
   ],
   "source": [
    "X_filled_softimpute = SoftImpute(shrinkage_value=10,convergence_threshold=0.0001,max_iters=1000,min_value=1,max_value=5).complete(R_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "preds_df = pd.DataFrame(X_filled_softimpute,columns=R_df.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "User 600 has already rated 35 movies.\n",
      "Recommending highest 10 predicted ratings movies not already rated.\n"
     ]
    }
   ],
   "source": [
    "already_rated, predictions = recommend_movies(preds_df, 600, movies_df, ratings_df, 10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6546</th>\n",
       "      <td>48774</td>\n",
       "      <td>Children of Men (2006)</td>\n",
       "      <td>Action|Adventure|Drama|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5119</th>\n",
       "      <td>7361</td>\n",
       "      <td>Eternal Sunshine of the Spotless Mind (2004)</td>\n",
       "      <td>Drama|Romance|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5932</th>\n",
       "      <td>27773</td>\n",
       "      <td>Old Boy (2003)</td>\n",
       "      <td>Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>284</th>\n",
       "      <td>318</td>\n",
       "      <td>Shawshank Redemption, The (1994)</td>\n",
       "      <td>Crime|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3370</th>\n",
       "      <td>4235</td>\n",
       "      <td>Amores Perros (Love's a Bitch) (2000)</td>\n",
       "      <td>Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6547</th>\n",
       "      <td>48780</td>\n",
       "      <td>Prestige, The (2006)</td>\n",
       "      <td>Drama|Mystery|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4425</th>\n",
       "      <td>6016</td>\n",
       "      <td>City of God (Cidade de Deus) (2002)</td>\n",
       "      <td>Action|Adventure|Crime|Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1046</th>\n",
       "      <td>1293</td>\n",
       "      <td>Gandhi (1982)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3363</th>\n",
       "      <td>4226</td>\n",
       "      <td>Memento (2000)</td>\n",
       "      <td>Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6530</th>\n",
       "      <td>48516</td>\n",
       "      <td>Departed, The (2006)</td>\n",
       "      <td>Crime|Drama|Thriller</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      movieId                                         title  \\\n",
       "6546    48774                        Children of Men (2006)   \n",
       "5119     7361  Eternal Sunshine of the Spotless Mind (2004)   \n",
       "5932    27773                                Old Boy (2003)   \n",
       "284       318              Shawshank Redemption, The (1994)   \n",
       "3370     4235         Amores Perros (Love's a Bitch) (2000)   \n",
       "6547    48780                          Prestige, The (2006)   \n",
       "4425     6016           City of God (Cidade de Deus) (2002)   \n",
       "1046     1293                                 Gandhi (1982)   \n",
       "3363     4226                                Memento (2000)   \n",
       "6530    48516                          Departed, The (2006)   \n",
       "\n",
       "                                      genres  \n",
       "6546  Action|Adventure|Drama|Sci-Fi|Thriller  \n",
       "5119                    Drama|Romance|Sci-Fi  \n",
       "5932                        Mystery|Thriller  \n",
       "284                              Crime|Drama  \n",
       "3370                          Drama|Thriller  \n",
       "6547           Drama|Mystery|Sci-Fi|Thriller  \n",
       "4425   Action|Adventure|Crime|Drama|Thriller  \n",
       "1046                                   Drama  \n",
       "3363                        Mystery|Thriller  \n",
       "6530                    Crime|Drama|Thriller  "
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predictions.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "softimpute_mse = (((preds_df[missing_mask]) - (R_df[missing_mask])) ** 2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.9058062432729252"
      ]
     },
     "execution_count": 77,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.mean(softimpute_mse.stack().values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 223,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Max Singular Value of X_init = 517.583140\n",
      "[SoftImpute] Iter 1: observed MAE=0.061803 rank=671\n",
      "[SoftImpute] Iter 2: observed MAE=0.060653 rank=671\n",
      "[SoftImpute] Iter 3: observed MAE=0.060674 rank=671\n",
      "[SoftImpute] Iter 4: observed MAE=0.060690 rank=671\n",
      "[SoftImpute] Iter 5: observed MAE=0.060702 rank=670\n",
      "[SoftImpute] Iter 6: observed MAE=0.060706 rank=670\n",
      "[SoftImpute] Iter 7: observed MAE=0.060706 rank=669\n",
      "[SoftImpute] Iter 8: observed MAE=0.060694 rank=666\n",
      "[SoftImpute] Iter 9: observed MAE=0.060678 rank=663\n",
      "[SoftImpute] Iter 10: observed MAE=0.060652 rank=661\n",
      "[SoftImpute] Iter 11: observed MAE=0.060626 rank=659\n",
      "[SoftImpute] Iter 12: observed MAE=0.060597 rank=657\n",
      "[SoftImpute] Iter 13: observed MAE=0.060566 rank=655\n",
      "[SoftImpute] Iter 14: observed MAE=0.060534 rank=653\n",
      "[SoftImpute] Iter 15: observed MAE=0.060497 rank=651\n",
      "[SoftImpute] Iter 16: observed MAE=0.060455 rank=649\n",
      "[SoftImpute] Iter 17: observed MAE=0.060409 rank=645\n",
      "[SoftImpute] Iter 18: observed MAE=0.060364 rank=643\n",
      "[SoftImpute] Iter 19: observed MAE=0.060320 rank=640\n",
      "[SoftImpute] Iter 20: observed MAE=0.060270 rank=637\n",
      "[SoftImpute] Iter 21: observed MAE=0.060221 rank=634\n",
      "[SoftImpute] Iter 22: observed MAE=0.060170 rank=631\n",
      "[SoftImpute] Iter 23: observed MAE=0.060118 rank=628\n",
      "[SoftImpute] Iter 24: observed MAE=0.060070 rank=626\n",
      "[SoftImpute] Iter 25: observed MAE=0.060016 rank=623\n",
      "[SoftImpute] Iter 26: observed MAE=0.059958 rank=619\n",
      "[SoftImpute] Iter 27: observed MAE=0.059902 rank=616\n",
      "[SoftImpute] Iter 28: observed MAE=0.059849 rank=614\n",
      "[SoftImpute] Iter 29: observed MAE=0.059793 rank=611\n",
      "[SoftImpute] Iter 30: observed MAE=0.059740 rank=608\n",
      "[SoftImpute] Iter 31: observed MAE=0.059684 rank=605\n",
      "[SoftImpute] Iter 32: observed MAE=0.059628 rank=602\n",
      "[SoftImpute] Iter 33: observed MAE=0.059571 rank=599\n",
      "[SoftImpute] Iter 34: observed MAE=0.059513 rank=595\n",
      "[SoftImpute] Iter 35: observed MAE=0.059454 rank=593\n",
      "[SoftImpute] Iter 36: observed MAE=0.059403 rank=591\n",
      "[SoftImpute] Iter 37: observed MAE=0.059349 rank=588\n",
      "[SoftImpute] Iter 38: observed MAE=0.059291 rank=584\n",
      "[SoftImpute] Iter 39: observed MAE=0.059233 rank=581\n",
      "[SoftImpute] Iter 40: observed MAE=0.059175 rank=578\n",
      "[SoftImpute] Iter 41: observed MAE=0.059121 rank=577\n",
      "[SoftImpute] Iter 42: observed MAE=0.059069 rank=573\n",
      "[SoftImpute] Iter 43: observed MAE=0.059011 rank=570\n",
      "[SoftImpute] Iter 44: observed MAE=0.058953 rank=567\n",
      "[SoftImpute] Iter 45: observed MAE=0.058899 rank=564\n",
      "[SoftImpute] Iter 46: observed MAE=0.058840 rank=561\n",
      "[SoftImpute] Iter 47: observed MAE=0.058781 rank=558\n",
      "[SoftImpute] Iter 48: observed MAE=0.058728 rank=556\n",
      "[SoftImpute] Iter 49: observed MAE=0.058675 rank=554\n",
      "[SoftImpute] Iter 50: observed MAE=0.058618 rank=549\n",
      "[SoftImpute] Iter 51: observed MAE=0.058559 rank=548\n",
      "[SoftImpute] Iter 52: observed MAE=0.058507 rank=544\n",
      "[SoftImpute] Iter 53: observed MAE=0.058450 rank=542\n",
      "[SoftImpute] Iter 54: observed MAE=0.058400 rank=540\n",
      "[SoftImpute] Iter 55: observed MAE=0.058345 rank=537\n",
      "[SoftImpute] Iter 56: observed MAE=0.058293 rank=535\n",
      "[SoftImpute] Iter 57: observed MAE=0.058245 rank=533\n",
      "[SoftImpute] Iter 58: observed MAE=0.058194 rank=531\n",
      "[SoftImpute] Iter 59: observed MAE=0.058143 rank=529\n",
      "[SoftImpute] Iter 60: observed MAE=0.058100 rank=527\n",
      "[SoftImpute] Iter 61: observed MAE=0.058046 rank=523\n",
      "[SoftImpute] Iter 62: observed MAE=0.057993 rank=521\n",
      "[SoftImpute] Iter 63: observed MAE=0.057944 rank=518\n",
      "[SoftImpute] Iter 64: observed MAE=0.057892 rank=517\n",
      "[SoftImpute] Iter 65: observed MAE=0.057842 rank=513\n",
      "[SoftImpute] Iter 66: observed MAE=0.057792 rank=512\n",
      "[SoftImpute] Iter 67: observed MAE=0.057742 rank=509\n",
      "[SoftImpute] Iter 68: observed MAE=0.057691 rank=507\n",
      "[SoftImpute] Iter 69: observed MAE=0.057641 rank=504\n",
      "[SoftImpute] Iter 70: observed MAE=0.057594 rank=503\n",
      "[SoftImpute] Iter 71: observed MAE=0.057553 rank=501\n",
      "[SoftImpute] Iter 72: observed MAE=0.057507 rank=498\n",
      "[SoftImpute] Iter 73: observed MAE=0.057461 rank=496\n",
      "[SoftImpute] Iter 74: observed MAE=0.057417 rank=494\n",
      "[SoftImpute] Iter 75: observed MAE=0.057369 rank=492\n",
      "[SoftImpute] Iter 76: observed MAE=0.057326 rank=490\n",
      "[SoftImpute] Iter 77: observed MAE=0.057281 rank=488\n",
      "[SoftImpute] Iter 78: observed MAE=0.057235 rank=486\n",
      "[SoftImpute] Iter 79: observed MAE=0.057193 rank=484\n",
      "[SoftImpute] Iter 80: observed MAE=0.057151 rank=482\n",
      "[SoftImpute] Iter 81: observed MAE=0.057109 rank=481\n",
      "[SoftImpute] Iter 82: observed MAE=0.057070 rank=479\n",
      "[SoftImpute] Iter 83: observed MAE=0.057028 rank=476\n",
      "[SoftImpute] Iter 84: observed MAE=0.056986 rank=475\n",
      "[SoftImpute] Iter 85: observed MAE=0.056947 rank=473\n",
      "[SoftImpute] Iter 86: observed MAE=0.056906 rank=471\n",
      "[SoftImpute] Iter 87: observed MAE=0.056864 rank=469\n",
      "[SoftImpute] Iter 88: observed MAE=0.056827 rank=468\n",
      "[SoftImpute] Iter 89: observed MAE=0.056790 rank=466\n",
      "[SoftImpute] Iter 90: observed MAE=0.056755 rank=465\n",
      "[SoftImpute] Iter 91: observed MAE=0.056717 rank=462\n",
      "[SoftImpute] Iter 92: observed MAE=0.056676 rank=460\n",
      "[SoftImpute] Iter 93: observed MAE=0.056637 rank=459\n",
      "[SoftImpute] Iter 94: observed MAE=0.056602 rank=458\n",
      "[SoftImpute] Iter 95: observed MAE=0.056565 rank=456\n",
      "[SoftImpute] Iter 96: observed MAE=0.056531 rank=455\n",
      "[SoftImpute] Iter 97: observed MAE=0.056499 rank=454\n",
      "[SoftImpute] Iter 98: observed MAE=0.056467 rank=452\n",
      "[SoftImpute] Iter 99: observed MAE=0.056430 rank=451\n",
      "[SoftImpute] Iter 100: observed MAE=0.056398 rank=449\n",
      "[SoftImpute] Iter 101: observed MAE=0.056360 rank=447\n",
      "[SoftImpute] Iter 102: observed MAE=0.056328 rank=446\n",
      "[SoftImpute] Iter 103: observed MAE=0.056295 rank=445\n",
      "[SoftImpute] Iter 104: observed MAE=0.056256 rank=441\n",
      "[SoftImpute] Iter 105: observed MAE=0.056218 rank=440\n",
      "[SoftImpute] Iter 106: observed MAE=0.056187 rank=439\n",
      "[SoftImpute] Iter 107: observed MAE=0.056155 rank=438\n",
      "[SoftImpute] Iter 108: observed MAE=0.056125 rank=436\n",
      "[SoftImpute] Iter 109: observed MAE=0.056093 rank=435\n",
      "[SoftImpute] Iter 110: observed MAE=0.056062 rank=434\n",
      "[SoftImpute] Iter 111: observed MAE=0.056031 rank=432\n",
      "[SoftImpute] Iter 112: observed MAE=0.056003 rank=432\n",
      "[SoftImpute] Iter 113: observed MAE=0.055976 rank=431\n",
      "[SoftImpute] Iter 114: observed MAE=0.055946 rank=429\n",
      "[SoftImpute] Iter 115: observed MAE=0.055919 rank=428\n",
      "[SoftImpute] Iter 116: observed MAE=0.055887 rank=426\n",
      "[SoftImpute] Iter 117: observed MAE=0.055854 rank=424\n",
      "[SoftImpute] Iter 118: observed MAE=0.055819 rank=422\n",
      "[SoftImpute] Iter 119: observed MAE=0.055787 rank=421\n",
      "[SoftImpute] Iter 120: observed MAE=0.055761 rank=421\n",
      "[SoftImpute] Iter 121: observed MAE=0.055738 rank=420\n",
      "[SoftImpute] Iter 122: observed MAE=0.055709 rank=418\n",
      "[SoftImpute] Iter 123: observed MAE=0.055677 rank=417\n",
      "[SoftImpute] Iter 124: observed MAE=0.055644 rank=414\n",
      "[SoftImpute] Iter 125: observed MAE=0.055616 rank=414\n",
      "[SoftImpute] Iter 126: observed MAE=0.055592 rank=413\n",
      "[SoftImpute] Iter 127: observed MAE=0.055566 rank=411\n",
      "[SoftImpute] Iter 128: observed MAE=0.055539 rank=411\n",
      "[SoftImpute] Iter 129: observed MAE=0.055511 rank=409\n",
      "[SoftImpute] Iter 130: observed MAE=0.055486 rank=409\n",
      "[SoftImpute] Iter 131: observed MAE=0.055462 rank=408\n",
      "[SoftImpute] Iter 132: observed MAE=0.055440 rank=407\n",
      "[SoftImpute] Iter 133: observed MAE=0.055414 rank=406\n",
      "[SoftImpute] Iter 134: observed MAE=0.055389 rank=405\n",
      "[SoftImpute] Iter 135: observed MAE=0.055366 rank=404\n",
      "[SoftImpute] Iter 136: observed MAE=0.055343 rank=403\n",
      "[SoftImpute] Iter 137: observed MAE=0.055321 rank=402\n",
      "[SoftImpute] Iter 138: observed MAE=0.055296 rank=401\n",
      "[SoftImpute] Iter 139: observed MAE=0.055272 rank=400\n",
      "[SoftImpute] Iter 140: observed MAE=0.055248 rank=399\n",
      "[SoftImpute] Iter 141: observed MAE=0.055219 rank=396\n",
      "[SoftImpute] Iter 142: observed MAE=0.055187 rank=394\n",
      "[SoftImpute] Iter 143: observed MAE=0.055161 rank=394\n",
      "[SoftImpute] Iter 144: observed MAE=0.055140 rank=393\n",
      "[SoftImpute] Iter 145: observed MAE=0.055119 rank=393\n",
      "[SoftImpute] Iter 146: observed MAE=0.055098 rank=392\n",
      "[SoftImpute] Iter 147: observed MAE=0.055077 rank=391\n",
      "[SoftImpute] Iter 148: observed MAE=0.055057 rank=391\n",
      "[SoftImpute] Iter 149: observed MAE=0.055037 rank=390\n",
      "[SoftImpute] Iter 150: observed MAE=0.055016 rank=389\n",
      "[SoftImpute] Iter 151: observed MAE=0.054995 rank=388\n",
      "[SoftImpute] Iter 152: observed MAE=0.054974 rank=386\n",
      "[SoftImpute] Iter 153: observed MAE=0.054949 rank=384\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 154: observed MAE=0.054923 rank=384\n",
      "[SoftImpute] Iter 155: observed MAE=0.054903 rank=383\n",
      "[SoftImpute] Iter 156: observed MAE=0.054881 rank=382\n",
      "[SoftImpute] Iter 157: observed MAE=0.054861 rank=382\n",
      "[SoftImpute] Iter 158: observed MAE=0.054842 rank=381\n",
      "[SoftImpute] Iter 159: observed MAE=0.054820 rank=380\n",
      "[SoftImpute] Iter 160: observed MAE=0.054799 rank=379\n",
      "[SoftImpute] Iter 161: observed MAE=0.054778 rank=378\n",
      "[SoftImpute] Iter 162: observed MAE=0.054760 rank=377\n",
      "[SoftImpute] Iter 163: observed MAE=0.054740 rank=376\n",
      "[SoftImpute] Iter 164: observed MAE=0.054721 rank=376\n",
      "[SoftImpute] Iter 165: observed MAE=0.054702 rank=375\n",
      "[SoftImpute] Iter 166: observed MAE=0.054686 rank=375\n",
      "[SoftImpute] Iter 167: observed MAE=0.054668 rank=374\n",
      "[SoftImpute] Iter 168: observed MAE=0.054648 rank=373\n",
      "[SoftImpute] Iter 169: observed MAE=0.054629 rank=372\n",
      "[SoftImpute] Iter 170: observed MAE=0.054610 rank=371\n",
      "[SoftImpute] Iter 171: observed MAE=0.054593 rank=371\n",
      "[SoftImpute] Iter 172: observed MAE=0.054577 rank=370\n",
      "[SoftImpute] Iter 173: observed MAE=0.054557 rank=369\n",
      "[SoftImpute] Iter 174: observed MAE=0.054538 rank=367\n",
      "[SoftImpute] Iter 175: observed MAE=0.054518 rank=367\n",
      "[SoftImpute] Iter 176: observed MAE=0.054502 rank=366\n",
      "[SoftImpute] Iter 177: observed MAE=0.054484 rank=366\n",
      "[SoftImpute] Iter 178: observed MAE=0.054467 rank=365\n",
      "[SoftImpute] Iter 179: observed MAE=0.054451 rank=364\n",
      "[SoftImpute] Iter 180: observed MAE=0.054435 rank=364\n",
      "[SoftImpute] Iter 181: observed MAE=0.054421 rank=363\n",
      "[SoftImpute] Iter 182: observed MAE=0.054403 rank=362\n",
      "[SoftImpute] Iter 183: observed MAE=0.054383 rank=361\n",
      "[SoftImpute] Iter 184: observed MAE=0.054368 rank=361\n",
      "[SoftImpute] Iter 185: observed MAE=0.054352 rank=360\n",
      "[SoftImpute] Iter 186: observed MAE=0.054335 rank=359\n",
      "[SoftImpute] Iter 187: observed MAE=0.054320 rank=359\n",
      "[SoftImpute] Iter 188: observed MAE=0.054307 rank=359\n",
      "[SoftImpute] Iter 189: observed MAE=0.054291 rank=358\n",
      "[SoftImpute] Iter 190: observed MAE=0.054278 rank=358\n",
      "[SoftImpute] Iter 191: observed MAE=0.054262 rank=356\n",
      "[SoftImpute] Iter 192: observed MAE=0.054244 rank=355\n",
      "[SoftImpute] Iter 193: observed MAE=0.054224 rank=354\n",
      "[SoftImpute] Iter 194: observed MAE=0.054205 rank=353\n",
      "[SoftImpute] Iter 195: observed MAE=0.054190 rank=353\n",
      "[SoftImpute] Iter 196: observed MAE=0.054176 rank=352\n",
      "[SoftImpute] Iter 197: observed MAE=0.054160 rank=351\n",
      "[SoftImpute] Iter 198: observed MAE=0.054144 rank=351\n",
      "[SoftImpute] Iter 199: observed MAE=0.054132 rank=351\n",
      "[SoftImpute] Iter 200: observed MAE=0.054117 rank=350\n",
      "[SoftImpute] Iter 201: observed MAE=0.054101 rank=349\n",
      "[SoftImpute] Iter 202: observed MAE=0.054088 rank=349\n",
      "[SoftImpute] Iter 203: observed MAE=0.054073 rank=347\n",
      "[SoftImpute] Iter 204: observed MAE=0.054054 rank=346\n",
      "[SoftImpute] Iter 205: observed MAE=0.054038 rank=346\n",
      "[SoftImpute] Iter 206: observed MAE=0.054024 rank=345\n",
      "[SoftImpute] Iter 207: observed MAE=0.054010 rank=345\n",
      "[SoftImpute] Iter 208: observed MAE=0.053998 rank=344\n",
      "[SoftImpute] Iter 209: observed MAE=0.053983 rank=343\n",
      "[SoftImpute] Iter 210: observed MAE=0.053968 rank=343\n",
      "[SoftImpute] Iter 211: observed MAE=0.053954 rank=342\n",
      "[SoftImpute] Iter 212: observed MAE=0.053940 rank=341\n",
      "[SoftImpute] Iter 213: observed MAE=0.053923 rank=340\n",
      "[SoftImpute] Iter 214: observed MAE=0.053910 rank=340\n",
      "[SoftImpute] Iter 215: observed MAE=0.053899 rank=340\n",
      "[SoftImpute] Iter 216: observed MAE=0.053889 rank=340\n",
      "[SoftImpute] Iter 217: observed MAE=0.053876 rank=339\n",
      "[SoftImpute] Iter 218: observed MAE=0.053862 rank=337\n",
      "[SoftImpute] Iter 219: observed MAE=0.053846 rank=337\n",
      "[SoftImpute] Iter 220: observed MAE=0.053834 rank=337\n",
      "[SoftImpute] Iter 221: observed MAE=0.053823 rank=336\n",
      "[SoftImpute] Iter 222: observed MAE=0.053808 rank=335\n",
      "[SoftImpute] Iter 223: observed MAE=0.053795 rank=335\n",
      "[SoftImpute] Iter 224: observed MAE=0.053781 rank=334\n",
      "[SoftImpute] Iter 225: observed MAE=0.053770 rank=334\n",
      "[SoftImpute] Iter 226: observed MAE=0.053756 rank=332\n",
      "[SoftImpute] Iter 227: observed MAE=0.053741 rank=332\n",
      "[SoftImpute] Iter 228: observed MAE=0.053729 rank=331\n",
      "[SoftImpute] Iter 229: observed MAE=0.053716 rank=331\n",
      "[SoftImpute] Iter 230: observed MAE=0.053706 rank=331\n",
      "[SoftImpute] Iter 231: observed MAE=0.053695 rank=330\n",
      "[SoftImpute] Iter 232: observed MAE=0.053683 rank=330\n",
      "[SoftImpute] Iter 233: observed MAE=0.053672 rank=329\n",
      "[SoftImpute] Iter 234: observed MAE=0.053660 rank=329\n",
      "[SoftImpute] Iter 235: observed MAE=0.053651 rank=329\n",
      "[SoftImpute] Iter 236: observed MAE=0.053641 rank=328\n",
      "[SoftImpute] Iter 237: observed MAE=0.053630 rank=328\n",
      "[SoftImpute] Iter 238: observed MAE=0.053620 rank=328\n",
      "[SoftImpute] Iter 239: observed MAE=0.053610 rank=326\n",
      "[SoftImpute] Iter 240: observed MAE=0.053596 rank=326\n",
      "[SoftImpute] Iter 241: observed MAE=0.053585 rank=326\n",
      "[SoftImpute] Iter 242: observed MAE=0.053575 rank=325\n",
      "[SoftImpute] Iter 243: observed MAE=0.053564 rank=325\n",
      "[SoftImpute] Iter 244: observed MAE=0.053555 rank=325\n",
      "[SoftImpute] Iter 245: observed MAE=0.053543 rank=324\n",
      "[SoftImpute] Iter 246: observed MAE=0.053534 rank=324\n",
      "[SoftImpute] Iter 247: observed MAE=0.053523 rank=323\n",
      "[SoftImpute] Iter 248: observed MAE=0.053513 rank=323\n",
      "[SoftImpute] Iter 249: observed MAE=0.053504 rank=323\n",
      "[SoftImpute] Iter 250: observed MAE=0.053496 rank=323\n",
      "[SoftImpute] Iter 251: observed MAE=0.053488 rank=323\n",
      "[SoftImpute] Iter 252: observed MAE=0.053480 rank=322\n",
      "[SoftImpute] Iter 253: observed MAE=0.053466 rank=321\n",
      "[SoftImpute] Iter 254: observed MAE=0.053456 rank=321\n",
      "[SoftImpute] Iter 255: observed MAE=0.053447 rank=320\n",
      "[SoftImpute] Iter 256: observed MAE=0.053436 rank=320\n",
      "[SoftImpute] Iter 257: observed MAE=0.053427 rank=319\n",
      "[SoftImpute] Iter 258: observed MAE=0.053415 rank=318\n",
      "[SoftImpute] Iter 259: observed MAE=0.053403 rank=318\n",
      "[SoftImpute] Iter 260: observed MAE=0.053394 rank=318\n",
      "[SoftImpute] Iter 261: observed MAE=0.053386 rank=318\n",
      "[SoftImpute] Iter 262: observed MAE=0.053375 rank=317\n",
      "[SoftImpute] Iter 263: observed MAE=0.053366 rank=317\n",
      "[SoftImpute] Iter 264: observed MAE=0.053357 rank=316\n",
      "[SoftImpute] Iter 265: observed MAE=0.053345 rank=315\n",
      "[SoftImpute] Iter 266: observed MAE=0.053334 rank=315\n",
      "[SoftImpute] Iter 267: observed MAE=0.053325 rank=315\n",
      "[SoftImpute] Iter 268: observed MAE=0.053315 rank=314\n",
      "[SoftImpute] Iter 269: observed MAE=0.053305 rank=313\n",
      "[SoftImpute] Iter 270: observed MAE=0.053294 rank=312\n",
      "[SoftImpute] Iter 271: observed MAE=0.053282 rank=312\n",
      "[SoftImpute] Iter 272: observed MAE=0.053272 rank=312\n",
      "[SoftImpute] Iter 273: observed MAE=0.053263 rank=311\n",
      "[SoftImpute] Iter 274: observed MAE=0.053253 rank=311\n",
      "[SoftImpute] Iter 275: observed MAE=0.053245 rank=311\n",
      "[SoftImpute] Iter 276: observed MAE=0.053238 rank=311\n",
      "[SoftImpute] Iter 277: observed MAE=0.053228 rank=310\n",
      "[SoftImpute] Iter 278: observed MAE=0.053219 rank=310\n",
      "[SoftImpute] Iter 279: observed MAE=0.053211 rank=309\n",
      "[SoftImpute] Iter 280: observed MAE=0.053198 rank=308\n",
      "[SoftImpute] Iter 281: observed MAE=0.053189 rank=308\n",
      "[SoftImpute] Iter 282: observed MAE=0.053181 rank=308\n",
      "[SoftImpute] Iter 283: observed MAE=0.053173 rank=308\n",
      "[SoftImpute] Iter 284: observed MAE=0.053166 rank=307\n",
      "[SoftImpute] Iter 285: observed MAE=0.053157 rank=306\n",
      "[SoftImpute] Iter 286: observed MAE=0.053146 rank=306\n",
      "[SoftImpute] Iter 287: observed MAE=0.053138 rank=306\n",
      "[SoftImpute] Iter 288: observed MAE=0.053131 rank=306\n",
      "[SoftImpute] Iter 289: observed MAE=0.053124 rank=306\n",
      "[SoftImpute] Iter 290: observed MAE=0.053116 rank=305\n",
      "[SoftImpute] Iter 291: observed MAE=0.053107 rank=305\n",
      "[SoftImpute] Iter 292: observed MAE=0.053100 rank=304\n",
      "[SoftImpute] Iter 293: observed MAE=0.053090 rank=304\n",
      "[SoftImpute] Iter 294: observed MAE=0.053083 rank=304\n",
      "[SoftImpute] Iter 295: observed MAE=0.053075 rank=303\n",
      "[SoftImpute] Iter 296: observed MAE=0.053066 rank=303\n",
      "[SoftImpute] Iter 297: observed MAE=0.053059 rank=303\n",
      "[SoftImpute] Iter 298: observed MAE=0.053052 rank=303\n",
      "[SoftImpute] Iter 299: observed MAE=0.053044 rank=302\n",
      "[SoftImpute] Iter 300: observed MAE=0.053036 rank=302\n",
      "[SoftImpute] Iter 301: observed MAE=0.053029 rank=302\n",
      "[SoftImpute] Iter 302: observed MAE=0.053022 rank=302\n",
      "[SoftImpute] Iter 303: observed MAE=0.053014 rank=301\n",
      "[SoftImpute] Iter 304: observed MAE=0.053004 rank=300\n",
      "[SoftImpute] Iter 305: observed MAE=0.052996 rank=300\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 306: observed MAE=0.052989 rank=300\n",
      "[SoftImpute] Iter 307: observed MAE=0.052982 rank=299\n",
      "[SoftImpute] Iter 308: observed MAE=0.052973 rank=299\n",
      "[SoftImpute] Iter 309: observed MAE=0.052966 rank=298\n",
      "[SoftImpute] Iter 310: observed MAE=0.052956 rank=298\n",
      "[SoftImpute] Iter 311: observed MAE=0.052949 rank=298\n",
      "[SoftImpute] Iter 312: observed MAE=0.052942 rank=298\n",
      "[SoftImpute] Iter 313: observed MAE=0.052936 rank=298\n",
      "[SoftImpute] Iter 314: observed MAE=0.052931 rank=298\n",
      "[SoftImpute] Iter 315: observed MAE=0.052925 rank=298\n",
      "[SoftImpute] Iter 316: observed MAE=0.052919 rank=298\n",
      "[SoftImpute] Iter 317: observed MAE=0.052914 rank=298\n",
      "[SoftImpute] Iter 318: observed MAE=0.052906 rank=297\n",
      "[SoftImpute] Iter 319: observed MAE=0.052899 rank=297\n",
      "[SoftImpute] Iter 320: observed MAE=0.052891 rank=296\n",
      "[SoftImpute] Iter 321: observed MAE=0.052881 rank=294\n",
      "[SoftImpute] Iter 322: observed MAE=0.052870 rank=294\n",
      "[SoftImpute] Iter 323: observed MAE=0.052863 rank=294\n",
      "[SoftImpute] Iter 324: observed MAE=0.052856 rank=294\n",
      "[SoftImpute] Iter 325: observed MAE=0.052850 rank=294\n",
      "[SoftImpute] Iter 326: observed MAE=0.052844 rank=294\n",
      "[SoftImpute] Iter 327: observed MAE=0.052839 rank=294\n",
      "[SoftImpute] Iter 328: observed MAE=0.052833 rank=294\n",
      "[SoftImpute] Iter 329: observed MAE=0.052826 rank=293\n",
      "[SoftImpute] Iter 330: observed MAE=0.052819 rank=293\n",
      "[SoftImpute] Iter 331: observed MAE=0.052811 rank=292\n",
      "[SoftImpute] Iter 332: observed MAE=0.052803 rank=291\n",
      "[SoftImpute] Iter 333: observed MAE=0.052795 rank=291\n",
      "[SoftImpute] Iter 334: observed MAE=0.052788 rank=291\n",
      "[SoftImpute] Iter 335: observed MAE=0.052782 rank=291\n",
      "[SoftImpute] Iter 336: observed MAE=0.052777 rank=291\n",
      "[SoftImpute] Iter 337: observed MAE=0.052771 rank=291\n",
      "[SoftImpute] Iter 338: observed MAE=0.052766 rank=290\n",
      "[SoftImpute] Iter 339: observed MAE=0.052759 rank=290\n",
      "[SoftImpute] Iter 340: observed MAE=0.052753 rank=290\n",
      "[SoftImpute] Iter 341: observed MAE=0.052747 rank=290\n",
      "[SoftImpute] Iter 342: observed MAE=0.052741 rank=289\n",
      "[SoftImpute] Iter 343: observed MAE=0.052734 rank=289\n",
      "[SoftImpute] Iter 344: observed MAE=0.052728 rank=289\n",
      "[SoftImpute] Iter 345: observed MAE=0.052723 rank=289\n",
      "[SoftImpute] Iter 346: observed MAE=0.052718 rank=289\n",
      "[SoftImpute] Iter 347: observed MAE=0.052713 rank=288\n",
      "[SoftImpute] Iter 348: observed MAE=0.052706 rank=288\n",
      "[SoftImpute] Iter 349: observed MAE=0.052700 rank=288\n",
      "[SoftImpute] Iter 350: observed MAE=0.052692 rank=287\n",
      "[SoftImpute] Iter 351: observed MAE=0.052686 rank=287\n",
      "[SoftImpute] Iter 352: observed MAE=0.052680 rank=286\n",
      "[SoftImpute] Iter 353: observed MAE=0.052672 rank=286\n",
      "[SoftImpute] Iter 354: observed MAE=0.052666 rank=286\n",
      "[SoftImpute] Iter 355: observed MAE=0.052660 rank=285\n",
      "[SoftImpute] Iter 356: observed MAE=0.052653 rank=285\n",
      "[SoftImpute] Iter 357: observed MAE=0.052645 rank=284\n",
      "[SoftImpute] Iter 358: observed MAE=0.052638 rank=284\n",
      "[SoftImpute] Iter 359: observed MAE=0.052632 rank=284\n",
      "[SoftImpute] Iter 360: observed MAE=0.052627 rank=283\n",
      "[SoftImpute] Iter 361: observed MAE=0.052619 rank=283\n",
      "[SoftImpute] Iter 362: observed MAE=0.052613 rank=283\n",
      "[SoftImpute] Iter 363: observed MAE=0.052607 rank=282\n",
      "[SoftImpute] Iter 364: observed MAE=0.052600 rank=282\n",
      "[SoftImpute] Iter 365: observed MAE=0.052594 rank=282\n",
      "[SoftImpute] Iter 366: observed MAE=0.052589 rank=282\n",
      "[SoftImpute] Iter 367: observed MAE=0.052584 rank=282\n",
      "[SoftImpute] Iter 368: observed MAE=0.052579 rank=282\n",
      "[SoftImpute] Iter 369: observed MAE=0.052573 rank=281\n",
      "[SoftImpute] Iter 370: observed MAE=0.052564 rank=280\n",
      "[SoftImpute] Iter 371: observed MAE=0.052558 rank=280\n",
      "[SoftImpute] Iter 372: observed MAE=0.052552 rank=280\n",
      "[SoftImpute] Iter 373: observed MAE=0.052547 rank=280\n",
      "[SoftImpute] Iter 374: observed MAE=0.052540 rank=279\n",
      "[SoftImpute] Iter 375: observed MAE=0.052534 rank=279\n",
      "[SoftImpute] Iter 376: observed MAE=0.052529 rank=279\n",
      "[SoftImpute] Iter 377: observed MAE=0.052524 rank=279\n",
      "[SoftImpute] Iter 378: observed MAE=0.052520 rank=279\n",
      "[SoftImpute] Iter 379: observed MAE=0.052514 rank=278\n",
      "[SoftImpute] Iter 380: observed MAE=0.052508 rank=278\n",
      "[SoftImpute] Iter 381: observed MAE=0.052503 rank=278\n",
      "[SoftImpute] Iter 382: observed MAE=0.052498 rank=278\n",
      "[SoftImpute] Iter 383: observed MAE=0.052494 rank=278\n",
      "[SoftImpute] Iter 384: observed MAE=0.052488 rank=277\n",
      "[SoftImpute] Iter 385: observed MAE=0.052482 rank=277\n",
      "[SoftImpute] Iter 386: observed MAE=0.052477 rank=277\n",
      "[SoftImpute] Iter 387: observed MAE=0.052472 rank=277\n",
      "[SoftImpute] Iter 388: observed MAE=0.052468 rank=277\n",
      "[SoftImpute] Iter 389: observed MAE=0.052462 rank=276\n",
      "[SoftImpute] Iter 390: observed MAE=0.052456 rank=276\n",
      "[SoftImpute] Iter 391: observed MAE=0.052451 rank=276\n",
      "[SoftImpute] Iter 392: observed MAE=0.052447 rank=276\n",
      "[SoftImpute] Iter 393: observed MAE=0.052442 rank=276\n",
      "[SoftImpute] Iter 394: observed MAE=0.052438 rank=276\n",
      "[SoftImpute] Iter 395: observed MAE=0.052434 rank=276\n",
      "[SoftImpute] Iter 396: observed MAE=0.052428 rank=275\n",
      "[SoftImpute] Iter 397: observed MAE=0.052423 rank=275\n",
      "[SoftImpute] Iter 398: observed MAE=0.052419 rank=275\n",
      "[SoftImpute] Iter 399: observed MAE=0.052414 rank=275\n",
      "[SoftImpute] Iter 400: observed MAE=0.052410 rank=275\n",
      "[SoftImpute] Iter 401: observed MAE=0.052406 rank=275\n",
      "[SoftImpute] Iter 402: observed MAE=0.052400 rank=274\n",
      "[SoftImpute] Iter 403: observed MAE=0.052395 rank=274\n",
      "[SoftImpute] Iter 404: observed MAE=0.052389 rank=273\n",
      "[SoftImpute] Iter 405: observed MAE=0.052384 rank=273\n",
      "[SoftImpute] Iter 406: observed MAE=0.052379 rank=273\n",
      "[SoftImpute] Iter 407: observed MAE=0.052373 rank=272\n",
      "[SoftImpute] Iter 408: observed MAE=0.052368 rank=272\n",
      "[SoftImpute] Iter 409: observed MAE=0.052363 rank=272\n",
      "[SoftImpute] Iter 410: observed MAE=0.052359 rank=272\n",
      "[SoftImpute] Iter 411: observed MAE=0.052355 rank=272\n",
      "[SoftImpute] Iter 412: observed MAE=0.052350 rank=271\n",
      "[SoftImpute] Iter 413: observed MAE=0.052344 rank=271\n",
      "[SoftImpute] Iter 414: observed MAE=0.052340 rank=271\n",
      "[SoftImpute] Iter 415: observed MAE=0.052335 rank=270\n",
      "[SoftImpute] Iter 416: observed MAE=0.052329 rank=270\n",
      "[SoftImpute] Iter 417: observed MAE=0.052324 rank=270\n",
      "[SoftImpute] Iter 418: observed MAE=0.052320 rank=270\n",
      "[SoftImpute] Iter 419: observed MAE=0.052316 rank=270\n",
      "[SoftImpute] Iter 420: observed MAE=0.052313 rank=270\n",
      "[SoftImpute] Iter 421: observed MAE=0.052309 rank=270\n",
      "[SoftImpute] Iter 422: observed MAE=0.052304 rank=269\n",
      "[SoftImpute] Iter 423: observed MAE=0.052299 rank=269\n",
      "[SoftImpute] Iter 424: observed MAE=0.052294 rank=269\n",
      "[SoftImpute] Iter 425: observed MAE=0.052290 rank=269\n",
      "[SoftImpute] Iter 426: observed MAE=0.052287 rank=269\n",
      "[SoftImpute] Iter 427: observed MAE=0.052283 rank=269\n",
      "[SoftImpute] Iter 428: observed MAE=0.052279 rank=269\n",
      "[SoftImpute] Iter 429: observed MAE=0.052276 rank=268\n",
      "[SoftImpute] Iter 430: observed MAE=0.052270 rank=268\n",
      "[SoftImpute] Iter 431: observed MAE=0.052266 rank=268\n",
      "[SoftImpute] Iter 432: observed MAE=0.052260 rank=267\n",
      "[SoftImpute] Iter 433: observed MAE=0.052255 rank=267\n",
      "[SoftImpute] Iter 434: observed MAE=0.052251 rank=267\n",
      "[SoftImpute] Iter 435: observed MAE=0.052246 rank=266\n",
      "[SoftImpute] Iter 436: observed MAE=0.052241 rank=266\n",
      "[SoftImpute] Iter 437: observed MAE=0.052237 rank=266\n",
      "[SoftImpute] Iter 438: observed MAE=0.052233 rank=266\n",
      "[SoftImpute] Iter 439: observed MAE=0.052229 rank=266\n",
      "[SoftImpute] Iter 440: observed MAE=0.052224 rank=265\n",
      "[SoftImpute] Iter 441: observed MAE=0.052219 rank=265\n",
      "[SoftImpute] Iter 442: observed MAE=0.052215 rank=265\n",
      "[SoftImpute] Iter 443: observed MAE=0.052211 rank=265\n",
      "[SoftImpute] Iter 444: observed MAE=0.052207 rank=265\n",
      "[SoftImpute] Iter 445: observed MAE=0.052204 rank=265\n",
      "[SoftImpute] Iter 446: observed MAE=0.052198 rank=264\n",
      "[SoftImpute] Iter 447: observed MAE=0.052194 rank=264\n",
      "[SoftImpute] Iter 448: observed MAE=0.052190 rank=264\n",
      "[SoftImpute] Iter 449: observed MAE=0.052185 rank=263\n",
      "[SoftImpute] Iter 450: observed MAE=0.052180 rank=263\n",
      "[SoftImpute] Iter 451: observed MAE=0.052176 rank=263\n",
      "[SoftImpute] Iter 452: observed MAE=0.052172 rank=263\n",
      "[SoftImpute] Iter 453: observed MAE=0.052169 rank=263\n",
      "[SoftImpute] Iter 454: observed MAE=0.052166 rank=263\n",
      "[SoftImpute] Iter 455: observed MAE=0.052162 rank=262\n",
      "[SoftImpute] Iter 456: observed MAE=0.052156 rank=261\n",
      "[SoftImpute] Iter 457: observed MAE=0.052150 rank=261\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 458: observed MAE=0.052145 rank=261\n",
      "[SoftImpute] Iter 459: observed MAE=0.052141 rank=261\n",
      "[SoftImpute] Iter 460: observed MAE=0.052138 rank=261\n",
      "[SoftImpute] Iter 461: observed MAE=0.052134 rank=260\n",
      "[SoftImpute] Iter 462: observed MAE=0.052128 rank=260\n",
      "[SoftImpute] Iter 463: observed MAE=0.052124 rank=260\n",
      "[SoftImpute] Iter 464: observed MAE=0.052121 rank=260\n",
      "[SoftImpute] Iter 465: observed MAE=0.052117 rank=260\n",
      "[SoftImpute] Iter 466: observed MAE=0.052114 rank=260\n",
      "[SoftImpute] Iter 467: observed MAE=0.052110 rank=259\n",
      "[SoftImpute] Iter 468: observed MAE=0.052105 rank=259\n",
      "[SoftImpute] Iter 469: observed MAE=0.052099 rank=258\n",
      "[SoftImpute] Iter 470: observed MAE=0.052095 rank=258\n",
      "[SoftImpute] Iter 471: observed MAE=0.052090 rank=257\n",
      "[SoftImpute] Iter 472: observed MAE=0.052084 rank=257\n",
      "[SoftImpute] Iter 473: observed MAE=0.052080 rank=257\n",
      "[SoftImpute] Iter 474: observed MAE=0.052076 rank=257\n",
      "[SoftImpute] Iter 475: observed MAE=0.052073 rank=257\n",
      "[SoftImpute] Iter 476: observed MAE=0.052070 rank=257\n",
      "[SoftImpute] Iter 477: observed MAE=0.052067 rank=257\n",
      "[SoftImpute] Iter 478: observed MAE=0.052063 rank=257\n",
      "[SoftImpute] Iter 479: observed MAE=0.052060 rank=256\n",
      "[SoftImpute] Iter 480: observed MAE=0.052055 rank=256\n",
      "[SoftImpute] Iter 481: observed MAE=0.052052 rank=256\n",
      "[SoftImpute] Iter 482: observed MAE=0.052048 rank=256\n",
      "[SoftImpute] Iter 483: observed MAE=0.052045 rank=256\n",
      "[SoftImpute] Iter 484: observed MAE=0.052042 rank=256\n",
      "[SoftImpute] Iter 485: observed MAE=0.052039 rank=256\n",
      "[SoftImpute] Iter 486: observed MAE=0.052036 rank=256\n",
      "[SoftImpute] Iter 487: observed MAE=0.052033 rank=256\n",
      "[SoftImpute] Iter 488: observed MAE=0.052030 rank=256\n",
      "[SoftImpute] Iter 489: observed MAE=0.052027 rank=256\n",
      "[SoftImpute] Iter 490: observed MAE=0.052025 rank=256\n",
      "[SoftImpute] Iter 491: observed MAE=0.052022 rank=256\n",
      "[SoftImpute] Iter 492: observed MAE=0.052019 rank=256\n",
      "[SoftImpute] Iter 493: observed MAE=0.052016 rank=256\n",
      "[SoftImpute] Iter 494: observed MAE=0.052013 rank=255\n",
      "[SoftImpute] Iter 495: observed MAE=0.052009 rank=255\n",
      "[SoftImpute] Iter 496: observed MAE=0.052004 rank=254\n",
      "[SoftImpute] Iter 497: observed MAE=0.051999 rank=254\n",
      "[SoftImpute] Iter 498: observed MAE=0.051996 rank=254\n",
      "[SoftImpute] Iter 499: observed MAE=0.051992 rank=254\n",
      "[SoftImpute] Iter 500: observed MAE=0.051989 rank=254\n",
      "[SoftImpute] Iter 501: observed MAE=0.051986 rank=254\n",
      "[SoftImpute] Iter 502: observed MAE=0.051984 rank=254\n",
      "[SoftImpute] Iter 503: observed MAE=0.051981 rank=254\n",
      "[SoftImpute] Iter 504: observed MAE=0.051978 rank=254\n",
      "[SoftImpute] Iter 505: observed MAE=0.051975 rank=254\n",
      "[SoftImpute] Iter 506: observed MAE=0.051973 rank=254\n",
      "[SoftImpute] Iter 507: observed MAE=0.051970 rank=254\n",
      "[SoftImpute] Iter 508: observed MAE=0.051966 rank=253\n",
      "[SoftImpute] Iter 509: observed MAE=0.051963 rank=253\n",
      "[SoftImpute] Iter 510: observed MAE=0.051959 rank=253\n",
      "[SoftImpute] Iter 511: observed MAE=0.051956 rank=252\n",
      "[SoftImpute] Iter 512: observed MAE=0.051952 rank=252\n",
      "[SoftImpute] Iter 513: observed MAE=0.051948 rank=252\n",
      "[SoftImpute] Iter 514: observed MAE=0.051945 rank=252\n",
      "[SoftImpute] Iter 515: observed MAE=0.051942 rank=252\n",
      "[SoftImpute] Iter 516: observed MAE=0.051939 rank=252\n",
      "[SoftImpute] Iter 517: observed MAE=0.051935 rank=251\n",
      "[SoftImpute] Iter 518: observed MAE=0.051931 rank=251\n",
      "[SoftImpute] Iter 519: observed MAE=0.051928 rank=251\n",
      "[SoftImpute] Iter 520: observed MAE=0.051925 rank=251\n",
      "[SoftImpute] Iter 521: observed MAE=0.051922 rank=251\n",
      "[SoftImpute] Iter 522: observed MAE=0.051919 rank=251\n",
      "[SoftImpute] Iter 523: observed MAE=0.051915 rank=249\n",
      "[SoftImpute] Iter 524: observed MAE=0.051910 rank=249\n",
      "[SoftImpute] Iter 525: observed MAE=0.051906 rank=249\n",
      "[SoftImpute] Iter 526: observed MAE=0.051902 rank=249\n",
      "[SoftImpute] Iter 527: observed MAE=0.051899 rank=249\n",
      "[SoftImpute] Iter 528: observed MAE=0.051896 rank=249\n",
      "[SoftImpute] Iter 529: observed MAE=0.051894 rank=249\n",
      "[SoftImpute] Iter 530: observed MAE=0.051891 rank=249\n",
      "[SoftImpute] Iter 531: observed MAE=0.051889 rank=249\n",
      "[SoftImpute] Iter 532: observed MAE=0.051886 rank=249\n",
      "[SoftImpute] Iter 533: observed MAE=0.051884 rank=249\n",
      "[SoftImpute] Iter 534: observed MAE=0.051881 rank=249\n",
      "[SoftImpute] Iter 535: observed MAE=0.051879 rank=249\n",
      "[SoftImpute] Iter 536: observed MAE=0.051876 rank=249\n",
      "[SoftImpute] Iter 537: observed MAE=0.051874 rank=249\n",
      "[SoftImpute] Iter 538: observed MAE=0.051871 rank=249\n",
      "[SoftImpute] Iter 539: observed MAE=0.051869 rank=249\n",
      "[SoftImpute] Iter 540: observed MAE=0.051866 rank=248\n",
      "[SoftImpute] Iter 541: observed MAE=0.051862 rank=248\n",
      "[SoftImpute] Iter 542: observed MAE=0.051859 rank=248\n",
      "[SoftImpute] Iter 543: observed MAE=0.051855 rank=247\n",
      "[SoftImpute] Iter 544: observed MAE=0.051851 rank=247\n",
      "[SoftImpute] Iter 545: observed MAE=0.051848 rank=247\n",
      "[SoftImpute] Iter 546: observed MAE=0.051845 rank=247\n",
      "[SoftImpute] Iter 547: observed MAE=0.051842 rank=247\n",
      "[SoftImpute] Iter 548: observed MAE=0.051840 rank=247\n",
      "[SoftImpute] Iter 549: observed MAE=0.051837 rank=247\n",
      "[SoftImpute] Iter 550: observed MAE=0.051835 rank=247\n",
      "[SoftImpute] Iter 551: observed MAE=0.051833 rank=247\n",
      "[SoftImpute] Iter 552: observed MAE=0.051830 rank=247\n",
      "[SoftImpute] Iter 553: observed MAE=0.051828 rank=247\n",
      "[SoftImpute] Iter 554: observed MAE=0.051826 rank=247\n",
      "[SoftImpute] Iter 555: observed MAE=0.051823 rank=246\n",
      "[SoftImpute] Iter 556: observed MAE=0.051819 rank=246\n",
      "[SoftImpute] Iter 557: observed MAE=0.051815 rank=245\n",
      "[SoftImpute] Iter 558: observed MAE=0.051811 rank=245\n",
      "[SoftImpute] Iter 559: observed MAE=0.051808 rank=245\n",
      "[SoftImpute] Iter 560: observed MAE=0.051805 rank=245\n",
      "[SoftImpute] Iter 561: observed MAE=0.051802 rank=245\n",
      "[SoftImpute] Iter 562: observed MAE=0.051800 rank=245\n",
      "[SoftImpute] Iter 563: observed MAE=0.051798 rank=245\n",
      "[SoftImpute] Iter 564: observed MAE=0.051795 rank=245\n",
      "[SoftImpute] Iter 565: observed MAE=0.051793 rank=245\n",
      "[SoftImpute] Iter 566: observed MAE=0.051791 rank=245\n",
      "[SoftImpute] Iter 567: observed MAE=0.051788 rank=245\n",
      "[SoftImpute] Iter 568: observed MAE=0.051786 rank=245\n",
      "[SoftImpute] Iter 569: observed MAE=0.051784 rank=245\n",
      "[SoftImpute] Iter 570: observed MAE=0.051782 rank=245\n",
      "[SoftImpute] Iter 571: observed MAE=0.051779 rank=245\n",
      "[SoftImpute] Iter 572: observed MAE=0.051777 rank=245\n",
      "[SoftImpute] Iter 573: observed MAE=0.051775 rank=245\n",
      "[SoftImpute] Iter 574: observed MAE=0.051773 rank=245\n",
      "[SoftImpute] Iter 575: observed MAE=0.051771 rank=245\n",
      "[SoftImpute] Iter 576: observed MAE=0.051769 rank=245\n",
      "[SoftImpute] Iter 577: observed MAE=0.051765 rank=244\n",
      "[SoftImpute] Iter 578: observed MAE=0.051762 rank=244\n",
      "[SoftImpute] Iter 579: observed MAE=0.051760 rank=244\n",
      "[SoftImpute] Iter 580: observed MAE=0.051757 rank=244\n",
      "[SoftImpute] Iter 581: observed MAE=0.051755 rank=244\n",
      "[SoftImpute] Iter 582: observed MAE=0.051753 rank=244\n",
      "[SoftImpute] Iter 583: observed MAE=0.051749 rank=243\n",
      "[SoftImpute] Iter 584: observed MAE=0.051746 rank=243\n",
      "[SoftImpute] Iter 585: observed MAE=0.051743 rank=243\n",
      "[SoftImpute] Iter 586: observed MAE=0.051739 rank=242\n",
      "[SoftImpute] Iter 587: observed MAE=0.051736 rank=242\n",
      "[SoftImpute] Iter 588: observed MAE=0.051733 rank=242\n",
      "[SoftImpute] Iter 589: observed MAE=0.051731 rank=242\n",
      "[SoftImpute] Iter 590: observed MAE=0.051727 rank=241\n",
      "[SoftImpute] Iter 591: observed MAE=0.051724 rank=241\n",
      "[SoftImpute] Iter 592: observed MAE=0.051721 rank=241\n",
      "[SoftImpute] Iter 593: observed MAE=0.051719 rank=241\n",
      "[SoftImpute] Iter 594: observed MAE=0.051716 rank=241\n",
      "[SoftImpute] Iter 595: observed MAE=0.051714 rank=241\n",
      "[SoftImpute] Iter 596: observed MAE=0.051712 rank=240\n",
      "[SoftImpute] Iter 597: observed MAE=0.051708 rank=240\n",
      "[SoftImpute] Iter 598: observed MAE=0.051705 rank=240\n",
      "[SoftImpute] Iter 599: observed MAE=0.051703 rank=240\n",
      "[SoftImpute] Iter 600: observed MAE=0.051701 rank=240\n",
      "[SoftImpute] Iter 601: observed MAE=0.051698 rank=240\n",
      "[SoftImpute] Iter 602: observed MAE=0.051696 rank=240\n",
      "[SoftImpute] Iter 603: observed MAE=0.051694 rank=240\n",
      "[SoftImpute] Iter 604: observed MAE=0.051692 rank=240\n",
      "[SoftImpute] Iter 605: observed MAE=0.051690 rank=240\n",
      "[SoftImpute] Iter 606: observed MAE=0.051688 rank=240\n",
      "[SoftImpute] Iter 607: observed MAE=0.051686 rank=240\n",
      "[SoftImpute] Iter 608: observed MAE=0.051683 rank=239\n",
      "[SoftImpute] Iter 609: observed MAE=0.051680 rank=239\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 610: observed MAE=0.051677 rank=239\n",
      "[SoftImpute] Iter 611: observed MAE=0.051675 rank=239\n",
      "[SoftImpute] Iter 612: observed MAE=0.051673 rank=239\n",
      "[SoftImpute] Iter 613: observed MAE=0.051670 rank=238\n",
      "[SoftImpute] Iter 614: observed MAE=0.051667 rank=238\n",
      "[SoftImpute] Iter 615: observed MAE=0.051664 rank=238\n",
      "[SoftImpute] Iter 616: observed MAE=0.051662 rank=238\n",
      "[SoftImpute] Iter 617: observed MAE=0.051659 rank=238\n",
      "[SoftImpute] Iter 618: observed MAE=0.051657 rank=238\n",
      "[SoftImpute] Iter 619: observed MAE=0.051655 rank=238\n",
      "[SoftImpute] Iter 620: observed MAE=0.051653 rank=238\n",
      "[SoftImpute] Iter 621: observed MAE=0.051651 rank=238\n",
      "[SoftImpute] Iter 622: observed MAE=0.051649 rank=238\n",
      "[SoftImpute] Iter 623: observed MAE=0.051647 rank=238\n",
      "[SoftImpute] Iter 624: observed MAE=0.051645 rank=238\n",
      "[SoftImpute] Iter 625: observed MAE=0.051643 rank=238\n",
      "[SoftImpute] Iter 626: observed MAE=0.051641 rank=238\n",
      "[SoftImpute] Iter 627: observed MAE=0.051640 rank=238\n",
      "[SoftImpute] Iter 628: observed MAE=0.051638 rank=238\n",
      "[SoftImpute] Iter 629: observed MAE=0.051636 rank=238\n",
      "[SoftImpute] Iter 630: observed MAE=0.051634 rank=238\n",
      "[SoftImpute] Iter 631: observed MAE=0.051632 rank=238\n",
      "[SoftImpute] Iter 632: observed MAE=0.051630 rank=238\n",
      "[SoftImpute] Iter 633: observed MAE=0.051628 rank=238\n",
      "[SoftImpute] Iter 634: observed MAE=0.051626 rank=238\n",
      "[SoftImpute] Iter 635: observed MAE=0.051624 rank=237\n",
      "[SoftImpute] Iter 636: observed MAE=0.051621 rank=237\n",
      "[SoftImpute] Iter 637: observed MAE=0.051619 rank=237\n",
      "[SoftImpute] Iter 638: observed MAE=0.051616 rank=237\n",
      "[SoftImpute] Iter 639: observed MAE=0.051614 rank=237\n",
      "[SoftImpute] Iter 640: observed MAE=0.051612 rank=237\n",
      "[SoftImpute] Iter 641: observed MAE=0.051610 rank=236\n",
      "[SoftImpute] Iter 642: observed MAE=0.051607 rank=236\n",
      "[SoftImpute] Iter 643: observed MAE=0.051604 rank=236\n",
      "[SoftImpute] Iter 644: observed MAE=0.051602 rank=236\n",
      "[SoftImpute] Iter 645: observed MAE=0.051600 rank=236\n",
      "[SoftImpute] Iter 646: observed MAE=0.051598 rank=236\n",
      "[SoftImpute] Iter 647: observed MAE=0.051596 rank=236\n",
      "[SoftImpute] Iter 648: observed MAE=0.051594 rank=235\n",
      "[SoftImpute] Iter 649: observed MAE=0.051591 rank=235\n",
      "[SoftImpute] Iter 650: observed MAE=0.051588 rank=235\n",
      "[SoftImpute] Iter 651: observed MAE=0.051586 rank=235\n",
      "[SoftImpute] Iter 652: observed MAE=0.051584 rank=235\n",
      "[SoftImpute] Iter 653: observed MAE=0.051582 rank=235\n",
      "[SoftImpute] Iter 654: observed MAE=0.051580 rank=235\n",
      "[SoftImpute] Iter 655: observed MAE=0.051578 rank=235\n",
      "[SoftImpute] Iter 656: observed MAE=0.051576 rank=235\n",
      "[SoftImpute] Iter 657: observed MAE=0.051574 rank=235\n",
      "[SoftImpute] Iter 658: observed MAE=0.051573 rank=235\n",
      "[SoftImpute] Iter 659: observed MAE=0.051571 rank=235\n",
      "[SoftImpute] Iter 660: observed MAE=0.051569 rank=235\n",
      "[SoftImpute] Iter 661: observed MAE=0.051567 rank=235\n",
      "[SoftImpute] Iter 662: observed MAE=0.051566 rank=235\n",
      "[SoftImpute] Iter 663: observed MAE=0.051564 rank=235\n",
      "[SoftImpute] Iter 664: observed MAE=0.051562 rank=235\n",
      "[SoftImpute] Iter 665: observed MAE=0.051560 rank=235\n",
      "[SoftImpute] Iter 666: observed MAE=0.051559 rank=235\n",
      "[SoftImpute] Iter 667: observed MAE=0.051557 rank=235\n",
      "[SoftImpute] Iter 668: observed MAE=0.051555 rank=235\n",
      "[SoftImpute] Iter 669: observed MAE=0.051554 rank=235\n",
      "[SoftImpute] Iter 670: observed MAE=0.051552 rank=234\n",
      "[SoftImpute] Iter 671: observed MAE=0.051549 rank=234\n",
      "[SoftImpute] Iter 672: observed MAE=0.051546 rank=234\n",
      "[SoftImpute] Iter 673: observed MAE=0.051544 rank=234\n",
      "[SoftImpute] Iter 674: observed MAE=0.051542 rank=234\n",
      "[SoftImpute] Iter 675: observed MAE=0.051541 rank=234\n",
      "[SoftImpute] Iter 676: observed MAE=0.051539 rank=234\n",
      "[SoftImpute] Iter 677: observed MAE=0.051537 rank=234\n",
      "[SoftImpute] Iter 678: observed MAE=0.051535 rank=233\n",
      "[SoftImpute] Iter 679: observed MAE=0.051532 rank=233\n",
      "[SoftImpute] Iter 680: observed MAE=0.051530 rank=233\n",
      "[SoftImpute] Iter 681: observed MAE=0.051528 rank=233\n",
      "[SoftImpute] Iter 682: observed MAE=0.051525 rank=232\n",
      "[SoftImpute] Iter 683: observed MAE=0.051522 rank=232\n",
      "[SoftImpute] Iter 684: observed MAE=0.051520 rank=232\n",
      "[SoftImpute] Iter 685: observed MAE=0.051518 rank=232\n",
      "[SoftImpute] Iter 686: observed MAE=0.051516 rank=232\n",
      "[SoftImpute] Iter 687: observed MAE=0.051514 rank=232\n",
      "[SoftImpute] Iter 688: observed MAE=0.051512 rank=232\n",
      "[SoftImpute] Iter 689: observed MAE=0.051510 rank=232\n",
      "[SoftImpute] Iter 690: observed MAE=0.051508 rank=232\n",
      "[SoftImpute] Iter 691: observed MAE=0.051507 rank=232\n",
      "[SoftImpute] Iter 692: observed MAE=0.051505 rank=232\n",
      "[SoftImpute] Iter 693: observed MAE=0.051503 rank=232\n",
      "[SoftImpute] Iter 694: observed MAE=0.051502 rank=232\n",
      "[SoftImpute] Iter 695: observed MAE=0.051500 rank=232\n",
      "[SoftImpute] Iter 696: observed MAE=0.051498 rank=232\n",
      "[SoftImpute] Iter 697: observed MAE=0.051497 rank=232\n",
      "[SoftImpute] Iter 698: observed MAE=0.051495 rank=232\n",
      "[SoftImpute] Iter 699: observed MAE=0.051494 rank=232\n",
      "[SoftImpute] Iter 700: observed MAE=0.051492 rank=231\n",
      "[SoftImpute] Iter 701: observed MAE=0.051489 rank=231\n",
      "[SoftImpute] Iter 702: observed MAE=0.051487 rank=231\n",
      "[SoftImpute] Iter 703: observed MAE=0.051485 rank=231\n",
      "[SoftImpute] Iter 704: observed MAE=0.051483 rank=231\n",
      "[SoftImpute] Iter 705: observed MAE=0.051481 rank=231\n",
      "[SoftImpute] Iter 706: observed MAE=0.051479 rank=230\n",
      "[SoftImpute] Iter 707: observed MAE=0.051476 rank=230\n",
      "[SoftImpute] Iter 708: observed MAE=0.051474 rank=230\n",
      "[SoftImpute] Iter 709: observed MAE=0.051472 rank=230\n",
      "[SoftImpute] Iter 710: observed MAE=0.051470 rank=230\n",
      "[SoftImpute] Iter 711: observed MAE=0.051468 rank=230\n",
      "[SoftImpute] Iter 712: observed MAE=0.051466 rank=230\n",
      "[SoftImpute] Iter 713: observed MAE=0.051465 rank=229\n",
      "[SoftImpute] Iter 714: observed MAE=0.051462 rank=229\n",
      "[SoftImpute] Iter 715: observed MAE=0.051459 rank=229\n",
      "[SoftImpute] Iter 716: observed MAE=0.051457 rank=229\n",
      "[SoftImpute] Iter 717: observed MAE=0.051456 rank=229\n",
      "[SoftImpute] Iter 718: observed MAE=0.051454 rank=229\n",
      "[SoftImpute] Iter 719: observed MAE=0.051452 rank=229\n",
      "[SoftImpute] Iter 720: observed MAE=0.051451 rank=229\n",
      "[SoftImpute] Iter 721: observed MAE=0.051449 rank=229\n",
      "[SoftImpute] Iter 722: observed MAE=0.051447 rank=229\n",
      "[SoftImpute] Iter 723: observed MAE=0.051446 rank=229\n",
      "[SoftImpute] Iter 724: observed MAE=0.051444 rank=229\n",
      "[SoftImpute] Iter 725: observed MAE=0.051443 rank=229\n",
      "[SoftImpute] Iter 726: observed MAE=0.051441 rank=229\n",
      "[SoftImpute] Iter 727: observed MAE=0.051440 rank=229\n",
      "[SoftImpute] Iter 728: observed MAE=0.051438 rank=229\n",
      "[SoftImpute] Iter 729: observed MAE=0.051437 rank=229\n",
      "[SoftImpute] Iter 730: observed MAE=0.051435 rank=229\n",
      "[SoftImpute] Iter 731: observed MAE=0.051434 rank=229\n",
      "[SoftImpute] Iter 732: observed MAE=0.051432 rank=229\n",
      "[SoftImpute] Iter 733: observed MAE=0.051431 rank=229\n",
      "[SoftImpute] Iter 734: observed MAE=0.051429 rank=229\n",
      "[SoftImpute] Iter 735: observed MAE=0.051428 rank=229\n",
      "[SoftImpute] Iter 736: observed MAE=0.051426 rank=228\n",
      "[SoftImpute] Iter 737: observed MAE=0.051424 rank=228\n",
      "[SoftImpute] Iter 738: observed MAE=0.051422 rank=228\n",
      "[SoftImpute] Iter 739: observed MAE=0.051420 rank=228\n",
      "[SoftImpute] Iter 740: observed MAE=0.051418 rank=228\n",
      "[SoftImpute] Iter 741: observed MAE=0.051417 rank=228\n",
      "[SoftImpute] Iter 742: observed MAE=0.051415 rank=228\n",
      "[SoftImpute] Iter 743: observed MAE=0.051414 rank=228\n",
      "[SoftImpute] Iter 744: observed MAE=0.051412 rank=228\n",
      "[SoftImpute] Iter 745: observed MAE=0.051411 rank=228\n",
      "[SoftImpute] Iter 746: observed MAE=0.051409 rank=228\n",
      "[SoftImpute] Iter 747: observed MAE=0.051408 rank=228\n",
      "[SoftImpute] Iter 748: observed MAE=0.051406 rank=227\n",
      "[SoftImpute] Iter 749: observed MAE=0.051403 rank=227\n",
      "[SoftImpute] Iter 750: observed MAE=0.051401 rank=227\n",
      "[SoftImpute] Iter 751: observed MAE=0.051400 rank=227\n",
      "[SoftImpute] Iter 752: observed MAE=0.051398 rank=227\n",
      "[SoftImpute] Iter 753: observed MAE=0.051396 rank=227\n",
      "[SoftImpute] Iter 754: observed MAE=0.051394 rank=226\n",
      "[SoftImpute] Iter 755: observed MAE=0.051392 rank=226\n",
      "[SoftImpute] Iter 756: observed MAE=0.051390 rank=226\n",
      "[SoftImpute] Iter 757: observed MAE=0.051388 rank=226\n",
      "[SoftImpute] Iter 758: observed MAE=0.051386 rank=226\n",
      "[SoftImpute] Iter 759: observed MAE=0.051384 rank=225\n",
      "[SoftImpute] Iter 760: observed MAE=0.051382 rank=225\n",
      "[SoftImpute] Iter 761: observed MAE=0.051380 rank=225\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 762: observed MAE=0.051378 rank=225\n",
      "[SoftImpute] Iter 763: observed MAE=0.051376 rank=225\n",
      "[SoftImpute] Iter 764: observed MAE=0.051375 rank=225\n",
      "[SoftImpute] Iter 765: observed MAE=0.051373 rank=225\n",
      "[SoftImpute] Iter 766: observed MAE=0.051372 rank=225\n",
      "[SoftImpute] Iter 767: observed MAE=0.051370 rank=225\n",
      "[SoftImpute] Iter 768: observed MAE=0.051369 rank=225\n",
      "[SoftImpute] Iter 769: observed MAE=0.051367 rank=225\n",
      "[SoftImpute] Iter 770: observed MAE=0.051366 rank=225\n",
      "[SoftImpute] Iter 771: observed MAE=0.051365 rank=225\n",
      "[SoftImpute] Iter 772: observed MAE=0.051363 rank=225\n",
      "[SoftImpute] Iter 773: observed MAE=0.051362 rank=225\n",
      "[SoftImpute] Iter 774: observed MAE=0.051361 rank=225\n",
      "[SoftImpute] Iter 775: observed MAE=0.051359 rank=225\n",
      "[SoftImpute] Iter 776: observed MAE=0.051358 rank=225\n",
      "[SoftImpute] Iter 777: observed MAE=0.051356 rank=225\n",
      "[SoftImpute] Iter 778: observed MAE=0.051355 rank=225\n",
      "[SoftImpute] Iter 779: observed MAE=0.051354 rank=225\n",
      "[SoftImpute] Iter 780: observed MAE=0.051352 rank=225\n",
      "[SoftImpute] Iter 781: observed MAE=0.051350 rank=224\n",
      "[SoftImpute] Iter 782: observed MAE=0.051348 rank=224\n",
      "[SoftImpute] Iter 783: observed MAE=0.051346 rank=224\n",
      "[SoftImpute] Iter 784: observed MAE=0.051345 rank=224\n",
      "[SoftImpute] Iter 785: observed MAE=0.051343 rank=224\n",
      "[SoftImpute] Iter 786: observed MAE=0.051342 rank=224\n",
      "[SoftImpute] Iter 787: observed MAE=0.051341 rank=224\n",
      "[SoftImpute] Iter 788: observed MAE=0.051339 rank=224\n",
      "[SoftImpute] Iter 789: observed MAE=0.051338 rank=224\n",
      "[SoftImpute] Iter 790: observed MAE=0.051336 rank=223\n",
      "[SoftImpute] Iter 791: observed MAE=0.051334 rank=223\n",
      "[SoftImpute] Iter 792: observed MAE=0.051332 rank=223\n",
      "[SoftImpute] Iter 793: observed MAE=0.051330 rank=223\n",
      "[SoftImpute] Iter 794: observed MAE=0.051329 rank=223\n",
      "[SoftImpute] Iter 795: observed MAE=0.051327 rank=223\n",
      "[SoftImpute] Iter 796: observed MAE=0.051326 rank=223\n",
      "[SoftImpute] Iter 797: observed MAE=0.051324 rank=223\n",
      "[SoftImpute] Iter 798: observed MAE=0.051323 rank=223\n",
      "[SoftImpute] Iter 799: observed MAE=0.051322 rank=223\n",
      "[SoftImpute] Iter 800: observed MAE=0.051320 rank=223\n",
      "[SoftImpute] Iter 801: observed MAE=0.051319 rank=223\n",
      "[SoftImpute] Iter 802: observed MAE=0.051318 rank=223\n",
      "[SoftImpute] Iter 803: observed MAE=0.051316 rank=223\n",
      "[SoftImpute] Iter 804: observed MAE=0.051315 rank=223\n",
      "[SoftImpute] Iter 805: observed MAE=0.051314 rank=223\n",
      "[SoftImpute] Iter 806: observed MAE=0.051312 rank=222\n",
      "[SoftImpute] Iter 807: observed MAE=0.051310 rank=222\n",
      "[SoftImpute] Iter 808: observed MAE=0.051308 rank=222\n",
      "[SoftImpute] Iter 809: observed MAE=0.051306 rank=222\n",
      "[SoftImpute] Iter 810: observed MAE=0.051305 rank=222\n",
      "[SoftImpute] Iter 811: observed MAE=0.051303 rank=222\n",
      "[SoftImpute] Iter 812: observed MAE=0.051302 rank=222\n",
      "[SoftImpute] Iter 813: observed MAE=0.051301 rank=222\n",
      "[SoftImpute] Iter 814: observed MAE=0.051299 rank=222\n",
      "[SoftImpute] Iter 815: observed MAE=0.051298 rank=222\n",
      "[SoftImpute] Iter 816: observed MAE=0.051297 rank=222\n",
      "[SoftImpute] Iter 817: observed MAE=0.051296 rank=222\n",
      "[SoftImpute] Iter 818: observed MAE=0.051294 rank=222\n",
      "[SoftImpute] Iter 819: observed MAE=0.051293 rank=222\n",
      "[SoftImpute] Iter 820: observed MAE=0.051292 rank=222\n",
      "[SoftImpute] Iter 821: observed MAE=0.051291 rank=222\n",
      "[SoftImpute] Iter 822: observed MAE=0.051289 rank=222\n",
      "[SoftImpute] Iter 823: observed MAE=0.051287 rank=221\n",
      "[SoftImpute] Iter 824: observed MAE=0.051285 rank=221\n",
      "[SoftImpute] Iter 825: observed MAE=0.051284 rank=221\n",
      "[SoftImpute] Iter 826: observed MAE=0.051282 rank=221\n",
      "[SoftImpute] Iter 827: observed MAE=0.051281 rank=221\n",
      "[SoftImpute] Iter 828: observed MAE=0.051279 rank=221\n",
      "[SoftImpute] Iter 829: observed MAE=0.051278 rank=221\n",
      "[SoftImpute] Iter 830: observed MAE=0.051277 rank=221\n",
      "[SoftImpute] Iter 831: observed MAE=0.051276 rank=221\n",
      "[SoftImpute] Iter 832: observed MAE=0.051274 rank=221\n",
      "[SoftImpute] Iter 833: observed MAE=0.051273 rank=221\n",
      "[SoftImpute] Iter 834: observed MAE=0.051272 rank=221\n",
      "[SoftImpute] Iter 835: observed MAE=0.051271 rank=221\n",
      "[SoftImpute] Iter 836: observed MAE=0.051270 rank=221\n",
      "[SoftImpute] Iter 837: observed MAE=0.051268 rank=221\n",
      "[SoftImpute] Iter 838: observed MAE=0.051267 rank=221\n",
      "[SoftImpute] Iter 839: observed MAE=0.051266 rank=221\n",
      "[SoftImpute] Iter 840: observed MAE=0.051265 rank=220\n",
      "[SoftImpute] Iter 841: observed MAE=0.051263 rank=220\n",
      "[SoftImpute] Iter 842: observed MAE=0.051261 rank=220\n",
      "[SoftImpute] Iter 843: observed MAE=0.051259 rank=220\n",
      "[SoftImpute] Iter 844: observed MAE=0.051258 rank=220\n",
      "[SoftImpute] Iter 845: observed MAE=0.051257 rank=220\n",
      "[SoftImpute] Iter 846: observed MAE=0.051255 rank=220\n",
      "[SoftImpute] Iter 847: observed MAE=0.051254 rank=220\n",
      "[SoftImpute] Iter 848: observed MAE=0.051253 rank=220\n",
      "[SoftImpute] Iter 849: observed MAE=0.051252 rank=220\n",
      "[SoftImpute] Iter 850: observed MAE=0.051251 rank=220\n",
      "[SoftImpute] Iter 851: observed MAE=0.051249 rank=220\n",
      "[SoftImpute] Iter 852: observed MAE=0.051248 rank=220\n",
      "[SoftImpute] Iter 853: observed MAE=0.051247 rank=219\n",
      "[SoftImpute] Iter 854: observed MAE=0.051244 rank=219\n",
      "[SoftImpute] Iter 855: observed MAE=0.051243 rank=219\n",
      "[SoftImpute] Iter 856: observed MAE=0.051241 rank=219\n",
      "[SoftImpute] Iter 857: observed MAE=0.051240 rank=219\n",
      "[SoftImpute] Iter 858: observed MAE=0.051239 rank=219\n",
      "[SoftImpute] Iter 859: observed MAE=0.051237 rank=219\n",
      "[SoftImpute] Iter 860: observed MAE=0.051236 rank=219\n",
      "[SoftImpute] Iter 861: observed MAE=0.051235 rank=219\n",
      "[SoftImpute] Iter 862: observed MAE=0.051234 rank=218\n",
      "[SoftImpute] Iter 863: observed MAE=0.051231 rank=218\n",
      "[SoftImpute] Iter 864: observed MAE=0.051230 rank=218\n",
      "[SoftImpute] Iter 865: observed MAE=0.051228 rank=218\n",
      "[SoftImpute] Iter 866: observed MAE=0.051227 rank=218\n",
      "[SoftImpute] Iter 867: observed MAE=0.051225 rank=218\n",
      "[SoftImpute] Iter 868: observed MAE=0.051224 rank=218\n",
      "[SoftImpute] Iter 869: observed MAE=0.051223 rank=218\n",
      "[SoftImpute] Iter 870: observed MAE=0.051221 rank=217\n",
      "[SoftImpute] Iter 871: observed MAE=0.051219 rank=217\n",
      "[SoftImpute] Iter 872: observed MAE=0.051218 rank=217\n",
      "[SoftImpute] Iter 873: observed MAE=0.051216 rank=217\n",
      "[SoftImpute] Iter 874: observed MAE=0.051215 rank=217\n",
      "[SoftImpute] Iter 875: observed MAE=0.051214 rank=217\n",
      "[SoftImpute] Iter 876: observed MAE=0.051212 rank=217\n",
      "[SoftImpute] Iter 877: observed MAE=0.051211 rank=217\n",
      "[SoftImpute] Iter 878: observed MAE=0.051210 rank=217\n",
      "[SoftImpute] Iter 879: observed MAE=0.051209 rank=217\n",
      "[SoftImpute] Iter 880: observed MAE=0.051208 rank=217\n",
      "[SoftImpute] Iter 881: observed MAE=0.051207 rank=217\n",
      "[SoftImpute] Iter 882: observed MAE=0.051206 rank=217\n",
      "[SoftImpute] Iter 883: observed MAE=0.051204 rank=217\n",
      "[SoftImpute] Iter 884: observed MAE=0.051203 rank=217\n",
      "[SoftImpute] Iter 885: observed MAE=0.051202 rank=217\n",
      "[SoftImpute] Iter 886: observed MAE=0.051201 rank=217\n",
      "[SoftImpute] Iter 887: observed MAE=0.051200 rank=217\n",
      "[SoftImpute] Iter 888: observed MAE=0.051199 rank=217\n",
      "[SoftImpute] Iter 889: observed MAE=0.051198 rank=217\n",
      "[SoftImpute] Iter 890: observed MAE=0.051197 rank=217\n",
      "[SoftImpute] Iter 891: observed MAE=0.051196 rank=217\n",
      "[SoftImpute] Iter 892: observed MAE=0.051195 rank=217\n",
      "[SoftImpute] Iter 893: observed MAE=0.051194 rank=216\n",
      "[SoftImpute] Iter 894: observed MAE=0.051192 rank=216\n",
      "[SoftImpute] Iter 895: observed MAE=0.051190 rank=216\n",
      "[SoftImpute] Iter 896: observed MAE=0.051189 rank=216\n",
      "[SoftImpute] Iter 897: observed MAE=0.051188 rank=216\n",
      "[SoftImpute] Iter 898: observed MAE=0.051186 rank=216\n",
      "[SoftImpute] Iter 899: observed MAE=0.051185 rank=216\n",
      "[SoftImpute] Iter 900: observed MAE=0.051184 rank=216\n",
      "[SoftImpute] Iter 901: observed MAE=0.051183 rank=216\n",
      "[SoftImpute] Iter 902: observed MAE=0.051182 rank=216\n",
      "[SoftImpute] Iter 903: observed MAE=0.051181 rank=216\n",
      "[SoftImpute] Iter 904: observed MAE=0.051180 rank=216\n",
      "[SoftImpute] Iter 905: observed MAE=0.051179 rank=216\n",
      "[SoftImpute] Iter 906: observed MAE=0.051178 rank=216\n",
      "[SoftImpute] Iter 907: observed MAE=0.051177 rank=216\n",
      "[SoftImpute] Iter 908: observed MAE=0.051176 rank=216\n",
      "[SoftImpute] Iter 909: observed MAE=0.051174 rank=215\n",
      "[SoftImpute] Iter 910: observed MAE=0.051172 rank=215\n",
      "[SoftImpute] Iter 911: observed MAE=0.051171 rank=215\n",
      "[SoftImpute] Iter 912: observed MAE=0.051170 rank=215\n",
      "[SoftImpute] Iter 913: observed MAE=0.051168 rank=215\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 914: observed MAE=0.051167 rank=215\n",
      "[SoftImpute] Iter 915: observed MAE=0.051166 rank=215\n",
      "[SoftImpute] Iter 916: observed MAE=0.051165 rank=215\n",
      "[SoftImpute] Iter 917: observed MAE=0.051164 rank=215\n",
      "[SoftImpute] Iter 918: observed MAE=0.051163 rank=215\n",
      "[SoftImpute] Iter 919: observed MAE=0.051162 rank=215\n",
      "[SoftImpute] Iter 920: observed MAE=0.051161 rank=215\n",
      "[SoftImpute] Iter 921: observed MAE=0.051160 rank=215\n",
      "[SoftImpute] Iter 922: observed MAE=0.051159 rank=215\n",
      "[SoftImpute] Iter 923: observed MAE=0.051157 rank=215\n",
      "[SoftImpute] Iter 924: observed MAE=0.051156 rank=214\n",
      "[SoftImpute] Iter 925: observed MAE=0.051154 rank=214\n",
      "[SoftImpute] Iter 926: observed MAE=0.051153 rank=214\n",
      "[SoftImpute] Iter 927: observed MAE=0.051151 rank=214\n",
      "[SoftImpute] Iter 928: observed MAE=0.051150 rank=214\n",
      "[SoftImpute] Iter 929: observed MAE=0.051149 rank=214\n",
      "[SoftImpute] Iter 930: observed MAE=0.051148 rank=214\n",
      "[SoftImpute] Iter 931: observed MAE=0.051147 rank=214\n",
      "[SoftImpute] Iter 932: observed MAE=0.051146 rank=214\n",
      "[SoftImpute] Iter 933: observed MAE=0.051144 rank=214\n",
      "[SoftImpute] Iter 934: observed MAE=0.051143 rank=214\n",
      "[SoftImpute] Iter 935: observed MAE=0.051142 rank=214\n",
      "[SoftImpute] Iter 936: observed MAE=0.051141 rank=214\n",
      "[SoftImpute] Iter 937: observed MAE=0.051140 rank=214\n",
      "[SoftImpute] Iter 938: observed MAE=0.051139 rank=214\n",
      "[SoftImpute] Iter 939: observed MAE=0.051138 rank=214\n",
      "[SoftImpute] Iter 940: observed MAE=0.051137 rank=214\n",
      "[SoftImpute] Iter 941: observed MAE=0.051136 rank=214\n",
      "[SoftImpute] Iter 942: observed MAE=0.051135 rank=214\n",
      "[SoftImpute] Iter 943: observed MAE=0.051134 rank=214\n",
      "[SoftImpute] Iter 944: observed MAE=0.051133 rank=214\n",
      "[SoftImpute] Iter 945: observed MAE=0.051132 rank=214\n",
      "[SoftImpute] Iter 946: observed MAE=0.051131 rank=214\n",
      "[SoftImpute] Iter 947: observed MAE=0.051130 rank=214\n",
      "[SoftImpute] Iter 948: observed MAE=0.051129 rank=214\n",
      "[SoftImpute] Iter 949: observed MAE=0.051128 rank=214\n",
      "[SoftImpute] Iter 950: observed MAE=0.051127 rank=214\n",
      "[SoftImpute] Iter 951: observed MAE=0.051126 rank=214\n",
      "[SoftImpute] Iter 952: observed MAE=0.051125 rank=214\n",
      "[SoftImpute] Iter 953: observed MAE=0.051124 rank=213\n",
      "[SoftImpute] Iter 954: observed MAE=0.051122 rank=213\n",
      "[SoftImpute] Iter 955: observed MAE=0.051121 rank=213\n",
      "[SoftImpute] Iter 956: observed MAE=0.051120 rank=213\n",
      "[SoftImpute] Iter 957: observed MAE=0.051119 rank=213\n",
      "[SoftImpute] Iter 958: observed MAE=0.051118 rank=213\n",
      "[SoftImpute] Iter 959: observed MAE=0.051117 rank=213\n",
      "[SoftImpute] Iter 960: observed MAE=0.051116 rank=213\n",
      "[SoftImpute] Iter 961: observed MAE=0.051115 rank=213\n",
      "[SoftImpute] Iter 962: observed MAE=0.051114 rank=213\n",
      "[SoftImpute] Iter 963: observed MAE=0.051113 rank=213\n",
      "[SoftImpute] Iter 964: observed MAE=0.051111 rank=213\n",
      "[SoftImpute] Iter 965: observed MAE=0.051110 rank=213\n",
      "[SoftImpute] Iter 966: observed MAE=0.051110 rank=213\n",
      "[SoftImpute] Iter 967: observed MAE=0.051108 rank=212\n",
      "[SoftImpute] Iter 968: observed MAE=0.051106 rank=212\n",
      "[SoftImpute] Iter 969: observed MAE=0.051105 rank=212\n",
      "[SoftImpute] Iter 970: observed MAE=0.051104 rank=212\n",
      "[SoftImpute] Iter 971: observed MAE=0.051103 rank=212\n",
      "[SoftImpute] Iter 972: observed MAE=0.051101 rank=212\n",
      "[SoftImpute] Iter 973: observed MAE=0.051100 rank=212\n",
      "[SoftImpute] Iter 974: observed MAE=0.051099 rank=212\n",
      "[SoftImpute] Iter 975: observed MAE=0.051098 rank=212\n",
      "[SoftImpute] Iter 976: observed MAE=0.051097 rank=212\n",
      "[SoftImpute] Iter 977: observed MAE=0.051096 rank=212\n",
      "[SoftImpute] Iter 978: observed MAE=0.051095 rank=212\n",
      "[SoftImpute] Iter 979: observed MAE=0.051095 rank=212\n",
      "[SoftImpute] Iter 980: observed MAE=0.051093 rank=211\n",
      "[SoftImpute] Iter 981: observed MAE=0.051091 rank=211\n",
      "[SoftImpute] Iter 982: observed MAE=0.051090 rank=211\n",
      "[SoftImpute] Iter 983: observed MAE=0.051089 rank=211\n",
      "[SoftImpute] Iter 984: observed MAE=0.051088 rank=211\n",
      "[SoftImpute] Iter 985: observed MAE=0.051086 rank=211\n",
      "[SoftImpute] Iter 986: observed MAE=0.051085 rank=211\n",
      "[SoftImpute] Iter 987: observed MAE=0.051084 rank=211\n",
      "[SoftImpute] Iter 988: observed MAE=0.051083 rank=211\n",
      "[SoftImpute] Iter 989: observed MAE=0.051082 rank=211\n",
      "[SoftImpute] Iter 990: observed MAE=0.051081 rank=211\n",
      "[SoftImpute] Iter 991: observed MAE=0.051081 rank=211\n",
      "[SoftImpute] Iter 992: observed MAE=0.051080 rank=211\n",
      "[SoftImpute] Iter 993: observed MAE=0.051079 rank=211\n",
      "[SoftImpute] Iter 994: observed MAE=0.051078 rank=211\n",
      "[SoftImpute] Iter 995: observed MAE=0.051077 rank=211\n",
      "[SoftImpute] Iter 996: observed MAE=0.051076 rank=211\n",
      "[SoftImpute] Iter 997: observed MAE=0.051075 rank=211\n",
      "[SoftImpute] Iter 998: observed MAE=0.051074 rank=211\n",
      "[SoftImpute] Iter 999: observed MAE=0.051073 rank=211\n",
      "[SoftImpute] Iter 1000: observed MAE=0.051072 rank=211\n",
      "[SoftImpute] Iter 1001: observed MAE=0.051071 rank=211\n",
      "[SoftImpute] Iter 1002: observed MAE=0.051070 rank=211\n",
      "[SoftImpute] Iter 1003: observed MAE=0.051069 rank=211\n",
      "[SoftImpute] Iter 1004: observed MAE=0.051069 rank=211\n",
      "[SoftImpute] Iter 1005: observed MAE=0.051067 rank=210\n",
      "[SoftImpute] Iter 1006: observed MAE=0.051066 rank=210\n",
      "[SoftImpute] Iter 1007: observed MAE=0.051064 rank=210\n",
      "[SoftImpute] Iter 1008: observed MAE=0.051063 rank=210\n",
      "[SoftImpute] Iter 1009: observed MAE=0.051062 rank=210\n",
      "[SoftImpute] Iter 1010: observed MAE=0.051061 rank=210\n",
      "[SoftImpute] Iter 1011: observed MAE=0.051060 rank=210\n",
      "[SoftImpute] Iter 1012: observed MAE=0.051059 rank=210\n",
      "[SoftImpute] Iter 1013: observed MAE=0.051058 rank=210\n",
      "[SoftImpute] Iter 1014: observed MAE=0.051057 rank=210\n",
      "[SoftImpute] Iter 1015: observed MAE=0.051057 rank=210\n",
      "[SoftImpute] Iter 1016: observed MAE=0.051056 rank=210\n",
      "[SoftImpute] Iter 1017: observed MAE=0.051055 rank=210\n",
      "[SoftImpute] Iter 1018: observed MAE=0.051054 rank=210\n",
      "[SoftImpute] Iter 1019: observed MAE=0.051053 rank=210\n",
      "[SoftImpute] Iter 1020: observed MAE=0.051052 rank=210\n",
      "[SoftImpute] Iter 1021: observed MAE=0.051051 rank=210\n",
      "[SoftImpute] Iter 1022: observed MAE=0.051050 rank=210\n",
      "[SoftImpute] Iter 1023: observed MAE=0.051049 rank=210\n",
      "[SoftImpute] Iter 1024: observed MAE=0.051049 rank=210\n",
      "[SoftImpute] Iter 1025: observed MAE=0.051048 rank=210\n",
      "[SoftImpute] Iter 1026: observed MAE=0.051047 rank=210\n",
      "[SoftImpute] Iter 1027: observed MAE=0.051046 rank=210\n",
      "[SoftImpute] Iter 1028: observed MAE=0.051045 rank=210\n",
      "[SoftImpute] Iter 1029: observed MAE=0.051044 rank=210\n",
      "[SoftImpute] Iter 1030: observed MAE=0.051043 rank=210\n",
      "[SoftImpute] Iter 1031: observed MAE=0.051043 rank=209\n",
      "[SoftImpute] Iter 1032: observed MAE=0.051041 rank=209\n",
      "[SoftImpute] Iter 1033: observed MAE=0.051040 rank=209\n",
      "[SoftImpute] Iter 1034: observed MAE=0.051038 rank=209\n",
      "[SoftImpute] Iter 1035: observed MAE=0.051037 rank=209\n",
      "[SoftImpute] Iter 1036: observed MAE=0.051036 rank=209\n",
      "[SoftImpute] Iter 1037: observed MAE=0.051035 rank=209\n",
      "[SoftImpute] Iter 1038: observed MAE=0.051035 rank=209\n",
      "[SoftImpute] Iter 1039: observed MAE=0.051034 rank=209\n",
      "[SoftImpute] Iter 1040: observed MAE=0.051033 rank=209\n",
      "[SoftImpute] Iter 1041: observed MAE=0.051032 rank=209\n",
      "[SoftImpute] Iter 1042: observed MAE=0.051031 rank=209\n",
      "[SoftImpute] Iter 1043: observed MAE=0.051030 rank=209\n",
      "[SoftImpute] Iter 1044: observed MAE=0.051029 rank=209\n",
      "[SoftImpute] Iter 1045: observed MAE=0.051029 rank=209\n",
      "[SoftImpute] Iter 1046: observed MAE=0.051028 rank=209\n",
      "[SoftImpute] Iter 1047: observed MAE=0.051027 rank=209\n",
      "[SoftImpute] Iter 1048: observed MAE=0.051026 rank=209\n",
      "[SoftImpute] Iter 1049: observed MAE=0.051025 rank=209\n",
      "[SoftImpute] Iter 1050: observed MAE=0.051024 rank=209\n",
      "[SoftImpute] Iter 1051: observed MAE=0.051024 rank=209\n",
      "[SoftImpute] Iter 1052: observed MAE=0.051023 rank=209\n",
      "[SoftImpute] Iter 1053: observed MAE=0.051022 rank=209\n",
      "[SoftImpute] Iter 1054: observed MAE=0.051021 rank=209\n",
      "[SoftImpute] Iter 1055: observed MAE=0.051020 rank=209\n",
      "[SoftImpute] Iter 1056: observed MAE=0.051020 rank=209\n",
      "[SoftImpute] Iter 1057: observed MAE=0.051019 rank=208\n",
      "[SoftImpute] Iter 1058: observed MAE=0.051017 rank=208\n",
      "[SoftImpute] Iter 1059: observed MAE=0.051016 rank=208\n",
      "[SoftImpute] Iter 1060: observed MAE=0.051015 rank=208\n",
      "[SoftImpute] Iter 1061: observed MAE=0.051014 rank=208\n",
      "[SoftImpute] Iter 1062: observed MAE=0.051013 rank=208\n",
      "[SoftImpute] Iter 1063: observed MAE=0.051012 rank=208\n",
      "[SoftImpute] Iter 1064: observed MAE=0.051011 rank=208\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 1065: observed MAE=0.051011 rank=207\n",
      "[SoftImpute] Iter 1066: observed MAE=0.051009 rank=207\n",
      "[SoftImpute] Iter 1067: observed MAE=0.051008 rank=207\n",
      "[SoftImpute] Iter 1068: observed MAE=0.051007 rank=207\n",
      "[SoftImpute] Iter 1069: observed MAE=0.051006 rank=207\n",
      "[SoftImpute] Iter 1070: observed MAE=0.051005 rank=207\n",
      "[SoftImpute] Iter 1071: observed MAE=0.051004 rank=207\n",
      "[SoftImpute] Iter 1072: observed MAE=0.051003 rank=207\n",
      "[SoftImpute] Iter 1073: observed MAE=0.051002 rank=207\n",
      "[SoftImpute] Iter 1074: observed MAE=0.051002 rank=207\n",
      "[SoftImpute] Iter 1075: observed MAE=0.051001 rank=207\n",
      "[SoftImpute] Iter 1076: observed MAE=0.051000 rank=207\n",
      "[SoftImpute] Iter 1077: observed MAE=0.050999 rank=207\n",
      "[SoftImpute] Iter 1078: observed MAE=0.050998 rank=207\n",
      "[SoftImpute] Iter 1079: observed MAE=0.050998 rank=207\n",
      "[SoftImpute] Iter 1080: observed MAE=0.050997 rank=207\n",
      "[SoftImpute] Iter 1081: observed MAE=0.050996 rank=207\n",
      "[SoftImpute] Iter 1082: observed MAE=0.050995 rank=207\n",
      "[SoftImpute] Iter 1083: observed MAE=0.050994 rank=207\n",
      "[SoftImpute] Iter 1084: observed MAE=0.050994 rank=207\n",
      "[SoftImpute] Iter 1085: observed MAE=0.050993 rank=207\n",
      "[SoftImpute] Iter 1086: observed MAE=0.050992 rank=207\n",
      "[SoftImpute] Iter 1087: observed MAE=0.050991 rank=207\n",
      "[SoftImpute] Iter 1088: observed MAE=0.050991 rank=207\n",
      "[SoftImpute] Iter 1089: observed MAE=0.050990 rank=207\n",
      "[SoftImpute] Iter 1090: observed MAE=0.050989 rank=207\n",
      "[SoftImpute] Iter 1091: observed MAE=0.050988 rank=207\n",
      "[SoftImpute] Iter 1092: observed MAE=0.050987 rank=207\n",
      "[SoftImpute] Iter 1093: observed MAE=0.050987 rank=207\n",
      "[SoftImpute] Iter 1094: observed MAE=0.050986 rank=207\n",
      "[SoftImpute] Iter 1095: observed MAE=0.050985 rank=207\n",
      "[SoftImpute] Iter 1096: observed MAE=0.050984 rank=207\n",
      "[SoftImpute] Iter 1097: observed MAE=0.050984 rank=207\n",
      "[SoftImpute] Iter 1098: observed MAE=0.050983 rank=207\n",
      "[SoftImpute] Iter 1099: observed MAE=0.050982 rank=207\n",
      "[SoftImpute] Iter 1100: observed MAE=0.050981 rank=207\n",
      "[SoftImpute] Iter 1101: observed MAE=0.050981 rank=207\n",
      "[SoftImpute] Iter 1102: observed MAE=0.050980 rank=207\n",
      "[SoftImpute] Iter 1103: observed MAE=0.050979 rank=207\n",
      "[SoftImpute] Iter 1104: observed MAE=0.050978 rank=206\n",
      "[SoftImpute] Iter 1105: observed MAE=0.050977 rank=206\n",
      "[SoftImpute] Iter 1106: observed MAE=0.050976 rank=206\n",
      "[SoftImpute] Iter 1107: observed MAE=0.050975 rank=206\n",
      "[SoftImpute] Iter 1108: observed MAE=0.050974 rank=206\n",
      "[SoftImpute] Iter 1109: observed MAE=0.050973 rank=206\n",
      "[SoftImpute] Iter 1110: observed MAE=0.050972 rank=206\n",
      "[SoftImpute] Iter 1111: observed MAE=0.050971 rank=206\n",
      "[SoftImpute] Iter 1112: observed MAE=0.050971 rank=206\n",
      "[SoftImpute] Iter 1113: observed MAE=0.050970 rank=206\n",
      "[SoftImpute] Iter 1114: observed MAE=0.050969 rank=206\n",
      "[SoftImpute] Iter 1115: observed MAE=0.050968 rank=206\n",
      "[SoftImpute] Iter 1116: observed MAE=0.050968 rank=206\n",
      "[SoftImpute] Iter 1117: observed MAE=0.050967 rank=206\n",
      "[SoftImpute] Iter 1118: observed MAE=0.050966 rank=206\n",
      "[SoftImpute] Iter 1119: observed MAE=0.050965 rank=206\n",
      "[SoftImpute] Iter 1120: observed MAE=0.050965 rank=206\n",
      "[SoftImpute] Iter 1121: observed MAE=0.050964 rank=206\n",
      "[SoftImpute] Iter 1122: observed MAE=0.050963 rank=206\n",
      "[SoftImpute] Iter 1123: observed MAE=0.050962 rank=206\n",
      "[SoftImpute] Iter 1124: observed MAE=0.050962 rank=206\n",
      "[SoftImpute] Iter 1125: observed MAE=0.050961 rank=206\n",
      "[SoftImpute] Iter 1126: observed MAE=0.050960 rank=206\n",
      "[SoftImpute] Iter 1127: observed MAE=0.050960 rank=206\n",
      "[SoftImpute] Iter 1128: observed MAE=0.050959 rank=205\n",
      "[SoftImpute] Iter 1129: observed MAE=0.050957 rank=205\n",
      "[SoftImpute] Iter 1130: observed MAE=0.050956 rank=205\n",
      "[SoftImpute] Iter 1131: observed MAE=0.050955 rank=205\n",
      "[SoftImpute] Iter 1132: observed MAE=0.050955 rank=205\n",
      "[SoftImpute] Iter 1133: observed MAE=0.050954 rank=205\n",
      "[SoftImpute] Iter 1134: observed MAE=0.050953 rank=205\n",
      "[SoftImpute] Iter 1135: observed MAE=0.050952 rank=205\n",
      "[SoftImpute] Iter 1136: observed MAE=0.050951 rank=205\n",
      "[SoftImpute] Iter 1137: observed MAE=0.050951 rank=205\n",
      "[SoftImpute] Iter 1138: observed MAE=0.050950 rank=205\n",
      "[SoftImpute] Iter 1139: observed MAE=0.050949 rank=205\n",
      "[SoftImpute] Iter 1140: observed MAE=0.050948 rank=205\n",
      "[SoftImpute] Iter 1141: observed MAE=0.050947 rank=204\n",
      "[SoftImpute] Iter 1142: observed MAE=0.050946 rank=204\n",
      "[SoftImpute] Iter 1143: observed MAE=0.050945 rank=204\n",
      "[SoftImpute] Iter 1144: observed MAE=0.050944 rank=204\n",
      "[SoftImpute] Iter 1145: observed MAE=0.050944 rank=204\n",
      "[SoftImpute] Iter 1146: observed MAE=0.050943 rank=204\n",
      "[SoftImpute] Iter 1147: observed MAE=0.050942 rank=204\n",
      "[SoftImpute] Iter 1148: observed MAE=0.050941 rank=204\n",
      "[SoftImpute] Iter 1149: observed MAE=0.050941 rank=204\n",
      "[SoftImpute] Iter 1150: observed MAE=0.050940 rank=204\n",
      "[SoftImpute] Iter 1151: observed MAE=0.050939 rank=204\n",
      "[SoftImpute] Iter 1152: observed MAE=0.050938 rank=204\n",
      "[SoftImpute] Iter 1153: observed MAE=0.050938 rank=204\n",
      "[SoftImpute] Iter 1154: observed MAE=0.050937 rank=204\n",
      "[SoftImpute] Iter 1155: observed MAE=0.050936 rank=204\n",
      "[SoftImpute] Iter 1156: observed MAE=0.050936 rank=204\n",
      "[SoftImpute] Iter 1157: observed MAE=0.050935 rank=204\n",
      "[SoftImpute] Iter 1158: observed MAE=0.050934 rank=204\n",
      "[SoftImpute] Iter 1159: observed MAE=0.050933 rank=204\n",
      "[SoftImpute] Iter 1160: observed MAE=0.050933 rank=204\n",
      "[SoftImpute] Iter 1161: observed MAE=0.050932 rank=204\n",
      "[SoftImpute] Iter 1162: observed MAE=0.050931 rank=204\n",
      "[SoftImpute] Iter 1163: observed MAE=0.050931 rank=204\n",
      "[SoftImpute] Iter 1164: observed MAE=0.050930 rank=204\n",
      "[SoftImpute] Iter 1165: observed MAE=0.050929 rank=204\n",
      "[SoftImpute] Iter 1166: observed MAE=0.050929 rank=204\n",
      "[SoftImpute] Iter 1167: observed MAE=0.050928 rank=204\n",
      "[SoftImpute] Iter 1168: observed MAE=0.050927 rank=204\n",
      "[SoftImpute] Iter 1169: observed MAE=0.050927 rank=204\n",
      "[SoftImpute] Iter 1170: observed MAE=0.050926 rank=204\n",
      "[SoftImpute] Iter 1171: observed MAE=0.050925 rank=204\n",
      "[SoftImpute] Iter 1172: observed MAE=0.050925 rank=204\n",
      "[SoftImpute] Iter 1173: observed MAE=0.050924 rank=204\n",
      "[SoftImpute] Iter 1174: observed MAE=0.050923 rank=204\n",
      "[SoftImpute] Iter 1175: observed MAE=0.050923 rank=204\n",
      "[SoftImpute] Iter 1176: observed MAE=0.050922 rank=204\n",
      "[SoftImpute] Iter 1177: observed MAE=0.050921 rank=204\n",
      "[SoftImpute] Iter 1178: observed MAE=0.050921 rank=204\n",
      "[SoftImpute] Iter 1179: observed MAE=0.050920 rank=204\n",
      "[SoftImpute] Iter 1180: observed MAE=0.050919 rank=204\n",
      "[SoftImpute] Iter 1181: observed MAE=0.050919 rank=204\n",
      "[SoftImpute] Iter 1182: observed MAE=0.050918 rank=204\n",
      "[SoftImpute] Iter 1183: observed MAE=0.050917 rank=204\n",
      "[SoftImpute] Iter 1184: observed MAE=0.050916 rank=203\n",
      "[SoftImpute] Iter 1185: observed MAE=0.050915 rank=203\n",
      "[SoftImpute] Iter 1186: observed MAE=0.050914 rank=203\n",
      "[SoftImpute] Iter 1187: observed MAE=0.050913 rank=203\n",
      "[SoftImpute] Iter 1188: observed MAE=0.050912 rank=203\n",
      "[SoftImpute] Iter 1189: observed MAE=0.050912 rank=203\n",
      "[SoftImpute] Iter 1190: observed MAE=0.050911 rank=203\n",
      "[SoftImpute] Iter 1191: observed MAE=0.050910 rank=203\n",
      "[SoftImpute] Iter 1192: observed MAE=0.050910 rank=203\n",
      "[SoftImpute] Iter 1193: observed MAE=0.050909 rank=202\n",
      "[SoftImpute] Iter 1194: observed MAE=0.050907 rank=202\n",
      "[SoftImpute] Iter 1195: observed MAE=0.050906 rank=202\n",
      "[SoftImpute] Iter 1196: observed MAE=0.050906 rank=202\n",
      "[SoftImpute] Iter 1197: observed MAE=0.050905 rank=202\n",
      "[SoftImpute] Iter 1198: observed MAE=0.050904 rank=202\n",
      "[SoftImpute] Iter 1199: observed MAE=0.050903 rank=202\n",
      "[SoftImpute] Iter 1200: observed MAE=0.050902 rank=202\n",
      "[SoftImpute] Iter 1201: observed MAE=0.050902 rank=202\n",
      "[SoftImpute] Iter 1202: observed MAE=0.050901 rank=202\n",
      "[SoftImpute] Iter 1203: observed MAE=0.050900 rank=202\n",
      "[SoftImpute] Iter 1204: observed MAE=0.050900 rank=202\n",
      "[SoftImpute] Iter 1205: observed MAE=0.050899 rank=202\n",
      "[SoftImpute] Iter 1206: observed MAE=0.050898 rank=202\n",
      "[SoftImpute] Iter 1207: observed MAE=0.050898 rank=202\n",
      "[SoftImpute] Iter 1208: observed MAE=0.050897 rank=202\n",
      "[SoftImpute] Iter 1209: observed MAE=0.050896 rank=202\n",
      "[SoftImpute] Iter 1210: observed MAE=0.050896 rank=202\n",
      "[SoftImpute] Iter 1211: observed MAE=0.050895 rank=202\n",
      "[SoftImpute] Iter 1212: observed MAE=0.050894 rank=202\n",
      "[SoftImpute] Iter 1213: observed MAE=0.050894 rank=202\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 1214: observed MAE=0.050893 rank=202\n",
      "[SoftImpute] Iter 1215: observed MAE=0.050892 rank=202\n",
      "[SoftImpute] Iter 1216: observed MAE=0.050892 rank=202\n",
      "[SoftImpute] Iter 1217: observed MAE=0.050891 rank=202\n",
      "[SoftImpute] Iter 1218: observed MAE=0.050890 rank=202\n",
      "[SoftImpute] Iter 1219: observed MAE=0.050890 rank=202\n",
      "[SoftImpute] Iter 1220: observed MAE=0.050889 rank=202\n",
      "[SoftImpute] Iter 1221: observed MAE=0.050888 rank=202\n",
      "[SoftImpute] Iter 1222: observed MAE=0.050888 rank=202\n",
      "[SoftImpute] Iter 1223: observed MAE=0.050887 rank=202\n",
      "[SoftImpute] Iter 1224: observed MAE=0.050887 rank=202\n",
      "[SoftImpute] Iter 1225: observed MAE=0.050886 rank=202\n",
      "[SoftImpute] Iter 1226: observed MAE=0.050885 rank=202\n",
      "[SoftImpute] Iter 1227: observed MAE=0.050885 rank=202\n",
      "[SoftImpute] Iter 1228: observed MAE=0.050884 rank=202\n",
      "[SoftImpute] Iter 1229: observed MAE=0.050883 rank=202\n",
      "[SoftImpute] Iter 1230: observed MAE=0.050883 rank=202\n",
      "[SoftImpute] Iter 1231: observed MAE=0.050882 rank=202\n",
      "[SoftImpute] Iter 1232: observed MAE=0.050881 rank=201\n",
      "[SoftImpute] Iter 1233: observed MAE=0.050880 rank=201\n",
      "[SoftImpute] Iter 1234: observed MAE=0.050879 rank=201\n",
      "[SoftImpute] Iter 1235: observed MAE=0.050878 rank=201\n",
      "[SoftImpute] Iter 1236: observed MAE=0.050878 rank=201\n",
      "[SoftImpute] Iter 1237: observed MAE=0.050877 rank=201\n",
      "[SoftImpute] Iter 1238: observed MAE=0.050876 rank=201\n",
      "[SoftImpute] Iter 1239: observed MAE=0.050876 rank=201\n",
      "[SoftImpute] Iter 1240: observed MAE=0.050875 rank=201\n",
      "[SoftImpute] Iter 1241: observed MAE=0.050874 rank=201\n",
      "[SoftImpute] Iter 1242: observed MAE=0.050874 rank=201\n",
      "[SoftImpute] Iter 1243: observed MAE=0.050873 rank=201\n",
      "[SoftImpute] Iter 1244: observed MAE=0.050873 rank=201\n",
      "[SoftImpute] Iter 1245: observed MAE=0.050872 rank=201\n",
      "[SoftImpute] Iter 1246: observed MAE=0.050871 rank=201\n",
      "[SoftImpute] Iter 1247: observed MAE=0.050871 rank=201\n",
      "[SoftImpute] Iter 1248: observed MAE=0.050870 rank=201\n",
      "[SoftImpute] Iter 1249: observed MAE=0.050869 rank=201\n",
      "[SoftImpute] Iter 1250: observed MAE=0.050869 rank=201\n",
      "[SoftImpute] Iter 1251: observed MAE=0.050868 rank=201\n",
      "[SoftImpute] Iter 1252: observed MAE=0.050868 rank=201\n",
      "[SoftImpute] Iter 1253: observed MAE=0.050867 rank=201\n",
      "[SoftImpute] Iter 1254: observed MAE=0.050866 rank=201\n",
      "[SoftImpute] Iter 1255: observed MAE=0.050866 rank=200\n",
      "[SoftImpute] Iter 1256: observed MAE=0.050864 rank=200\n",
      "[SoftImpute] Iter 1257: observed MAE=0.050863 rank=200\n",
      "[SoftImpute] Iter 1258: observed MAE=0.050863 rank=200\n",
      "[SoftImpute] Iter 1259: observed MAE=0.050862 rank=200\n",
      "[SoftImpute] Iter 1260: observed MAE=0.050861 rank=200\n",
      "[SoftImpute] Iter 1261: observed MAE=0.050860 rank=200\n",
      "[SoftImpute] Iter 1262: observed MAE=0.050860 rank=200\n",
      "[SoftImpute] Iter 1263: observed MAE=0.050859 rank=200\n",
      "[SoftImpute] Iter 1264: observed MAE=0.050859 rank=200\n",
      "[SoftImpute] Iter 1265: observed MAE=0.050858 rank=200\n",
      "[SoftImpute] Iter 1266: observed MAE=0.050857 rank=200\n",
      "[SoftImpute] Iter 1267: observed MAE=0.050857 rank=200\n",
      "[SoftImpute] Iter 1268: observed MAE=0.050856 rank=200\n",
      "[SoftImpute] Iter 1269: observed MAE=0.050855 rank=200\n",
      "[SoftImpute] Iter 1270: observed MAE=0.050855 rank=200\n",
      "[SoftImpute] Iter 1271: observed MAE=0.050854 rank=200\n",
      "[SoftImpute] Iter 1272: observed MAE=0.050854 rank=200\n",
      "[SoftImpute] Iter 1273: observed MAE=0.050853 rank=200\n",
      "[SoftImpute] Iter 1274: observed MAE=0.050852 rank=200\n",
      "[SoftImpute] Iter 1275: observed MAE=0.050852 rank=200\n",
      "[SoftImpute] Iter 1276: observed MAE=0.050851 rank=200\n",
      "[SoftImpute] Iter 1277: observed MAE=0.050851 rank=200\n",
      "[SoftImpute] Iter 1278: observed MAE=0.050850 rank=200\n",
      "[SoftImpute] Iter 1279: observed MAE=0.050849 rank=199\n",
      "[SoftImpute] Iter 1280: observed MAE=0.050848 rank=199\n",
      "[SoftImpute] Iter 1281: observed MAE=0.050847 rank=199\n",
      "[SoftImpute] Iter 1282: observed MAE=0.050846 rank=199\n",
      "[SoftImpute] Iter 1283: observed MAE=0.050845 rank=199\n",
      "[SoftImpute] Iter 1284: observed MAE=0.050845 rank=199\n",
      "[SoftImpute] Iter 1285: observed MAE=0.050844 rank=199\n",
      "[SoftImpute] Iter 1286: observed MAE=0.050843 rank=199\n",
      "[SoftImpute] Iter 1287: observed MAE=0.050843 rank=199\n",
      "[SoftImpute] Iter 1288: observed MAE=0.050842 rank=199\n",
      "[SoftImpute] Iter 1289: observed MAE=0.050842 rank=199\n",
      "[SoftImpute] Iter 1290: observed MAE=0.050841 rank=199\n",
      "[SoftImpute] Iter 1291: observed MAE=0.050840 rank=199\n",
      "[SoftImpute] Iter 1292: observed MAE=0.050840 rank=199\n",
      "[SoftImpute] Iter 1293: observed MAE=0.050839 rank=199\n",
      "[SoftImpute] Iter 1294: observed MAE=0.050839 rank=199\n",
      "[SoftImpute] Iter 1295: observed MAE=0.050838 rank=199\n",
      "[SoftImpute] Iter 1296: observed MAE=0.050837 rank=199\n",
      "[SoftImpute] Iter 1297: observed MAE=0.050837 rank=199\n",
      "[SoftImpute] Iter 1298: observed MAE=0.050836 rank=199\n",
      "[SoftImpute] Iter 1299: observed MAE=0.050836 rank=199\n",
      "[SoftImpute] Iter 1300: observed MAE=0.050835 rank=199\n",
      "[SoftImpute] Iter 1301: observed MAE=0.050835 rank=199\n",
      "[SoftImpute] Iter 1302: observed MAE=0.050834 rank=199\n",
      "[SoftImpute] Iter 1303: observed MAE=0.050833 rank=198\n",
      "[SoftImpute] Iter 1304: observed MAE=0.050832 rank=198\n",
      "[SoftImpute] Iter 1305: observed MAE=0.050831 rank=198\n",
      "[SoftImpute] Iter 1306: observed MAE=0.050830 rank=198\n",
      "[SoftImpute] Iter 1307: observed MAE=0.050830 rank=198\n",
      "[SoftImpute] Iter 1308: observed MAE=0.050829 rank=198\n",
      "[SoftImpute] Iter 1309: observed MAE=0.050828 rank=198\n",
      "[SoftImpute] Iter 1310: observed MAE=0.050828 rank=198\n",
      "[SoftImpute] Iter 1311: observed MAE=0.050827 rank=198\n",
      "[SoftImpute] Iter 1312: observed MAE=0.050826 rank=198\n",
      "[SoftImpute] Iter 1313: observed MAE=0.050826 rank=198\n",
      "[SoftImpute] Iter 1314: observed MAE=0.050825 rank=198\n",
      "[SoftImpute] Iter 1315: observed MAE=0.050825 rank=198\n",
      "[SoftImpute] Iter 1316: observed MAE=0.050824 rank=198\n",
      "[SoftImpute] Iter 1317: observed MAE=0.050824 rank=198\n",
      "[SoftImpute] Iter 1318: observed MAE=0.050823 rank=198\n",
      "[SoftImpute] Iter 1319: observed MAE=0.050822 rank=198\n",
      "[SoftImpute] Iter 1320: observed MAE=0.050822 rank=198\n",
      "[SoftImpute] Iter 1321: observed MAE=0.050821 rank=198\n",
      "[SoftImpute] Iter 1322: observed MAE=0.050821 rank=198\n",
      "[SoftImpute] Iter 1323: observed MAE=0.050820 rank=198\n",
      "[SoftImpute] Iter 1324: observed MAE=0.050819 rank=198\n",
      "[SoftImpute] Iter 1325: observed MAE=0.050819 rank=198\n",
      "[SoftImpute] Iter 1326: observed MAE=0.050818 rank=198\n",
      "[SoftImpute] Iter 1327: observed MAE=0.050818 rank=198\n",
      "[SoftImpute] Iter 1328: observed MAE=0.050817 rank=198\n",
      "[SoftImpute] Iter 1329: observed MAE=0.050817 rank=198\n",
      "[SoftImpute] Iter 1330: observed MAE=0.050816 rank=198\n",
      "[SoftImpute] Iter 1331: observed MAE=0.050816 rank=198\n",
      "[SoftImpute] Iter 1332: observed MAE=0.050815 rank=198\n",
      "[SoftImpute] Iter 1333: observed MAE=0.050814 rank=197\n",
      "[SoftImpute] Iter 1334: observed MAE=0.050813 rank=197\n",
      "[SoftImpute] Iter 1335: observed MAE=0.050812 rank=197\n",
      "[SoftImpute] Iter 1336: observed MAE=0.050811 rank=197\n",
      "[SoftImpute] Iter 1337: observed MAE=0.050811 rank=197\n",
      "[SoftImpute] Iter 1338: observed MAE=0.050810 rank=197\n",
      "[SoftImpute] Iter 1339: observed MAE=0.050810 rank=197\n",
      "[SoftImpute] Iter 1340: observed MAE=0.050809 rank=197\n",
      "[SoftImpute] Iter 1341: observed MAE=0.050808 rank=197\n",
      "[SoftImpute] Iter 1342: observed MAE=0.050808 rank=197\n",
      "[SoftImpute] Iter 1343: observed MAE=0.050807 rank=197\n",
      "[SoftImpute] Iter 1344: observed MAE=0.050807 rank=197\n",
      "[SoftImpute] Iter 1345: observed MAE=0.050806 rank=197\n",
      "[SoftImpute] Iter 1346: observed MAE=0.050805 rank=197\n",
      "[SoftImpute] Iter 1347: observed MAE=0.050805 rank=197\n",
      "[SoftImpute] Iter 1348: observed MAE=0.050804 rank=197\n",
      "[SoftImpute] Iter 1349: observed MAE=0.050804 rank=197\n",
      "[SoftImpute] Iter 1350: observed MAE=0.050803 rank=197\n",
      "[SoftImpute] Iter 1351: observed MAE=0.050803 rank=197\n",
      "[SoftImpute] Iter 1352: observed MAE=0.050802 rank=197\n",
      "[SoftImpute] Iter 1353: observed MAE=0.050802 rank=197\n",
      "[SoftImpute] Iter 1354: observed MAE=0.050801 rank=197\n",
      "[SoftImpute] Iter 1355: observed MAE=0.050800 rank=197\n",
      "[SoftImpute] Iter 1356: observed MAE=0.050800 rank=197\n",
      "[SoftImpute] Iter 1357: observed MAE=0.050799 rank=197\n",
      "[SoftImpute] Iter 1358: observed MAE=0.050799 rank=197\n",
      "[SoftImpute] Iter 1359: observed MAE=0.050798 rank=197\n",
      "[SoftImpute] Iter 1360: observed MAE=0.050798 rank=197\n",
      "[SoftImpute] Iter 1361: observed MAE=0.050797 rank=197\n",
      "[SoftImpute] Iter 1362: observed MAE=0.050797 rank=197\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 1363: observed MAE=0.050796 rank=197\n",
      "[SoftImpute] Iter 1364: observed MAE=0.050796 rank=197\n",
      "[SoftImpute] Iter 1365: observed MAE=0.050795 rank=197\n",
      "[SoftImpute] Iter 1366: observed MAE=0.050795 rank=197\n",
      "[SoftImpute] Iter 1367: observed MAE=0.050794 rank=197\n",
      "[SoftImpute] Iter 1368: observed MAE=0.050793 rank=197\n",
      "[SoftImpute] Iter 1369: observed MAE=0.050793 rank=197\n",
      "[SoftImpute] Iter 1370: observed MAE=0.050792 rank=197\n",
      "[SoftImpute] Iter 1371: observed MAE=0.050792 rank=197\n",
      "[SoftImpute] Iter 1372: observed MAE=0.050791 rank=197\n",
      "[SoftImpute] Iter 1373: observed MAE=0.050791 rank=197\n",
      "[SoftImpute] Iter 1374: observed MAE=0.050790 rank=197\n",
      "[SoftImpute] Iter 1375: observed MAE=0.050790 rank=197\n",
      "[SoftImpute] Iter 1376: observed MAE=0.050789 rank=197\n",
      "[SoftImpute] Iter 1377: observed MAE=0.050789 rank=197\n",
      "[SoftImpute] Iter 1378: observed MAE=0.050788 rank=197\n",
      "[SoftImpute] Iter 1379: observed MAE=0.050788 rank=197\n",
      "[SoftImpute] Iter 1380: observed MAE=0.050787 rank=197\n",
      "[SoftImpute] Iter 1381: observed MAE=0.050787 rank=197\n",
      "[SoftImpute] Iter 1382: observed MAE=0.050786 rank=197\n",
      "[SoftImpute] Iter 1383: observed MAE=0.050786 rank=197\n",
      "[SoftImpute] Iter 1384: observed MAE=0.050785 rank=197\n",
      "[SoftImpute] Iter 1385: observed MAE=0.050784 rank=197\n",
      "[SoftImpute] Iter 1386: observed MAE=0.050784 rank=197\n",
      "[SoftImpute] Iter 1387: observed MAE=0.050783 rank=197\n",
      "[SoftImpute] Iter 1388: observed MAE=0.050783 rank=197\n",
      "[SoftImpute] Iter 1389: observed MAE=0.050782 rank=197\n",
      "[SoftImpute] Iter 1390: observed MAE=0.050782 rank=197\n",
      "[SoftImpute] Iter 1391: observed MAE=0.050781 rank=197\n",
      "[SoftImpute] Iter 1392: observed MAE=0.050781 rank=197\n",
      "[SoftImpute] Iter 1393: observed MAE=0.050780 rank=197\n",
      "[SoftImpute] Iter 1394: observed MAE=0.050780 rank=197\n",
      "[SoftImpute] Iter 1395: observed MAE=0.050779 rank=197\n",
      "[SoftImpute] Iter 1396: observed MAE=0.050779 rank=197\n",
      "[SoftImpute] Iter 1397: observed MAE=0.050778 rank=197\n",
      "[SoftImpute] Iter 1398: observed MAE=0.050778 rank=197\n",
      "[SoftImpute] Iter 1399: observed MAE=0.050777 rank=197\n",
      "[SoftImpute] Iter 1400: observed MAE=0.050777 rank=197\n",
      "[SoftImpute] Iter 1401: observed MAE=0.050776 rank=197\n",
      "[SoftImpute] Iter 1402: observed MAE=0.050776 rank=197\n",
      "[SoftImpute] Iter 1403: observed MAE=0.050775 rank=197\n",
      "[SoftImpute] Iter 1404: observed MAE=0.050775 rank=197\n",
      "[SoftImpute] Iter 1405: observed MAE=0.050774 rank=197\n",
      "[SoftImpute] Iter 1406: observed MAE=0.050774 rank=197\n",
      "[SoftImpute] Iter 1407: observed MAE=0.050773 rank=197\n",
      "[SoftImpute] Iter 1408: observed MAE=0.050773 rank=197\n",
      "[SoftImpute] Iter 1409: observed MAE=0.050772 rank=197\n",
      "[SoftImpute] Iter 1410: observed MAE=0.050772 rank=197\n",
      "[SoftImpute] Iter 1411: observed MAE=0.050771 rank=197\n",
      "[SoftImpute] Iter 1412: observed MAE=0.050771 rank=197\n",
      "[SoftImpute] Iter 1413: observed MAE=0.050770 rank=197\n",
      "[SoftImpute] Iter 1414: observed MAE=0.050770 rank=197\n",
      "[SoftImpute] Iter 1415: observed MAE=0.050769 rank=197\n",
      "[SoftImpute] Iter 1416: observed MAE=0.050769 rank=197\n",
      "[SoftImpute] Iter 1417: observed MAE=0.050768 rank=197\n",
      "[SoftImpute] Iter 1418: observed MAE=0.050768 rank=197\n",
      "[SoftImpute] Iter 1419: observed MAE=0.050767 rank=197\n",
      "[SoftImpute] Iter 1420: observed MAE=0.050767 rank=196\n",
      "[SoftImpute] Iter 1421: observed MAE=0.050766 rank=196\n",
      "[SoftImpute] Iter 1422: observed MAE=0.050765 rank=196\n",
      "[SoftImpute] Iter 1423: observed MAE=0.050764 rank=196\n",
      "[SoftImpute] Iter 1424: observed MAE=0.050764 rank=196\n",
      "[SoftImpute] Iter 1425: observed MAE=0.050763 rank=196\n",
      "[SoftImpute] Iter 1426: observed MAE=0.050762 rank=196\n",
      "[SoftImpute] Iter 1427: observed MAE=0.050762 rank=196\n",
      "[SoftImpute] Iter 1428: observed MAE=0.050761 rank=196\n",
      "[SoftImpute] Iter 1429: observed MAE=0.050761 rank=196\n",
      "[SoftImpute] Iter 1430: observed MAE=0.050760 rank=196\n",
      "[SoftImpute] Iter 1431: observed MAE=0.050760 rank=196\n",
      "[SoftImpute] Iter 1432: observed MAE=0.050759 rank=196\n",
      "[SoftImpute] Iter 1433: observed MAE=0.050759 rank=196\n",
      "[SoftImpute] Iter 1434: observed MAE=0.050758 rank=196\n",
      "[SoftImpute] Iter 1435: observed MAE=0.050758 rank=196\n",
      "[SoftImpute] Iter 1436: observed MAE=0.050757 rank=196\n",
      "[SoftImpute] Iter 1437: observed MAE=0.050757 rank=196\n",
      "[SoftImpute] Iter 1438: observed MAE=0.050756 rank=195\n",
      "[SoftImpute] Iter 1439: observed MAE=0.050755 rank=195\n",
      "[SoftImpute] Iter 1440: observed MAE=0.050755 rank=195\n",
      "[SoftImpute] Iter 1441: observed MAE=0.050754 rank=195\n",
      "[SoftImpute] Iter 1442: observed MAE=0.050753 rank=195\n",
      "[SoftImpute] Iter 1443: observed MAE=0.050753 rank=195\n",
      "[SoftImpute] Iter 1444: observed MAE=0.050752 rank=195\n",
      "[SoftImpute] Iter 1445: observed MAE=0.050752 rank=195\n",
      "[SoftImpute] Iter 1446: observed MAE=0.050751 rank=195\n",
      "[SoftImpute] Iter 1447: observed MAE=0.050751 rank=195\n",
      "[SoftImpute] Iter 1448: observed MAE=0.050750 rank=195\n",
      "[SoftImpute] Iter 1449: observed MAE=0.050749 rank=194\n",
      "[SoftImpute] Iter 1450: observed MAE=0.050748 rank=194\n",
      "[SoftImpute] Iter 1451: observed MAE=0.050748 rank=194\n",
      "[SoftImpute] Iter 1452: observed MAE=0.050747 rank=194\n",
      "[SoftImpute] Iter 1453: observed MAE=0.050746 rank=194\n",
      "[SoftImpute] Iter 1454: observed MAE=0.050746 rank=194\n",
      "[SoftImpute] Iter 1455: observed MAE=0.050745 rank=194\n",
      "[SoftImpute] Iter 1456: observed MAE=0.050745 rank=194\n",
      "[SoftImpute] Iter 1457: observed MAE=0.050744 rank=194\n",
      "[SoftImpute] Iter 1458: observed MAE=0.050744 rank=194\n",
      "[SoftImpute] Iter 1459: observed MAE=0.050743 rank=194\n",
      "[SoftImpute] Iter 1460: observed MAE=0.050743 rank=194\n",
      "[SoftImpute] Iter 1461: observed MAE=0.050742 rank=194\n",
      "[SoftImpute] Iter 1462: observed MAE=0.050742 rank=194\n",
      "[SoftImpute] Iter 1463: observed MAE=0.050741 rank=194\n",
      "[SoftImpute] Iter 1464: observed MAE=0.050741 rank=194\n",
      "[SoftImpute] Iter 1465: observed MAE=0.050740 rank=194\n",
      "[SoftImpute] Iter 1466: observed MAE=0.050740 rank=194\n",
      "[SoftImpute] Iter 1467: observed MAE=0.050739 rank=194\n",
      "[SoftImpute] Iter 1468: observed MAE=0.050739 rank=194\n",
      "[SoftImpute] Iter 1469: observed MAE=0.050738 rank=194\n",
      "[SoftImpute] Iter 1470: observed MAE=0.050738 rank=194\n",
      "[SoftImpute] Iter 1471: observed MAE=0.050737 rank=194\n",
      "[SoftImpute] Iter 1472: observed MAE=0.050737 rank=194\n",
      "[SoftImpute] Iter 1473: observed MAE=0.050736 rank=194\n",
      "[SoftImpute] Iter 1474: observed MAE=0.050736 rank=194\n",
      "[SoftImpute] Iter 1475: observed MAE=0.050735 rank=194\n",
      "[SoftImpute] Iter 1476: observed MAE=0.050735 rank=194\n",
      "[SoftImpute] Iter 1477: observed MAE=0.050735 rank=194\n",
      "[SoftImpute] Iter 1478: observed MAE=0.050734 rank=194\n",
      "[SoftImpute] Iter 1479: observed MAE=0.050734 rank=194\n",
      "[SoftImpute] Iter 1480: observed MAE=0.050733 rank=194\n",
      "[SoftImpute] Iter 1481: observed MAE=0.050733 rank=194\n",
      "[SoftImpute] Iter 1482: observed MAE=0.050732 rank=194\n",
      "[SoftImpute] Iter 1483: observed MAE=0.050732 rank=194\n",
      "[SoftImpute] Iter 1484: observed MAE=0.050731 rank=194\n",
      "[SoftImpute] Iter 1485: observed MAE=0.050731 rank=194\n",
      "[SoftImpute] Iter 1486: observed MAE=0.050730 rank=194\n",
      "[SoftImpute] Iter 1487: observed MAE=0.050730 rank=193\n",
      "[SoftImpute] Iter 1488: observed MAE=0.050729 rank=193\n",
      "[SoftImpute] Iter 1489: observed MAE=0.050728 rank=193\n",
      "[SoftImpute] Iter 1490: observed MAE=0.050728 rank=193\n",
      "[SoftImpute] Iter 1491: observed MAE=0.050727 rank=193\n",
      "[SoftImpute] Iter 1492: observed MAE=0.050727 rank=193\n",
      "[SoftImpute] Iter 1493: observed MAE=0.050726 rank=193\n",
      "[SoftImpute] Iter 1494: observed MAE=0.050726 rank=193\n",
      "[SoftImpute] Iter 1495: observed MAE=0.050725 rank=193\n",
      "[SoftImpute] Iter 1496: observed MAE=0.050725 rank=193\n",
      "[SoftImpute] Iter 1497: observed MAE=0.050724 rank=193\n",
      "[SoftImpute] Iter 1498: observed MAE=0.050724 rank=193\n",
      "[SoftImpute] Iter 1499: observed MAE=0.050723 rank=193\n",
      "[SoftImpute] Iter 1500: observed MAE=0.050723 rank=193\n",
      "[SoftImpute] Iter 1501: observed MAE=0.050722 rank=193\n",
      "[SoftImpute] Iter 1502: observed MAE=0.050722 rank=193\n",
      "[SoftImpute] Iter 1503: observed MAE=0.050721 rank=193\n",
      "[SoftImpute] Iter 1504: observed MAE=0.050721 rank=193\n",
      "[SoftImpute] Iter 1505: observed MAE=0.050720 rank=193\n",
      "[SoftImpute] Iter 1506: observed MAE=0.050720 rank=193\n",
      "[SoftImpute] Iter 1507: observed MAE=0.050720 rank=193\n",
      "[SoftImpute] Iter 1508: observed MAE=0.050719 rank=193\n",
      "[SoftImpute] Iter 1509: observed MAE=0.050719 rank=193\n",
      "[SoftImpute] Iter 1510: observed MAE=0.050718 rank=193\n",
      "[SoftImpute] Iter 1511: observed MAE=0.050718 rank=193\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 1512: observed MAE=0.050717 rank=193\n",
      "[SoftImpute] Iter 1513: observed MAE=0.050717 rank=193\n",
      "[SoftImpute] Iter 1514: observed MAE=0.050716 rank=193\n",
      "[SoftImpute] Iter 1515: observed MAE=0.050716 rank=193\n",
      "[SoftImpute] Iter 1516: observed MAE=0.050716 rank=193\n",
      "[SoftImpute] Iter 1517: observed MAE=0.050715 rank=193\n",
      "[SoftImpute] Iter 1518: observed MAE=0.050715 rank=193\n",
      "[SoftImpute] Iter 1519: observed MAE=0.050714 rank=193\n",
      "[SoftImpute] Iter 1520: observed MAE=0.050714 rank=193\n",
      "[SoftImpute] Iter 1521: observed MAE=0.050713 rank=193\n",
      "[SoftImpute] Iter 1522: observed MAE=0.050713 rank=193\n",
      "[SoftImpute] Iter 1523: observed MAE=0.050712 rank=193\n",
      "[SoftImpute] Iter 1524: observed MAE=0.050712 rank=193\n",
      "[SoftImpute] Iter 1525: observed MAE=0.050712 rank=193\n",
      "[SoftImpute] Iter 1526: observed MAE=0.050711 rank=193\n",
      "[SoftImpute] Iter 1527: observed MAE=0.050711 rank=193\n",
      "[SoftImpute] Iter 1528: observed MAE=0.050710 rank=193\n",
      "[SoftImpute] Iter 1529: observed MAE=0.050710 rank=193\n",
      "[SoftImpute] Iter 1530: observed MAE=0.050709 rank=193\n",
      "[SoftImpute] Iter 1531: observed MAE=0.050709 rank=193\n",
      "[SoftImpute] Iter 1532: observed MAE=0.050709 rank=193\n",
      "[SoftImpute] Iter 1533: observed MAE=0.050708 rank=193\n",
      "[SoftImpute] Iter 1534: observed MAE=0.050708 rank=193\n",
      "[SoftImpute] Iter 1535: observed MAE=0.050707 rank=193\n",
      "[SoftImpute] Iter 1536: observed MAE=0.050707 rank=193\n",
      "[SoftImpute] Iter 1537: observed MAE=0.050706 rank=193\n",
      "[SoftImpute] Iter 1538: observed MAE=0.050706 rank=193\n",
      "[SoftImpute] Iter 1539: observed MAE=0.050706 rank=193\n",
      "[SoftImpute] Iter 1540: observed MAE=0.050705 rank=193\n",
      "[SoftImpute] Iter 1541: observed MAE=0.050705 rank=193\n",
      "[SoftImpute] Iter 1542: observed MAE=0.050704 rank=193\n",
      "[SoftImpute] Iter 1543: observed MAE=0.050704 rank=193\n",
      "[SoftImpute] Iter 1544: observed MAE=0.050703 rank=193\n",
      "[SoftImpute] Iter 1545: observed MAE=0.050703 rank=193\n",
      "[SoftImpute] Iter 1546: observed MAE=0.050703 rank=193\n",
      "[SoftImpute] Iter 1547: observed MAE=0.050702 rank=193\n",
      "[SoftImpute] Iter 1548: observed MAE=0.050702 rank=193\n",
      "[SoftImpute] Iter 1549: observed MAE=0.050701 rank=193\n",
      "[SoftImpute] Iter 1550: observed MAE=0.050701 rank=193\n",
      "[SoftImpute] Iter 1551: observed MAE=0.050700 rank=193\n",
      "[SoftImpute] Iter 1552: observed MAE=0.050700 rank=193\n",
      "[SoftImpute] Iter 1553: observed MAE=0.050700 rank=193\n",
      "[SoftImpute] Iter 1554: observed MAE=0.050699 rank=193\n",
      "[SoftImpute] Iter 1555: observed MAE=0.050699 rank=193\n",
      "[SoftImpute] Iter 1556: observed MAE=0.050698 rank=193\n",
      "[SoftImpute] Iter 1557: observed MAE=0.050698 rank=193\n",
      "[SoftImpute] Iter 1558: observed MAE=0.050697 rank=193\n",
      "[SoftImpute] Iter 1559: observed MAE=0.050697 rank=193\n",
      "[SoftImpute] Iter 1560: observed MAE=0.050697 rank=193\n",
      "[SoftImpute] Iter 1561: observed MAE=0.050696 rank=193\n",
      "[SoftImpute] Iter 1562: observed MAE=0.050696 rank=193\n",
      "[SoftImpute] Iter 1563: observed MAE=0.050695 rank=193\n",
      "[SoftImpute] Iter 1564: observed MAE=0.050695 rank=193\n",
      "[SoftImpute] Iter 1565: observed MAE=0.050694 rank=193\n",
      "[SoftImpute] Iter 1566: observed MAE=0.050694 rank=193\n",
      "[SoftImpute] Iter 1567: observed MAE=0.050694 rank=193\n",
      "[SoftImpute] Iter 1568: observed MAE=0.050693 rank=193\n",
      "[SoftImpute] Iter 1569: observed MAE=0.050693 rank=193\n",
      "[SoftImpute] Iter 1570: observed MAE=0.050692 rank=193\n",
      "[SoftImpute] Iter 1571: observed MAE=0.050692 rank=193\n",
      "[SoftImpute] Iter 1572: observed MAE=0.050692 rank=193\n",
      "[SoftImpute] Iter 1573: observed MAE=0.050691 rank=193\n",
      "[SoftImpute] Iter 1574: observed MAE=0.050691 rank=193\n",
      "[SoftImpute] Iter 1575: observed MAE=0.050690 rank=193\n",
      "[SoftImpute] Iter 1576: observed MAE=0.050690 rank=193\n",
      "[SoftImpute] Iter 1577: observed MAE=0.050689 rank=193\n",
      "[SoftImpute] Iter 1578: observed MAE=0.050689 rank=193\n",
      "[SoftImpute] Iter 1579: observed MAE=0.050689 rank=193\n",
      "[SoftImpute] Iter 1580: observed MAE=0.050688 rank=193\n",
      "[SoftImpute] Iter 1581: observed MAE=0.050688 rank=193\n",
      "[SoftImpute] Iter 1582: observed MAE=0.050687 rank=193\n",
      "[SoftImpute] Iter 1583: observed MAE=0.050687 rank=193\n",
      "[SoftImpute] Iter 1584: observed MAE=0.050687 rank=193\n",
      "[SoftImpute] Iter 1585: observed MAE=0.050686 rank=193\n",
      "[SoftImpute] Iter 1586: observed MAE=0.050686 rank=193\n",
      "[SoftImpute] Iter 1587: observed MAE=0.050685 rank=193\n",
      "[SoftImpute] Iter 1588: observed MAE=0.050685 rank=193\n",
      "[SoftImpute] Iter 1589: observed MAE=0.050684 rank=193\n",
      "[SoftImpute] Iter 1590: observed MAE=0.050684 rank=193\n",
      "[SoftImpute] Iter 1591: observed MAE=0.050684 rank=193\n",
      "[SoftImpute] Iter 1592: observed MAE=0.050683 rank=193\n",
      "[SoftImpute] Iter 1593: observed MAE=0.050683 rank=193\n",
      "[SoftImpute] Iter 1594: observed MAE=0.050682 rank=193\n",
      "[SoftImpute] Iter 1595: observed MAE=0.050682 rank=193\n",
      "[SoftImpute] Iter 1596: observed MAE=0.050682 rank=193\n",
      "[SoftImpute] Iter 1597: observed MAE=0.050681 rank=192\n",
      "[SoftImpute] Iter 1598: observed MAE=0.050680 rank=192\n",
      "[SoftImpute] Iter 1599: observed MAE=0.050679 rank=192\n",
      "[SoftImpute] Iter 1600: observed MAE=0.050679 rank=192\n",
      "[SoftImpute] Iter 1601: observed MAE=0.050678 rank=192\n",
      "[SoftImpute] Iter 1602: observed MAE=0.050678 rank=192\n",
      "[SoftImpute] Iter 1603: observed MAE=0.050677 rank=192\n",
      "[SoftImpute] Iter 1604: observed MAE=0.050677 rank=192\n",
      "[SoftImpute] Iter 1605: observed MAE=0.050676 rank=192\n",
      "[SoftImpute] Iter 1606: observed MAE=0.050676 rank=192\n",
      "[SoftImpute] Iter 1607: observed MAE=0.050675 rank=192\n",
      "[SoftImpute] Iter 1608: observed MAE=0.050675 rank=192\n",
      "[SoftImpute] Iter 1609: observed MAE=0.050675 rank=192\n",
      "[SoftImpute] Iter 1610: observed MAE=0.050674 rank=192\n",
      "[SoftImpute] Iter 1611: observed MAE=0.050674 rank=192\n",
      "[SoftImpute] Iter 1612: observed MAE=0.050673 rank=192\n",
      "[SoftImpute] Iter 1613: observed MAE=0.050673 rank=192\n",
      "[SoftImpute] Iter 1614: observed MAE=0.050673 rank=192\n",
      "[SoftImpute] Iter 1615: observed MAE=0.050672 rank=192\n",
      "[SoftImpute] Iter 1616: observed MAE=0.050672 rank=192\n",
      "[SoftImpute] Iter 1617: observed MAE=0.050671 rank=192\n",
      "[SoftImpute] Iter 1618: observed MAE=0.050671 rank=192\n",
      "[SoftImpute] Iter 1619: observed MAE=0.050671 rank=192\n",
      "[SoftImpute] Iter 1620: observed MAE=0.050670 rank=192\n",
      "[SoftImpute] Iter 1621: observed MAE=0.050670 rank=192\n",
      "[SoftImpute] Iter 1622: observed MAE=0.050669 rank=192\n",
      "[SoftImpute] Iter 1623: observed MAE=0.050669 rank=192\n",
      "[SoftImpute] Iter 1624: observed MAE=0.050669 rank=192\n",
      "[SoftImpute] Iter 1625: observed MAE=0.050668 rank=192\n",
      "[SoftImpute] Iter 1626: observed MAE=0.050668 rank=192\n",
      "[SoftImpute] Iter 1627: observed MAE=0.050667 rank=192\n",
      "[SoftImpute] Iter 1628: observed MAE=0.050667 rank=192\n",
      "[SoftImpute] Iter 1629: observed MAE=0.050667 rank=192\n",
      "[SoftImpute] Iter 1630: observed MAE=0.050666 rank=192\n",
      "[SoftImpute] Iter 1631: observed MAE=0.050666 rank=192\n",
      "[SoftImpute] Iter 1632: observed MAE=0.050665 rank=192\n",
      "[SoftImpute] Iter 1633: observed MAE=0.050665 rank=192\n",
      "[SoftImpute] Iter 1634: observed MAE=0.050665 rank=192\n",
      "[SoftImpute] Iter 1635: observed MAE=0.050664 rank=192\n",
      "[SoftImpute] Iter 1636: observed MAE=0.050664 rank=192\n",
      "[SoftImpute] Iter 1637: observed MAE=0.050663 rank=192\n",
      "[SoftImpute] Iter 1638: observed MAE=0.050663 rank=192\n",
      "[SoftImpute] Iter 1639: observed MAE=0.050663 rank=192\n",
      "[SoftImpute] Iter 1640: observed MAE=0.050662 rank=192\n",
      "[SoftImpute] Iter 1641: observed MAE=0.050662 rank=192\n",
      "[SoftImpute] Iter 1642: observed MAE=0.050661 rank=192\n",
      "[SoftImpute] Iter 1643: observed MAE=0.050661 rank=192\n",
      "[SoftImpute] Iter 1644: observed MAE=0.050661 rank=192\n",
      "[SoftImpute] Iter 1645: observed MAE=0.050660 rank=192\n",
      "[SoftImpute] Iter 1646: observed MAE=0.050660 rank=192\n",
      "[SoftImpute] Iter 1647: observed MAE=0.050660 rank=192\n",
      "[SoftImpute] Iter 1648: observed MAE=0.050659 rank=192\n",
      "[SoftImpute] Iter 1649: observed MAE=0.050659 rank=192\n",
      "[SoftImpute] Iter 1650: observed MAE=0.050658 rank=192\n",
      "[SoftImpute] Iter 1651: observed MAE=0.050658 rank=191\n",
      "[SoftImpute] Iter 1652: observed MAE=0.050657 rank=191\n",
      "[SoftImpute] Iter 1653: observed MAE=0.050656 rank=191\n",
      "[SoftImpute] Iter 1654: observed MAE=0.050656 rank=191\n",
      "[SoftImpute] Iter 1655: observed MAE=0.050655 rank=191\n",
      "[SoftImpute] Iter 1656: observed MAE=0.050655 rank=191\n",
      "[SoftImpute] Iter 1657: observed MAE=0.050655 rank=191\n",
      "[SoftImpute] Iter 1658: observed MAE=0.050654 rank=191\n",
      "[SoftImpute] Iter 1659: observed MAE=0.050654 rank=191\n",
      "[SoftImpute] Iter 1660: observed MAE=0.050653 rank=191\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 1661: observed MAE=0.050653 rank=191\n",
      "[SoftImpute] Iter 1662: observed MAE=0.050653 rank=191\n",
      "[SoftImpute] Iter 1663: observed MAE=0.050652 rank=191\n",
      "[SoftImpute] Iter 1664: observed MAE=0.050652 rank=191\n",
      "[SoftImpute] Iter 1665: observed MAE=0.050651 rank=191\n",
      "[SoftImpute] Iter 1666: observed MAE=0.050651 rank=191\n",
      "[SoftImpute] Iter 1667: observed MAE=0.050651 rank=191\n",
      "[SoftImpute] Iter 1668: observed MAE=0.050650 rank=191\n",
      "[SoftImpute] Iter 1669: observed MAE=0.050650 rank=191\n",
      "[SoftImpute] Iter 1670: observed MAE=0.050649 rank=191\n",
      "[SoftImpute] Iter 1671: observed MAE=0.050649 rank=191\n",
      "[SoftImpute] Iter 1672: observed MAE=0.050649 rank=191\n",
      "[SoftImpute] Iter 1673: observed MAE=0.050648 rank=191\n",
      "[SoftImpute] Iter 1674: observed MAE=0.050648 rank=191\n",
      "[SoftImpute] Iter 1675: observed MAE=0.050647 rank=191\n",
      "[SoftImpute] Iter 1676: observed MAE=0.050647 rank=191\n",
      "[SoftImpute] Iter 1677: observed MAE=0.050647 rank=191\n",
      "[SoftImpute] Iter 1678: observed MAE=0.050646 rank=191\n",
      "[SoftImpute] Iter 1679: observed MAE=0.050646 rank=191\n",
      "[SoftImpute] Iter 1680: observed MAE=0.050646 rank=191\n",
      "[SoftImpute] Iter 1681: observed MAE=0.050645 rank=190\n",
      "[SoftImpute] Iter 1682: observed MAE=0.050645 rank=190\n",
      "[SoftImpute] Iter 1683: observed MAE=0.050644 rank=190\n",
      "[SoftImpute] Iter 1684: observed MAE=0.050643 rank=190\n",
      "[SoftImpute] Iter 1685: observed MAE=0.050643 rank=190\n",
      "[SoftImpute] Iter 1686: observed MAE=0.050643 rank=190\n",
      "[SoftImpute] Iter 1687: observed MAE=0.050642 rank=190\n",
      "[SoftImpute] Iter 1688: observed MAE=0.050642 rank=190\n",
      "[SoftImpute] Iter 1689: observed MAE=0.050641 rank=190\n",
      "[SoftImpute] Iter 1690: observed MAE=0.050641 rank=190\n",
      "[SoftImpute] Iter 1691: observed MAE=0.050641 rank=190\n",
      "[SoftImpute] Iter 1692: observed MAE=0.050640 rank=190\n",
      "[SoftImpute] Iter 1693: observed MAE=0.050640 rank=190\n",
      "[SoftImpute] Iter 1694: observed MAE=0.050639 rank=190\n",
      "[SoftImpute] Iter 1695: observed MAE=0.050639 rank=190\n",
      "[SoftImpute] Iter 1696: observed MAE=0.050639 rank=190\n",
      "[SoftImpute] Iter 1697: observed MAE=0.050638 rank=190\n",
      "[SoftImpute] Iter 1698: observed MAE=0.050638 rank=190\n",
      "[SoftImpute] Iter 1699: observed MAE=0.050638 rank=190\n",
      "[SoftImpute] Iter 1700: observed MAE=0.050637 rank=190\n",
      "[SoftImpute] Iter 1701: observed MAE=0.050637 rank=190\n",
      "[SoftImpute] Iter 1702: observed MAE=0.050636 rank=190\n",
      "[SoftImpute] Iter 1703: observed MAE=0.050636 rank=190\n",
      "[SoftImpute] Iter 1704: observed MAE=0.050636 rank=190\n",
      "[SoftImpute] Iter 1705: observed MAE=0.050635 rank=190\n",
      "[SoftImpute] Iter 1706: observed MAE=0.050635 rank=190\n",
      "[SoftImpute] Iter 1707: observed MAE=0.050635 rank=190\n",
      "[SoftImpute] Iter 1708: observed MAE=0.050634 rank=190\n",
      "[SoftImpute] Iter 1709: observed MAE=0.050634 rank=190\n",
      "[SoftImpute] Iter 1710: observed MAE=0.050633 rank=190\n",
      "[SoftImpute] Iter 1711: observed MAE=0.050633 rank=190\n",
      "[SoftImpute] Iter 1712: observed MAE=0.050633 rank=190\n",
      "[SoftImpute] Iter 1713: observed MAE=0.050632 rank=190\n",
      "[SoftImpute] Iter 1714: observed MAE=0.050632 rank=190\n",
      "[SoftImpute] Iter 1715: observed MAE=0.050632 rank=190\n",
      "[SoftImpute] Iter 1716: observed MAE=0.050631 rank=190\n",
      "[SoftImpute] Iter 1717: observed MAE=0.050631 rank=190\n",
      "[SoftImpute] Iter 1718: observed MAE=0.050631 rank=190\n",
      "[SoftImpute] Iter 1719: observed MAE=0.050630 rank=190\n",
      "[SoftImpute] Iter 1720: observed MAE=0.050630 rank=190\n",
      "[SoftImpute] Iter 1721: observed MAE=0.050629 rank=190\n",
      "[SoftImpute] Iter 1722: observed MAE=0.050629 rank=190\n",
      "[SoftImpute] Iter 1723: observed MAE=0.050629 rank=190\n",
      "[SoftImpute] Iter 1724: observed MAE=0.050628 rank=190\n",
      "[SoftImpute] Iter 1725: observed MAE=0.050628 rank=190\n",
      "[SoftImpute] Iter 1726: observed MAE=0.050628 rank=190\n",
      "[SoftImpute] Iter 1727: observed MAE=0.050627 rank=190\n",
      "[SoftImpute] Iter 1728: observed MAE=0.050627 rank=190\n",
      "[SoftImpute] Iter 1729: observed MAE=0.050627 rank=190\n",
      "[SoftImpute] Iter 1730: observed MAE=0.050626 rank=190\n",
      "[SoftImpute] Iter 1731: observed MAE=0.050626 rank=189\n",
      "[SoftImpute] Iter 1732: observed MAE=0.050625 rank=189\n",
      "[SoftImpute] Iter 1733: observed MAE=0.050624 rank=189\n",
      "[SoftImpute] Iter 1734: observed MAE=0.050624 rank=189\n",
      "[SoftImpute] Iter 1735: observed MAE=0.050624 rank=189\n",
      "[SoftImpute] Iter 1736: observed MAE=0.050623 rank=189\n",
      "[SoftImpute] Iter 1737: observed MAE=0.050623 rank=189\n",
      "[SoftImpute] Iter 1738: observed MAE=0.050622 rank=189\n",
      "[SoftImpute] Iter 1739: observed MAE=0.050622 rank=189\n",
      "[SoftImpute] Iter 1740: observed MAE=0.050622 rank=189\n",
      "[SoftImpute] Iter 1741: observed MAE=0.050621 rank=189\n",
      "[SoftImpute] Iter 1742: observed MAE=0.050621 rank=189\n",
      "[SoftImpute] Iter 1743: observed MAE=0.050620 rank=189\n",
      "[SoftImpute] Iter 1744: observed MAE=0.050620 rank=189\n",
      "[SoftImpute] Iter 1745: observed MAE=0.050620 rank=189\n",
      "[SoftImpute] Iter 1746: observed MAE=0.050619 rank=189\n",
      "[SoftImpute] Iter 1747: observed MAE=0.050619 rank=189\n",
      "[SoftImpute] Iter 1748: observed MAE=0.050619 rank=189\n",
      "[SoftImpute] Iter 1749: observed MAE=0.050618 rank=189\n",
      "[SoftImpute] Iter 1750: observed MAE=0.050618 rank=189\n",
      "[SoftImpute] Iter 1751: observed MAE=0.050618 rank=189\n",
      "[SoftImpute] Iter 1752: observed MAE=0.050617 rank=189\n",
      "[SoftImpute] Iter 1753: observed MAE=0.050617 rank=189\n",
      "[SoftImpute] Iter 1754: observed MAE=0.050616 rank=189\n",
      "[SoftImpute] Iter 1755: observed MAE=0.050616 rank=189\n",
      "[SoftImpute] Iter 1756: observed MAE=0.050616 rank=189\n",
      "[SoftImpute] Iter 1757: observed MAE=0.050615 rank=189\n",
      "[SoftImpute] Iter 1758: observed MAE=0.050615 rank=189\n",
      "[SoftImpute] Iter 1759: observed MAE=0.050615 rank=189\n",
      "[SoftImpute] Iter 1760: observed MAE=0.050614 rank=189\n",
      "[SoftImpute] Iter 1761: observed MAE=0.050614 rank=189\n",
      "[SoftImpute] Iter 1762: observed MAE=0.050614 rank=189\n",
      "[SoftImpute] Iter 1763: observed MAE=0.050613 rank=189\n",
      "[SoftImpute] Iter 1764: observed MAE=0.050613 rank=189\n",
      "[SoftImpute] Iter 1765: observed MAE=0.050613 rank=189\n",
      "[SoftImpute] Iter 1766: observed MAE=0.050612 rank=189\n",
      "[SoftImpute] Iter 1767: observed MAE=0.050612 rank=189\n",
      "[SoftImpute] Iter 1768: observed MAE=0.050612 rank=189\n",
      "[SoftImpute] Iter 1769: observed MAE=0.050611 rank=189\n",
      "[SoftImpute] Iter 1770: observed MAE=0.050611 rank=189\n",
      "[SoftImpute] Iter 1771: observed MAE=0.050611 rank=189\n",
      "[SoftImpute] Iter 1772: observed MAE=0.050610 rank=189\n",
      "[SoftImpute] Iter 1773: observed MAE=0.050610 rank=189\n",
      "[SoftImpute] Iter 1774: observed MAE=0.050610 rank=189\n",
      "[SoftImpute] Iter 1775: observed MAE=0.050609 rank=189\n",
      "[SoftImpute] Iter 1776: observed MAE=0.050609 rank=189\n",
      "[SoftImpute] Iter 1777: observed MAE=0.050608 rank=189\n",
      "[SoftImpute] Iter 1778: observed MAE=0.050608 rank=189\n",
      "[SoftImpute] Iter 1779: observed MAE=0.050608 rank=189\n",
      "[SoftImpute] Iter 1780: observed MAE=0.050607 rank=189\n",
      "[SoftImpute] Iter 1781: observed MAE=0.050607 rank=189\n",
      "[SoftImpute] Iter 1782: observed MAE=0.050607 rank=189\n",
      "[SoftImpute] Iter 1783: observed MAE=0.050606 rank=189\n",
      "[SoftImpute] Iter 1784: observed MAE=0.050606 rank=189\n",
      "[SoftImpute] Iter 1785: observed MAE=0.050606 rank=189\n",
      "[SoftImpute] Iter 1786: observed MAE=0.050605 rank=189\n",
      "[SoftImpute] Iter 1787: observed MAE=0.050605 rank=189\n",
      "[SoftImpute] Iter 1788: observed MAE=0.050605 rank=189\n",
      "[SoftImpute] Iter 1789: observed MAE=0.050604 rank=189\n",
      "[SoftImpute] Iter 1790: observed MAE=0.050604 rank=189\n",
      "[SoftImpute] Iter 1791: observed MAE=0.050604 rank=189\n",
      "[SoftImpute] Iter 1792: observed MAE=0.050603 rank=189\n",
      "[SoftImpute] Iter 1793: observed MAE=0.050603 rank=189\n",
      "[SoftImpute] Iter 1794: observed MAE=0.050603 rank=189\n",
      "[SoftImpute] Iter 1795: observed MAE=0.050602 rank=189\n",
      "[SoftImpute] Iter 1796: observed MAE=0.050602 rank=189\n",
      "[SoftImpute] Iter 1797: observed MAE=0.050602 rank=189\n",
      "[SoftImpute] Iter 1798: observed MAE=0.050601 rank=189\n",
      "[SoftImpute] Iter 1799: observed MAE=0.050601 rank=189\n",
      "[SoftImpute] Iter 1800: observed MAE=0.050601 rank=189\n",
      "[SoftImpute] Iter 1801: observed MAE=0.050600 rank=189\n",
      "[SoftImpute] Iter 1802: observed MAE=0.050600 rank=189\n",
      "[SoftImpute] Iter 1803: observed MAE=0.050599 rank=188\n",
      "[SoftImpute] Iter 1804: observed MAE=0.050599 rank=188\n",
      "[SoftImpute] Iter 1805: observed MAE=0.050598 rank=188\n",
      "[SoftImpute] Iter 1806: observed MAE=0.050598 rank=188\n",
      "[SoftImpute] Iter 1807: observed MAE=0.050597 rank=188\n",
      "[SoftImpute] Iter 1808: observed MAE=0.050597 rank=188\n",
      "[SoftImpute] Iter 1809: observed MAE=0.050597 rank=188\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[SoftImpute] Iter 1810: observed MAE=0.050596 rank=188\n",
      "[SoftImpute] Iter 1811: observed MAE=0.050596 rank=188\n",
      "[SoftImpute] Iter 1812: observed MAE=0.050596 rank=188\n",
      "[SoftImpute] Stopped after iteration 1812 for lambda=1.000000\n"
     ]
    }
   ],
   "source": [
    "X_filled_softimpute = SoftImpute(shrinkage_value=1,convergence_threshold=0.0001,max_iters=3000,min_value=1,max_value=5).complete(R_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 250,
   "metadata": {},
   "outputs": [],
   "source": [
    "R_df_modified = ratings_df.pivot(index = 'userId', columns ='movieId', values = 'rating').fillna(0)\n",
    "R = R_df_modified.as_matrix()\n",
    "user_ratings_mean = np.mean(R, axis = 1)\n",
    "R_demeaned = R - user_ratings_mean.reshape(-1, 1)\n",
    "from scipy.sparse.linalg import svds\n",
    "U, sigma, Vt = svds(R_demeaned, k =100)\n",
    "sigma = np.diag(sigma)\n",
    "all = np.dot(np.dot(U, sigma), Vt) + user_ratings_mean.reshape(-1, 1)\n",
    "preds_df = pd.DataFrame(all, columns = R_df.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 251,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "User 600 has already rated 35 movies.\n",
      "Recommending highest 10 predicted ratings movies not already rated.\n"
     ]
    }
   ],
   "source": [
    "already_rated, predictions = recommend_movies(preds_df, 600, movies_df, ratings_df, 10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 268,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>600</td>\n",
       "      <td>588</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956328</td>\n",
       "      <td>Aladdin (1992)</td>\n",
       "      <td>Adventure|Animation|Children|Comedy|Musical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>600</td>\n",
       "      <td>68954</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956316</td>\n",
       "      <td>Up (2009)</td>\n",
       "      <td>Adventure|Animation|Children|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>600</td>\n",
       "      <td>90866</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431958854</td>\n",
       "      <td>Hugo (2011)</td>\n",
       "      <td>Children|Drama|Mystery</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>600</td>\n",
       "      <td>81847</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956365</td>\n",
       "      <td>Tangled (2010)</td>\n",
       "      <td>Animation|Children|Comedy|Fantasy|Musical|Roma...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>600</td>\n",
       "      <td>4886</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956114</td>\n",
       "      <td>Monsters, Inc. (2001)</td>\n",
       "      <td>Adventure|Animation|Children|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>600</td>\n",
       "      <td>2081</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431957361</td>\n",
       "      <td>Little Mermaid, The (1989)</td>\n",
       "      <td>Animation|Children|Comedy|Musical|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>600</td>\n",
       "      <td>79132</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956095</td>\n",
       "      <td>Inception (2010)</td>\n",
       "      <td>Action|Crime|Drama|Mystery|Sci-Fi|Thriller|IMAX</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>600</td>\n",
       "      <td>76093</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956421</td>\n",
       "      <td>How to Train Your Dragon (2010)</td>\n",
       "      <td>Adventure|Animation|Children|Fantasy|IMAX</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>600</td>\n",
       "      <td>73290</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1431956210</td>\n",
       "      <td>Hachiko: A Dog's Story (a.k.a. Hachi: A Dog's ...</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>600</td>\n",
       "      <td>81845</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1431956086</td>\n",
       "      <td>King's Speech, The (2010)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    userId  movieId  rating   timestamp  \\\n",
       "0      600      588     5.0  1431956328   \n",
       "11     600    68954     5.0  1431956316   \n",
       "20     600    90866     5.0  1431958854   \n",
       "18     600    81847     5.0  1431956365   \n",
       "4      600     4886     5.0  1431956114   \n",
       "1      600     2081     5.0  1431957361   \n",
       "16     600    79132     5.0  1431956095   \n",
       "15     600    76093     5.0  1431956421   \n",
       "14     600    73290     5.0  1431956210   \n",
       "17     600    81845     4.5  1431956086   \n",
       "\n",
       "                                                title  \\\n",
       "0                                      Aladdin (1992)   \n",
       "11                                          Up (2009)   \n",
       "20                                        Hugo (2011)   \n",
       "18                                     Tangled (2010)   \n",
       "4                               Monsters, Inc. (2001)   \n",
       "1                          Little Mermaid, The (1989)   \n",
       "16                                   Inception (2010)   \n",
       "15                    How to Train Your Dragon (2010)   \n",
       "14  Hachiko: A Dog's Story (a.k.a. Hachi: A Dog's ...   \n",
       "17                          King's Speech, The (2010)   \n",
       "\n",
       "                                               genres  \n",
       "0         Adventure|Animation|Children|Comedy|Musical  \n",
       "11                 Adventure|Animation|Children|Drama  \n",
       "20                             Children|Drama|Mystery  \n",
       "18  Animation|Children|Comedy|Fantasy|Musical|Roma...  \n",
       "4         Adventure|Animation|Children|Comedy|Fantasy  \n",
       "1           Animation|Children|Comedy|Musical|Romance  \n",
       "16    Action|Crime|Drama|Mystery|Sci-Fi|Thriller|IMAX  \n",
       "15          Adventure|Animation|Children|Fantasy|IMAX  \n",
       "14                                              Drama  \n",
       "17                                              Drama  "
      ]
     },
     "execution_count": 268,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "already_rated.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 252,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3797</th>\n",
       "      <td>4878</td>\n",
       "      <td>Donnie Darko (2001)</td>\n",
       "      <td>Drama|Mystery|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3363</th>\n",
       "      <td>4226</td>\n",
       "      <td>Memento (2000)</td>\n",
       "      <td>Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6530</th>\n",
       "      <td>48516</td>\n",
       "      <td>Departed, The (2006)</td>\n",
       "      <td>Crime|Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5119</th>\n",
       "      <td>7361</td>\n",
       "      <td>Eternal Sunshine of the Spotless Mind (2004)</td>\n",
       "      <td>Drama|Romance|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6149</th>\n",
       "      <td>33794</td>\n",
       "      <td>Batman Begins (2005)</td>\n",
       "      <td>Action|Crime|IMAX</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6547</th>\n",
       "      <td>48780</td>\n",
       "      <td>Prestige, The (2006)</td>\n",
       "      <td>Drama|Mystery|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4425</th>\n",
       "      <td>6016</td>\n",
       "      <td>City of God (Cidade de Deus) (2002)</td>\n",
       "      <td>Action|Adventure|Crime|Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6933</th>\n",
       "      <td>59315</td>\n",
       "      <td>Iron Man (2008)</td>\n",
       "      <td>Action|Adventure|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7274</th>\n",
       "      <td>70286</td>\n",
       "      <td>District 9 (2009)</td>\n",
       "      <td>Mystery|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6546</th>\n",
       "      <td>48774</td>\n",
       "      <td>Children of Men (2006)</td>\n",
       "      <td>Action|Adventure|Drama|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      movieId                                         title  \\\n",
       "3797     4878                           Donnie Darko (2001)   \n",
       "3363     4226                                Memento (2000)   \n",
       "6530    48516                          Departed, The (2006)   \n",
       "5119     7361  Eternal Sunshine of the Spotless Mind (2004)   \n",
       "6149    33794                          Batman Begins (2005)   \n",
       "6547    48780                          Prestige, The (2006)   \n",
       "4425     6016           City of God (Cidade de Deus) (2002)   \n",
       "6933    59315                               Iron Man (2008)   \n",
       "7274    70286                             District 9 (2009)   \n",
       "6546    48774                        Children of Men (2006)   \n",
       "\n",
       "                                      genres  \n",
       "3797           Drama|Mystery|Sci-Fi|Thriller  \n",
       "3363                        Mystery|Thriller  \n",
       "6530                    Crime|Drama|Thriller  \n",
       "5119                    Drama|Romance|Sci-Fi  \n",
       "6149                       Action|Crime|IMAX  \n",
       "6547           Drama|Mystery|Sci-Fi|Thriller  \n",
       "4425   Action|Adventure|Crime|Drama|Thriller  \n",
       "6933                 Action|Adventure|Sci-Fi  \n",
       "7274                 Mystery|Sci-Fi|Thriller  \n",
       "6546  Action|Adventure|Drama|Sci-Fi|Thriller  "
      ]
     },
     "execution_count": 252,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predictions.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 271,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_filled_SWA = SimilarityWeightedAveraging().complete(np.array(R_df))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 272,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.967298293103\n"
     ]
    }
   ],
   "source": [
    "print(rmse(X_filled_SWA))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
